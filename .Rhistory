mtry=as.integer(length(includeVarsStim)/0.5)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.5)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/3)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/4)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/5)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/6)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/10)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/2)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=10,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=100,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=50,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=30,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=20,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=10,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=10000,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=100,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/3)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/2)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/3)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/2)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.5)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.15)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.0)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.2)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.3)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.26)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.24)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.23)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.22)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.24)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=800,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
as.integer(length(includeVarsStim)/1.25))
as.integer(length(includeVarsStim)/1.25)))
as.integer(length(includeVarsStim)/1.25)
as.integer(length(includeVarsStim)/1)
as.integer(length(includeVarsStim)/3)
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=300,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=700,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=1000,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=2000,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=1500,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=1000,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=1100,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=900,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
set.seed(909)
crf_AggModel <- party::cforest(formVarStim, data=stimDataANum,
controls=party::cforest_unbiased(ntree=1000,
mtry=as.integer(length(includeVarsStim)/1.25)))
crf_AggModelOOB <- predict(crf_AggModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_AggModelOOB - data.matrix(crf_AggModel@data@env$response))), digits=3)
cor(crf_AggModelOOB, crf_AggModel@data@env$response)^2  # Rsquared
sort(party::varimp(crf_AggModel), decreasing=TRUE)
# using permimp cpi
start.time <- Sys.time()
pimpCrfAggModel <- permimp::permimp(crf_AggModel, nperm=1, conditional=TRUE,
threshold=0.95)
end.time <- Sys.time()
time.taken <- round(end.time - start.time, 2)
time.taken
pimpCrfAggOrdered <- round(sort(pimpCrfAggModel$values, decreasing=F), digits=4)
rev(pimpCrfAggOrdered)
par(mai=c(0,3,0,0))
pimpCrfAggOrdereddf <- data.frame(pimpCrfAggOrdered)
pimpCrfAggOrdereddf <- plyr::rename(pimpCrfAggOrdereddf, c("pimpCrfAggOrdered" = "Variable_importance"))
pBar <- ggplot(pimpCrfAggOrdereddf) + geom_col(aes(x=factor(rownames(pimpCrfAggOrdereddf), levels=rownames(pimpCrfAggOrdereddf)), y=Variable_importance), fill="#076fa2", width=0.5) + labs(x="Variable", y="Conditional variable importance") + theme(text = element_text(family = "serif"))
pBar + coord_flip()
# plot cpi
permimp::plot.VarImp(pimpCrfAggModel, type='box', horizontal=TRUE)
View(pimpCrfAggModel)
# using permimp cpi
start.time <- Sys.time()
pimpCrfAggModel <- permimp::permimp(crf_AggModel, nperm=1, conditional=TRUE,
threshold=0.95, progressBar = FALSE)
end.time <- Sys.time()
time.taken <- round(end.time - start.time, 2)
time.taken
set.seed(909)
crf_IndModel <- party::cforest(formVarSubj, data=subjDataANum,
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsSubj)/1.25)))
crf_IndModelOOB <- predict(crf_IndModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_IndModelOOB - data.matrix(crf_IndModel@data@env$response))), digits=3)
cor(crf_IndModelOOB, crf_IndModel@data@env$response)^2  # Rsquared
sort(party::varimp(crf_IndModel), decreasing=TRUE)
start.time <- Sys.time()
impCrfIndModel <- permimp::permimp(crf_IndModel, nperm=1, conditional=TRUE, progressbar=FALSE)
end.time <- Sys.time()
time.taken <- round(end.time - start.time, 2)
time.taken
start.time <- Sys.time()
impCrfIndModel <- permimp::permimp(crf_IndModel, nperm=1, conditional=TRUE, progressBar=FALSE)
end.time <- Sys.time()
time.taken <- round(end.time - start.time, 2)
time.taken
impCrfIndOrdered <- sort(impCrfIndModel, decreasing=F)
impCrfIndOrdered <- sort(impCrfIndModel$values, decreasing=F)
rev(impCrfIndOrdered)
par(mai=c(0,3,0,0))
impCrfIndOrdereddf <- data.frame(impCrfIndOrdered)
impCrfIndOrdereddf <- plyr::rename(impCrfIndOrdereddf, c("impCrfIndOrdered" = "Variable_importance"))
pBar <- ggplot(impCrfIndOrdereddf) + geom_col(aes(x=factor(rownames(impCrfIndOrdereddf), levels=rownames(impCrfIndOrdereddf)), y=Variable_importance), fill="#076fa2", width=0.5) + labs(x="Variable") + theme(text = element_text(family = "serif"))
# load packages
library(tidyr)
library(unikn)
library(ggplot2)
require(flexplot)
library(party)
library(randomForest)
library(per)
# load packages
library(tidyr)
library(unikn)
library(ggplot2)
require(flexplot)
library(party)
library(randomForest)
# set package parameters
theme_set(theme_bw())
par(mai=c(0,3,0,0))
impCrfIndOrdereddf <- data.frame(impCrfIndOrdered)
impCrfIndOrdereddf <- plyr::rename(impCrfIndOrdereddf, c("impCrfIndOrdered" = "Variable_importance"))
pBar <- ggplot(impCrfIndOrdereddf) + geom_col(aes(x=factor(rownames(impCrfIndOrdereddf), levels=rownames(impCrfIndOrdereddf)), y=Variable_importance), fill="#076fa2", width=0.5) + labs(x="Variable") + theme(text = element_text(family = "serif"))
pBar + coord_flip()
set.seed(909)
crf_IndModel <- party::cforest(formVarSubj, data=subjDataANum[, !(names(subjDataANum) %in% "AmbientLAeq")],
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsSubj)/1.25)))
View(subjDataANum)
names(subjDataANum)
names(subjDataANum) %in% "AmbientLAeq"
!(names(subjDataANum) %in% "AmbientLAeq")
set.seed(909)
crf_IndModel <- party::cforest(formVarSubj, data=subjDataANum[, !(names(subjDataANum) %in% "AmbientLAeq")],
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsSubj)/1.25)))
includeVarsSubj
set.seed(909)
crf_IndModel <- party::cforest(formVarSubj, data=subjDataANum[, !(names(subjDataANum) %in% "AmbientLAeq")],
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsSubj)/1.25)))
formVarSubj
includeVarsSubj <- c(names(subjDataANum)[1], names(subjDataANum)[3:which(names(subjDataANum) == 'dImpulsHMS05ExMaxLR')])
includeVarsSubj
includeVarsSubj <- c(names(subjDataANum)[1], names(subjDataANum)[3:which(names(subjDataANum) == 'dImpulsHMS05ExMaxLR')])
formVarSubj <- reformulate(includeVarsSubj, 'Annoyance')
set.seed(909)
crf_IndModel <- party::cforest(formVarSubj, data=subjDataANum[, !(names(subjDataANum) %in% "AmbientLAeq")],
controls=party::cforest_unbiased(ntree=500,
mtry=as.integer(length(includeVarsSubj)/1.25)))
crf_IndModelOOB <- predict(crf_IndModel, OOB=TRUE, type='response')
# Error quantiles
round(quantile(abs(crf_IndModelOOB - data.matrix(crf_IndModel@data@env$response))), digits=3)
cor(crf_IndModelOOB, crf_IndModel@data@env$response)^2  # Rsquared
start.time <- Sys.time()
impCrfIndModel <- permimp::permimp(crf_IndModel, nperm=1, conditional=TRUE, progressBar=FALSE)
end.time <- Sys.time()
time.taken <- round(end.time - start.time, 2)
time.taken
par(mai=c(0,3,0,0))
impCrfIndOrdereddf <- data.frame(impCrfIndOrdered)
impCrfIndOrdereddf <- plyr::rename(impCrfIndOrdereddf, c("impCrfIndOrdered" = "Variable_importance"))
pBar <- ggplot(impCrfIndOrdereddf) + geom_col(aes(x=factor(rownames(impCrfIndOrdereddf), levels=rownames(impCrfIndOrdereddf)), y=Variable_importance), fill="#076fa2", width=0.5) + labs(x="Variable") + theme(text = element_text(family = "serif"))
# load packages
library(tidyr)
library(unikn)
library(ggplot2)
require(flexplot)
library(party)
library(randomForest)
# set package parameters
theme_set(theme_bw())
par(mai=c(0,3,0,0))
impCrfIndOrdereddf <- data.frame(impCrfIndOrdered)
impCrfIndOrdereddf <- plyr::rename(impCrfIndOrdereddf, c("impCrfIndOrdered" = "Variable_importance"))
pBar <- ggplot(impCrfIndOrdereddf) + geom_col(aes(x=factor(rownames(impCrfIndOrdereddf), levels=rownames(impCrfIndOrdereddf)), y=Variable_importance), fill="#076fa2", width=0.5) + labs(x="Variable") + theme(text = element_text(family = "serif"))
pBar + coord_flip()
impCrfIndOrdered <- sort(impCrfIndModel$values, decreasing=F)
par(mai=c(0,3,0,0))
impCrfIndOrdereddf <- data.frame(impCrfIndOrdered)
impCrfIndOrdereddf <- plyr::rename(impCrfIndOrdereddf, c("impCrfIndOrdered" = "Variable_importance"))
pBar <- ggplot(impCrfIndOrdereddf) + geom_col(aes(x=factor(rownames(impCrfIndOrdereddf), levels=rownames(impCrfIndOrdereddf)), y=Variable_importance), fill="#076fa2", width=0.5) + labs(x="Variable") + theme(text = element_text(family = "serif"))
pBar + coord_flip()
