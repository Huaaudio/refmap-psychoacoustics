---
title: "REFMAP listening test 1 analysis: Multi-level linear models for annoyance"
output: html_document
date: "2024-06-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup

Load packages

```{r}
library(conflicted)
library(dplyr)
library(flexplot)
library(lme4)
#library(lmerTest)
library(lmtest)
library(merTools)
library(ggeffects)
library(marginaleffects)
library(stats)
library(ggplot2)
library(openxlsx)
library(easystats)
library(partR2)
#library(rstanarm)
#library(MuMIn)
#library(future)

# set package parameters
theme_set(theme_bw())

#numCores <- parallel::detectCores()

#future::plan(multisession, workers = numCores-6)

```

Set parameters

```{r}

# plot colour scheme

mycolourlist = list(c(0, 102, 255), c(0, 204, 153), c(255, 0, 102), c(74, 111, 152), c(251, 164, 49), c(204, 153, 255), c(90, 192, 255), c(80, 245, 233), c(255, 90, 192), c(164, 201, 242), c(255, 254, 139), c(255, 243, 255))
mycolours = matrix()

for (ii in 1:length(mycolourlist)){
  mycolours[ii] = rgb(mycolourlist[[ii]][1]/255,
                      mycolourlist[[ii]][2]/255,
                      mycolourlist[[ii]][3]/255)
}

# toggle to save plots
saveplots = TRUE

if (saveplots){
  # set output plot directory
  choose.files(caption="Just cancel this", filters=matrix(data=c(" ", " "), ncol=2))  # workaround for bug in RTerm choose.dir
  outFigPath <- utils::choose.dir(caption="Select output folder to save plots")
}

# toggle to save data
savedata = TRUE

if (savedata){
  # set output plot directory
  if (saveplots==FALSE){
    choose.files(caption="Just cancel this", filters=matrix(data=c(" ", " "), ncol=2))  # workaround for bug in RTerm choose.dir
  }
  outDataPath <- utils::choose.dir(caption="Select output folder to save data")
}

set.seed(3212165)

control <- lme4::lmerControl(optimizer = 'bobyqa',
                             optCtrl = list(maxfun = 1e6))

```

# Import data and wrangle

## Part A

```{r}

subjDataApath <- utils::choose.files(caption=r"(Select refmap_listest1_testdataA_BySubj.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdataA_BySubj.csv", "refmap_listest1_testdataA_BySubj.csv"), ncol=2))

subjDataA <- read.csv(subjDataApath, header=TRUE)

```

```{r}
# definition of ordinal variable levels
UASLAeqCatsA <- c("No UAS", "42", "48", "54", "60")
SNRCatsA <- c("No UAS", "-16", "-10", "-4", "2", "8")
UASOpCatsA <- c("No UAS", "Flyby", "Landing", "Takeoff")
UASTypeCatsA <- c("No UAS", "H520", "M300", "T150")

# encode factors
subjDataA$ID. <- factor(subjDataA$ID.)
subjDataA$UASLAeq <- factor(subjDataA$UASLAeq, levels=UASLAeqCatsA, order=TRUE)
subjDataA$SNRlevel <- factor(subjDataA$SNRlevel, levels=SNRCatsA, order=TRUE)
subjDataA$UASOperation <- factor(subjDataA$UASOperation, levels=UASOpCatsA)
subjDataA$UASType <- factor(subjDataA$UASType, levels=UASTypeCatsA)
subjDataA$AmbientEnv <- factor(subjDataA$AmbientEnv, levels=c("Street", "Park"))
subjDataA$AAM_attitude <- factor(subjDataA$AAM_attitude)
subjDataA$Home_Area <- factor(subjDataA$Home_Area)
subjDataA$Area_soundscape <- factor(subjDataA$Area_soundscape)
subjDataA$NationGeo <- factor(subjDataA$NationGeo)

# recode AAM_attitude to 3 groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude3 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned") ~ "Ambiv_Concern",
                                                                      "Neutral" ~ "Neutral"))
subjDataA$AAM_attitude3 <- factor(subjDataA$AAM_attitude3)

# recode AAM_attitude to 2 groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude2 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))
subjDataA$AAM_attitude2 <- factor(subjDataA$AAM_attitude2)

# recode AAM_attitude to 2 other groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Supportive_Ambivalent",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))

subjDataA$AAM_attitude2_2 <- factor(subjDataA$AAM_attitude2_2)

# recode AAM_attitude to 2 other groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Supportive_Ambivalent",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern"))

subjDataA$AAM_attitude2_2 <- factor(subjDataA$AAM_attitude2_2)

# recode NationGeo to 4 groups
subjDataA <- subjDataA |> dplyr::mutate(NationGeo4 = case_match(NationGeo,
                                                               "UK" ~ "UK",
                                                               c("Africa",
                                                                 "SouthAsia") ~ "Africa_SAsia",
                                                               c("Australasia",
                                                                 "EastAsia",
                                                                 "Europe",
                                                                 "MidEast",
                                                                 "SouthAmerica") ~ "Other",
                                                               "" ~ "Unspecified"))
subjDataA$NationGeo4 <- factor(subjDataA$NationGeo4)

# recode NationGeo to 3 groups
subjDataA <- subjDataA |> dplyr::mutate(NationGeo3 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjDataA$NationGeo3 <- factor(subjDataA$NationGeo3)

# recode Area of residence to 2 groups
subjDataA <- subjDataA |> dplyr::mutate(Home_Area2 = case_match(Home_Area,
                                                         "Urban" ~ "Urban",
                                                         c("Suburban",
                                                           "Rural") ~ "Suburban_Rural"))
subjDataA$Home_Area2 <- factor(subjDataA$Home_Area2)


# recode Area soundscape to 2 groups
subjDataA <- subjDataA |> dplyr::mutate(Area_soundscape2 = case_match(Area_soundscape,
                                                                       c("Calm",
                                                                         "Monotonous") ~ "Uneventful",
                                                                       c("Chaotic",
                                                                         "Vibrant") ~ "Eventful"))

subjDataA$Area_soundscape2 <- factor(subjDataA$Area_soundscape2)


# reorder by trial number
subjDataA <- subjDataA[with(subjDataA, order(ID., TrialNumber)), ]

# rescale trial number variable
subjDataA <- subjDataA |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber))

```


## Part B

```{r}

subjDataBpath <- utils::choose.files(caption=r"(Select refmap_listest1_testdataB_BySubj.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdataB_BySubj.csv", "refmap_listest1_testdataB_BySubj.csv"), ncol=2))

subjDataB <- read.csv(subjDataBpath, header=TRUE)

```

```{r}
# definition of ordinal variable levels
UASLAeqCatsB <- c("No UAS", "54", "60")
SNRCatsB <- c("No UAS", "2", "8")
UASOpCatsB <- c("No UAS", "Flyby")
UASTypeCatsB <- c("No UAS", "H520", "T150")

# encode factors
subjDataB$ID. <- factor(subjDataB$ID.)
subjDataB$UASLAeq <- factor(subjDataB$UASLAeq, levels=UASLAeqCatsB, order=TRUE)
subjDataB$SNRlevel <- factor(subjDataB$SNRlevel, levels=SNRCatsB, order=TRUE)
subjDataB$UASOperation <- factor(subjDataB$UASOperation, levels=UASOpCatsB)
subjDataB$UASType <- factor(subjDataB$UASType, levels=UASTypeCatsB)
subjDataB$AmbientEnv <- factor(subjDataB$AmbientEnv)
subjDataB$AAM_attitude <- factor(subjDataB$AAM_attitude)
subjDataB$Home_Area <- factor(subjDataB$Home_Area)
subjDataB$Area_soundscape <- factor(subjDataB$Area_soundscape)
subjDataB$NationGeo <- factor(subjDataB$NationGeo)

# recode AAM_attitude to 3 groups
subjDataB <- subjDataB |> dplyr::mutate(AAM_attitude3 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned") ~ "Ambiv_Concern",
                                                                      "Neutral" ~ "Neutral"))
subjDataB$AAM_attitude3 <- factor(subjDataB$AAM_attitude3)

# recode AAM_attitude to 2 groups
subjDataB <- subjDataB |> dplyr::mutate(AAM_attitude2 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))
subjDataB$AAM_attitude2 <- factor(subjDataB$AAM_attitude2)

# recode AAM_attitude to 2 other groups
subjDataB <- subjDataB |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Supportive_Ambivalent",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern"))

subjDataB$AAM_attitude2_2 <- factor(subjDataB$AAM_attitude2_2)

# recode NationGeo to 4 groups
subjDataB <- subjDataB |> dplyr::mutate(NationGeo4 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica") ~ "Other",
                                                                 "" ~ "Unspecified"))
subjDataB$NationGeo4 <- factor(subjDataB$NationGeo4)

# recode NationGeo to 3 groups
subjDataB <- subjDataB |> dplyr::mutate(NationGeo3 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjDataB$NationGeo3 <- factor(subjDataB$NationGeo3)

# recode Area of residence to 2 groups
subjDataB <- subjDataB |> dplyr::mutate(Home_Area2 = case_match(Home_Area,
                                                                 "Urban" ~ "Urban",
                                                                 c("Suburban",
                                                                   "Rural") ~ "Suburban_Rural"))
subjDataB$Home_Area2 <- factor(subjDataB$Home_Area2)


# recode Area soundscape to 2 groups
subjDataB <- subjDataB |> dplyr::mutate(Area_soundscape2 = case_match(Area_soundscape,
                                                                       c("Calm",
                                                                         "Monotonous") ~ "Uneventful",
                                                                       c("Chaotic",
                                                                         "Vibrant") ~ "Eventful"))
subjDataB$Area_soundscape2 <- factor(subjDataB$Area_soundscape2)


# reorder by trial number
subjDataB <- subjDataB[with(subjDataB, order(ID., TrialNumber)), ]

# rescale trial number variable
subjDataB <- subjDataB |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber))

```

# Part A analysis


## Fit a baseline model

```{r}

# baseline model (no predictors, only clustered intercept)
mBL <- lme4::lmer(Annoyance ~ 1 + (1 | ID.), data=subjDataA,
                        control=control, REML=FALSE)

#mBL_stn <- rstanarm::stan_glmer(Annoyance ~ 1 + (1 | ID.), data=subjDataA, cores=12, iter=4000, seed=2134)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mBL)
performance::r2(mBL)

#performance::icc(mBL_stn)
#performance::r2(mBL_stn)

params <- parameters::model_parameters(mBL)
```


```{r, fig.width=8, fig.height=5}
# plot the baseline

pred <- ggeffects::predict_response(mBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

df <- data.frame(ID=pred$ID., Annoyance=pred$predicted,
                   AnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   AnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   AnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=AnnoyCILow, ymax=AnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[1]) +
  geom_line(mapping=aes(ID, AnnoyMean), group=1, color=mycolours[1]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[1], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=10),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Mean annoyance rating")

```

## Basic comparison model

```{r}

mLAeq.LAeq <- lme4::lmer(Annoyance ~ LAeqMaxLR + (1 + LAeqMaxLR | ID.), data=subjDataA,
                         control=control, REML=FALSE)

flexplot::visualize(mLAeq.LAeq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ LAeqMaxLR | ID., data=subjDataA,
                       model1=mBL, model2=mLAeq.LAeq, clusters=5, re=T)

flexplot::model.comparison(model1=mBL, model2=mLAeq.LAeq)

lmtest::lrtest(mBL, mLAeq.LAeq)

performance::compare_performance(mBL, mLAeq.LAeq)

```

## Ambient environment model

Now fit a frequentist model which includes ambient environment category as (i) fixed effect and (ii) mixed effect predictor, and compare with the baseline

```{r, fig.width=8,fig.height=5}
mEnv <- lme4::lmer(Annoyance ~ AmbientEnv +
                   (1 | ID.), data=subjDataA,
                   control=control, REML=FALSE)
mEnv.Env <- lme4::lmer(Annoyance ~ AmbientEnv +
                       (1 + AmbientEnv | ID.), data=subjDataA,
                       control=control, REML=FALSE)

flexplot::compare.fits(Annoyance ~ AmbientEnv | ID., data=subjDataA,
                       model1=mBL, model2=mEnv, clusters=5, re=T)

flexplot::compare.fits(Annoyance ~ AmbientEnv | ID., data=subjDataA,
                       model1=mBL, model2=mEnv.Env, clusters=5, re=T)

flexplot::model.comparison(model1=mEnv, model2=mEnv.Env)

lmtest::lrtest(mEnv, mEnv.Env)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env)

```
## Loudness (fixed) + amb env model
```{r}

# mixed model with HMS loudness as fixed effect, and ambient env as mixed effect
mNEnv.Env <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin + AmbientEnv +
                        (1 + AmbientEnv | ID.),
                        data=subjDataA, control=control, REML=FALSE)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mEnv.Env, model2=mNEnv.Env, clusters=5, re=T)

flexplot::model.comparison(model1=mEnv.Env, model2=mNEnv.Env)

lmtest::lrtest(mEnv.Env, mNEnv.Env)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env)
```
## Loudness (mixed) + amb env model

```{r}

# mixed model with HMS loudness and ambient env as mixed effects
mNEnv.NEnv <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin + AmbientEnv +
                         (1 + AmbientEnv + UASLoudECMAHMSPowAvgBin | ID.),
                         data=subjDataA, control=control, REML=FALSE)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mNEnv.Env, model2=mNEnv.NEnv, clusters=5, re=T)

flexplot::model.comparison(model1=mNEnv.Env, model2=mNEnv.NEnv)

lmtest::lrtest(mNEnv.Env, mNEnv.NEnv)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env, mNEnv.NEnv)

```

## Loudness + amb env with fixed interaction model

```{r}

# mixed model with HMS loudness and ambient env as mixed effects, and loudness*ambient as fixed effect
mNxEnv.NEnv <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*AmbientEnv +
                          (1 +  UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                          data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mNxEnv.NEnv, plot='model', sample=length(levels(subjDataA$ID.)), alpha=0.1)


flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mNEnv.NEnv, model2=mNxEnv.NEnv, re=T)

flexplot::model.comparison(model1=mNEnv.NEnv, model2=mNxEnv.NEnv)

lmtest::lrtest(mNEnv.NEnv, mNxEnv.NEnv)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv)


```

## Loudness + amb env with mixed interaction model

```{r}

# mixed model with HMS loudness, ambient env and loudness*ambient as mixed effects
mNxEnv.NxEnv <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*AmbientEnv +
                           (1 + UASLoudECMAHMSPowAvgBin*AmbientEnv | ID.),
                           data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mNxEnv.NxEnv, plot='model', sample=length(levels(subjDataA$ID.)), alpha=0.1)


flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mNxEnv.NEnv, model2=mNxEnv.NxEnv, re=T)

flexplot::model.comparison(model1=mNxEnv.NEnv, model2=mNxEnv.NxEnv)

lmtest::lrtest(mNxEnv.NEnv, mNxEnv.NxEnv)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv)


```

## Loudness poly (2) + amb env with linear interaction model

```{r}

# mixed model with HMS loudness and ambient env as mixed effects, loudness*ambient and loudness^2 as fixed effects
mN2xEnv.NEnv <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*AmbientEnv +
                           I(UASLoudECMAHMSPowAvgBin^2) +
                           (1 +  UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                           data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mN2xEnv.NEnv, plot='model', sample=length(levels(subjDataA$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mNxEnv.NEnv, model2=mN2xEnv.NEnv, re=T)

flexplot::model.comparison(model1=mNxEnv.NEnv, model2=mN2xEnv.NEnv)

lmtest::lrtest(mNxEnv.NEnv, mN2xEnv.NEnv)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv)


```

## Trial sequence

```{r}

df <- subjDataA |> group_by(TrialNumber) |> summarise(Annoyance = mean(Annoyance))

ggplot(data=df, mapping=aes(TrialNumber, Annoyance)) + geom_point(color=mycolours[1]) +
       geom_smooth(formula = y ~ x, method = "lm") + ylim(3, 6) +
       theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)))

```


### fixed effect

```{r}

# mixed model with HMS loudness and ambient env as mixed effects, loudness*ambient, and trial sequence as fixed effects

mNxEnvSq.NEnv <- lme4::lmer(Annoyance ~ TrialNumber +
                            UASLoudECMAHMSPowAvgBin*AmbientEnv +
                            I(UASLoudECMAHMSPowAvgBin^2) +
                            (1 +  UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                            data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mNxEnvSq.NEnv, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ TrialNumber + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ TrialNumber | ID. + AmbientEnv, data=subjDataA,
                       model1=mNxEnv.NEnv, model2=mNxEnvSq.NEnv, re=T)

flexplot::model.comparison(model1=mNxEnv.NEnv, model2=mNxEnvSq.NEnv)

lmtest::lrtest(mNxEnv.NEnv, mNxEnvSq.NEnv)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv)


```
### mixed effect

```{r}

# mixed model with HMS loudness, ambient env and trial sequence as mixed effects, and loudness*ambient as fixed effects

mNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                              UASLoudECMAHMSPowAvgBin*AmbientEnv +
                              (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                              data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ TrialNumber + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ TrialNumber | ID. + AmbientEnv, data=subjDataA,
                       model1=mNxEnv.NEnv, model2=mNxEnvSq.NEnvSq, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnv, model2=mNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq)

```
### show plot of model predictions with CIs and mean data points

```{r}

df <- subjDataA |> dplyr::group_by(TrialNumber, AmbientEnv) |> dplyr::summarise(Annoyance = mean(Annoyance), UASLoudECMAHMSPowAvgBin = mean(UASLoudECMAHMSPowAvgBin), .groups = 'keep')

pred <- ggeffects::predict_response(mNxEnvSq.NEnvSq, terms=c("TrialNumber [all]", "AmbientEnv"), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "TrialNumber"
colnames(pred)[which(names(pred) == "group")] <- "AmbientEnv"

ggplot(pred, aes(color=AmbientEnv)) +
  geom_ribbon(mapping=aes(TrialNumber, ymin=conf.low, ymax=conf.high, fill=AmbientEnv),
                          alpha=0.1, colour = NA) +
  geom_line(mapping=aes(TrialNumber, predicted)) +
  geom_point(data=df, mapping=aes(x=TrialNumber, y=Annoyance, colour = AmbientEnv, shape=AmbientEnv), alpha=0.5) +
  facet_wrap(vars(AmbientEnv)) +
  scale_x_continuous(n.breaks=10, limits=c(1, 80)) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) +
labs(x="Trial number", y="Annoyance", colour = "Amb. env.", fill = "Amb. env.", shape = "Amb. env.") + 
scale_color_manual(values = c("Street" = mycolours[1], "Park" = mycolours[2])) + 
  scale_fill_manual(values = c("Street" = mycolours[1], "Park" = mycolours[2]))


```
```{r, fig.width=6, fig.height=5}

df <- subjDataA |> dplyr::group_by(TrialNumber) |> dplyr::summarise(Annoyance = mean(Annoyance), UASLoudECMAHMSPowAvgBin = mean(UASLoudECMAHMSPowAvgBin), .groups = 'keep')

pred <- ggeffects::predict_response(mNxEnvSq.NEnvSq, terms=c("TrialNumber [all]"), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "TrialNumber"

ggplot(pred) +
  geom_ribbon(mapping=aes(TrialNumber, ymin=conf.low, ymax=conf.high, group=1),
                          alpha=0.1, colour = NA, fill=mycolours[3]) +
  geom_line(mapping=aes(TrialNumber, predicted), color=mycolours[3]) +
  geom_point(data=df, mapping=aes(x=TrialNumber, y=Annoyance, group=1), color=mycolours[3], alpha=0.5) +
  scale_x_continuous(n.breaks=10, limits=c(1, 80)) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif", size=12), axis.text = element_text(size=12), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) +
labs(x="Trial number", y="Annoyance")


```


## Sound quality models

### Sharpness

#### independent (fixed)

```{r}

# mixed model with HMS loudness, ambient env  and trial sequence as mixed effects, and sharpness and loudness*ambient as fixed effects
mSNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                               UASLoudECMAHMSPowAvgBin*AmbientEnv +
                               UASSharpAuresISO305ExMaxLR +
                               (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                               data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mSNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)


flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASSharpAuresISO305ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mNxEnvSq.NEnvSq, model2=mSNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnvSq, model2=mSNxEnvSq.NEnvSq)

lmtest::lrtest(mNxEnvSq.NEnvSq, mSNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq)

```
#### random effect

```{r}

# mixed model with HMS loudness, ambient env  and trial sequence as mixed effects, and sharpness and loudness*ambient as fixed effects
mSNxEnvSq.SNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                               UASLoudECMAHMSPowAvgBin*AmbientEnv +
                               UASSharpAuresISO305ExMaxLR +
                               (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                  UASSharpAuresISO305ExMaxLR + AmbientEnv | ID.),
                               data=subjDataA, control=control,
                               REML=FALSE)

flexplot::visualize(mSNxEnvSq.SNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASSharpAuresISO305ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSNxEnvSq.NEnvSq, model2=mSNxEnvSq.SNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSNxEnvSq.NEnvSq, model2=mSNxEnvSq.SNEnvSq)

lmtest::lrtest(mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq)

```


#### interaction with loudness

```{r}

# mixed model with HMS loudness, ambient env and trial sequence as mixed effects, and sharpness, sharpness*loudness and loudness*ambient as fixed effects
mSxNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                UASLoudECMAHMSPowAvgBin*UASSharpAuresISO305ExMaxLR +
                                UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                                data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mSxNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASSharpAuresISO305ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mNxEnvSq.NEnvSq, model2=mSxNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnvSq, model2=mSxNxEnvSq.NEnvSq)

lmtest::lrtest(mNxEnvSq.NEnvSq, mSxNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq)

```
#### interaction (sharpness with tonality)

```{r}

# mixed model

mSxTNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                 UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                 UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                 (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                                 data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mSxTNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASTonalInt05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mSxTNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mSxTNxEnvSq.NEnvSq)

lmtest::lrtest(mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq)

```
#### interaction (sharpness with tonal loudness)

```{r}

# mixed model

mSxTnNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonLdECMAHMSPowAvgBin*UASSharpAuresISO305ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mSxTnNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASTonLdECMAHMSPowAvgBin + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mSxTnNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mSxTnNxEnvSq.NEnvSq)

lmtest::lrtest(mSxNxEnvSq.NEnvSq, mSxTnNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq)

```

### Tonality

#### independent

```{r}

# mixed model with HMS loudness, ambient env and trial sequence as mixed effects, and sharpness, sharpness*loudness, tonality and loudness*ambient as fixed effects
mTSxNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                 UASLoudECMAHMSPowAvgBin*UASSharpAuresISO305ExMaxLR +
                                 UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                 UASTonalInt05ExMaxLR +
                                 (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                                 data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mTSxNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASTonalInt05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mTSxNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mTSxNxEnvSq.NEnvSq)


lmtest::lrtest(mSxNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq)

```

#### independent (tonal loudness)

```{r}

# mixed model with HMS loudness, ambient env and trial sequence as mixed effects, and sharpness, tonal loudness, loudness*sharpness and loudness*ambient as fixed effects
mTnSxNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*UASSharpAuresISO305ExMaxLR +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonLdECMAHMSPowAvgBin +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mTnSxNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASTonLdECMAHMSPowAvgBin + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mTnSxNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mTnSxNxEnvSq.NEnvSq)

lmtest::lrtest(mSxNxEnvSq.NEnvSq, mTnSxNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq)

```

#### random effect

```{r}

# mixed model

mTSxNxEnvSq.TNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                 UASLoudECMAHMSPowAvgBin*UASSharpAuresISO305ExMaxLR +
                                 UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                 UASTonalInt05ExMaxLR +
                                 (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + UASTonalInt05ExMaxLR + 
                                    AmbientEnv | ID.),
                                 data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mTSxNxEnvSq.TNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASTonalInt05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mTSxNxEnvSq.TNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mTSxNxEnvSq.TNEnvSq)

lmtest::lrtest(mSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq)

```

### Fluctuation strength

#### independent (fixed)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.NEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq)

```

#### random effect

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with ambient)

```{r}

# mixed model with HMS loudness, ambient env and trial sequence as mixed effects, and sharpness, tonality, fluctuation strength, fluctuation*ambient and loudness*sharpness*ambient as fixed effects
mFxEnvSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                      UASFluctOV10ExMaxLR*AmbientEnv +
                                      (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                      data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFxEnvSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxEnvSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxEnvSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxEnvSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with loudness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxNSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASLoudECMAHMSPowAvgBin +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFxNSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxNSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxNSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxNSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq)

```
#### interaction (fluctuation with sharpness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxSSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFxSSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxSSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxSSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxSSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq)

```
#### interaction (fluctuation with tonality)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxTSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASTonalInt05ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFxTSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxTSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxTSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxTSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with roughness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxRSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASRoughFZ05ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFxRSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxRSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxRSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxRSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with impulsiveness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxISxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASImpulsHMSAvgMaxLR +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFxISxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASFluctOV10ExMaxLR + UASImpulsHMSAvgMaxLR + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxISxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxISxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxISxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq)

```


### Roughness

#### independent (fixed)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mRFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq)

```

#### random effect

```{r}

# mixed model
# fixed effects: 
# random effects: 

# optimx_options <- c("L-BFGS-B", "nlminb", "nlm", "bobyqa", "nmkb", "hjkb")
# for(i in 1:length(optimx_options)){
#   print(paste0("Testing optimx: ", optimx_options[i]))
#   mRFSxTNxEnvSq.RFNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
#                                   UASLoudECMAHMSPowAvgBin*AmbientEnv +
#                                   UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
#                                   UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                   (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
#                                      UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                      AmbientEnv | ID.),
#                                   data=subjDataA, control=lme4::lmerControl(optimizer = "optimx",
#                                            optCtrl = list(method = optimx_options[i],
#                                                                    maxit = 1e9)),
#                                   REML=F)
#   if(is.null(mRFSxTNxEnvSq.RFNEnvSq@optinfo$conv$lme4$messages)){
#     print(paste0("One of the optimx options, ", optimx_options[i],", worked!"))
#     print(mRFSxTNxEnvSq.RFNEnvSq)
#     break
#   }
# }
# 
# 
# algoptions <- c("NLOPT_LN_PRAXIS", "NLOPT_GN_CRS2_LM",
# "NLOPT_LN_COBYLA", "NLOPT_LN_NEWUOA",
# "NLOPT_LN_NEWUOA_BOUND", "NLOPT_LN_NELDERMEAD",
# "NLOPT_LN_SBPLX", "NLOPT_LN_BOBYQA")
# 
# for(i in 1:length(algoptions)){
#   print(paste0("Testing nloptwrap: ", algoptions[i]))
#   mRFSxTNxEnvSq.RFNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
#                                   UASLoudECMAHMSPowAvgBin*AmbientEnv +
#                                   UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
#                                   UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                   (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
#                                      UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                      AmbientEnv | ID.),
#                                   data=subjDataA, 
#                      control = lme4::lmerControl(optimizer = "nloptwrap",
#                                            optCtrl = list(algorithm = algoptions[i],
#                                                           maxfun = 1e9,
#                                                           maxeval = 1e7,
#                                                           xtol_abs = 1e-9,
#                                                           ftol_abs = 1e-9)), REML=F)
#   if(is.null(mRFSxTNxEnvSq.RFNEnvSq@optinfo$conv$lme4$messages)){
#     print(paste0("One of the nloptwrap options, ", algoptions[i],", worked!"))
#     print(mRFSxTNxEnvSq.RFNEnvSq)
#     break
#   }
# }

```

```{r}

# fails to converge using any optimiser
tempcontrol <- lme4::lmerControl(optimizer = 'nmkbw',
                                 optCtrl = list(maxfun=4e6, maxfeval=4e6, maxit = 4e6))

mRFSxTNxEnvSq.RFNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                     AmbientEnv | ID.),
                                  data=subjDataA, control=tempcontrol,
                                  REML=FALSE)

flexplot::visualize(mRFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.RFNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.RFNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.RFNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRFSxTNxEnvSq.RFNEnvSq)

# since it failed to converge, the results are not carried forwards in the analysis

```

#### interaction (roughness with loudness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASLoudECMAHMSPowAvgBin +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mRxNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq)

```

#### interaction (roughness with tonality)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxTFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASTonalInt05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mRxTFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxTFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxTFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq)

```

#### interaction (roughness with sharpness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxSFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + 
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mRxSFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxSFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxSFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxSFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq)

```
#### interaction (roughness with ambient)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxEnvFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin + 
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mRxEnvFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxEnvFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxEnvFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq)

```
#### interaction (roughness with impulsiveness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxIFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASImpulsHMSAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mRxIFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASRoughFZ05ExMaxLR + UASImpulsHMSAvgMaxLR + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxIFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxIFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxIFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq)

```



### Impulsiveness

#### independent (fixed)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASImpulsHMSAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASImpulsHMSAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq)

```
#### random effect

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIFSxTNxEnvSq.IFNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASImpulsHMSAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASImpulsHMSAvgMaxLR + UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIFSxTNxEnvSq.IFNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASImpulsHMSAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.IFNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.IFNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.IFNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq)

```
#### interaction (impulsiveness with loudness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                     UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                     UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASImpulsHMSAvgMaxLR*UASLoudECMAHMSPowAvgBin +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIxNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASImpulsHMSAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq)

```

#### interaction (impulsiveness with ambient)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxEnvFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                       UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                       UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                       UASFluctOV10ExMaxLR +
                                       UASImpulsHMSAvgMaxLR*AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIxEnvFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASImpulsHMSAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxEnvFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxEnvFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq)

```
#### interaction (impulsiveness with sharpness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxSFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                       UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                       UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                       UASFluctOV10ExMaxLR +
                                       UASImpulsHMSAvgMaxLR*UASSharpAuresISO305ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIxSFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASImpulsHMSAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxSFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxSFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxSFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq,
                                 mIxSFSxTNxEnvSq.FNEnvSq)

```
#### interaction (impulsiveness with tonality)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxTFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                       UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                       UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                       UASFluctOV10ExMaxLR +
                                       UASImpulsHMSAvgMaxLR*UASTonalInt05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIxTFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASImpulsHMSAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxTFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxTFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxTFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLAeq.LAeq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq,
                                 mIxSFSxTNxEnvSq.FNEnvSq, mIxTFSxTNxEnvSq.FNEnvSq)

```
## Test if adding UAS type or operation adds further explanatory power

### UAS type

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqType.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASType +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqType.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv + UASType)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASType + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqType.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqType.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq)

```
### UAS type interaction with env

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqTypexEnv.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASType + UASType:AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqType.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv + UASType)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASType + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypexEnv.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypexEnv.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqTypexEnv.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq)

```

### UAS operation

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqOp.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASOperation +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                    UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqOp.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv + UASOperation)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASOperation + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOp.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOp.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq)

```

### UAS operation interaction with env

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqOpxEnv.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASOperation + UASOperation:AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                    UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqOpxEnv.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv + UASOperation)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASOperation + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOpxEnv.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOpxEnv.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqOpxEnv.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq,
                                 mFSxTNxEnvSqOpxEnv.FNEnvSq)

```

### UAS type x operation interaction

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqTypeOp.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASType*UASOperation + 
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqTypeOp.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv + UASType)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | UASOperation + UASType + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypeOp.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypeOp.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqTypeOp.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq,
                                 mFSxTNxEnvSqOpxEnv.FNEnvSq, mFSxTNxEnvSqTypeOp.FNEnvSq)

```
## Test if adding difference variables adds further explanatory power

### PNLM-LAeq

```{r}

# mixed model
# fixed effects: 
# random effects:

# remove No UAS scenarios
df <- subjDataA[complete.cases(subjDataA),]
df$PNLMLAeqdiff <- as.numeric(df$PNLMLAeqdiff)

# refit main model
mFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=df, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)


mPNLdLAeqFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    PNLMLAeqdiff +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=df, control=control, REML=FALSE)

flexplot::visualize(mPNLdLAeqFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | PNLMLAeqdiff + ID., data=df,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPNLdLAeqFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPNLdLAeqFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mPNLdLAeqFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPNLdLAeqFSxTNxEnvSq.FNEnvSq)

# refit main model with full data
mFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                  UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                  UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

```
### Partial loudness

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      PartLoudGMSTPowAvg +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mPtNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ PartLoudGMSTPowAvg + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | PartLoudGMSTPowAvg + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mPtNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNFSxTNxEnvSq.FNEnvSq)

```

### Does partial loudness explain the variation better than loudness with ambient?

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNFSxTSq.PtNFSq <- lme4::lmer(Annoyance ~ TrialNumber + PartLoudGMSTPowAvg +
                                UASSharpAuresISO305ExMaxLR*UASTonalInt05ExMaxLR +
                                 UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + PartLoudGMSTPowAvg + UASFluctOV10ExMaxLR | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mPtNFSxTSq.PtNFSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ PartLoudGMSTPowAvg + ID.)

flexplot::compare.fits(Annoyance ~ PartLoudGMSTPowAvg | ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTSq.PtNFSq, clusters=5, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTSq.PtNFSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNFSxTSq.PtNFSq)

```
Or with ambient?

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNEnvSq.PtNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber + PartLoudGMSTPowAvg +
                                  AmbientEnv +
                                  (1 + TrialNumber + PartLoudGMSTPowAvg + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mPtNEnvSq.PtNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ PartLoudGMSTPowAvg + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ PartLoudGMSTPowAvg | ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNEnvSq.PtNEnvSq, clusters=5, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNEnvSq.PtNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNEnvSq.PtNEnvSq)

```

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNxEnvFSxTEnvSq.PtNxEnvSq <- lme4::lmer(Annoyance ~ TrialNumber + PartLoudGMSTPowAvg*AmbientEnv +
                                           UASFluctOV10ExMaxLR +
                                    UASSharpAuresISO305ExMaxLR*UASTonalInt05ExMaxLR +
                                  (1 + TrialNumber + PartLoudGMSTPowAvg*AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mPtNxEnvFSxTEnvSq.PtNxEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ PartLoudGMSTPowAvg + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ PartLoudGMSTPowAvg | ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNxEnvFSxTEnvSq.PtNxEnvSq, clusters=5, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNxEnvFSxTEnvSq.PtNxEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNxEnvFSxTEnvSq.PtNxEnvSq)

```


### Impulsiveness difference

```{r}

# mixed model
# fixed effects: 
# random effects:

mdIFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      dImpulsHMSAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mdIFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv + dImpulsHMSAvgMaxLR, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mdIFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mdIFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mdIFSxTNxEnvSq.FNEnvSq)

```
## Test if adding intermittency ratio adds further explanatory power

```{r}

# mixed model
# fixed effects: 
# random effects:

mIRFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR + IntermitRatioMaxLR +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                     data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mIRFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv + IntermitRatioMaxLR, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIRFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIRFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIRFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mIRFSxTNxEnvSq.FNEnvSq)

```
## Test if raising loudness to exponent adds further explanatory power

```{r}

# mixed model
# fixed effects: 
# random effects:

mPwNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber + I(UASLoudECMAHMSPowAvgBin^2) +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                     data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mPwNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPwNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPwNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mPwNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPwNFSxTNxEnvSq.FNEnvSq)

```

## Test if adding random effect for loudness x env interaction adds further explanatory power

```{r}

# mixed model
# fixed effects: 
# random effects:

mNFSxTNxEnvSq.FNxEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                    (1 + TrialNumber +
                                       UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                       UASFluctOV10ExMaxLR | ID.),
                                     data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mNFSxTNxEnvSq.FNxEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mNFSxTNxEnvSq.FNxEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mNFSxTNxEnvSq.FNxEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mNFSxTNxEnvSq.FNxEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mNFSxTNxEnvSq.FNxEnvSq)

```

## Personal factors

### AAM attitude

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAtt.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAtt.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + AAM_attitude2 | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | AAM_attitude2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqAtt.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq)

```
### AAM attitude (alternative groupings)

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAtt2.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2_2 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAtt2.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + AAM_attitude2_2 | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | AAM_attitude2_2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqAtt2.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt2.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt2.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAtt2.FNEnvSq)

```

### AAM attitude interaction with env

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxEnv.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 + AAM_attitude2:AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxEnv.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + AAM_attitude2 | AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | AAM_attitude2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqAttxEnv.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAttxEnv.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAttxEnv.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq)

```

### Area of residence

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttAoR.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 + Home_Area2 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttAoR.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + Home_Area2 | AAM_attitude2 + AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | Home_Area2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttAoR.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq)

```

### Area of residence interaction with attitude

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxAoR.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*Home_Area2 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxAoR.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + Home_Area2 | AAM_attitude2 + AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | Home_Area2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttxAoR.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxAoR.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxAoR.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq)

```

### National region


```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttNat.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 + NationGeo3 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

#data = subjDataA |> group_by(AmbientEnv, UASLoudECMAHMSPowAvgBin, AAM_attitude2, NationGeo3) |> summarise(Annoyance = mean(Annoyance))

flexplot::visualize(mFSxTNxEnvSqAttNat.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + NationGeo3 | AmbientEnv + AAM_attitude2) +
          xlab(bquote("UAS loudness, sones"[HMS])) + labs(color = "Region of nationality", shape = "Region of nationality", linetype = "Region of nationality") +
          scale_y_continuous(n.breaks=10) + scale_x_continuous(n.breaks=6) +
          theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 0, maxColorValue = 255)))
          
          #geom_point(data=data, aes(x=UASLoudECMAHMSPowAvgBin, y=Annoyance, shape=NationGeo3))

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | NationGeo3 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttNat.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq)

```

### National region interaction with AAM attitude

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxNat.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*NationGeo3 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

#data = subjDataA |> group_by(AmbientEnv, UASLoudECMAHMSPowAvgBin, AAM_attitude2, NationGeo3) |> summarise(Annoyance = mean(Annoyance))

flexplot::visualize(mFSxTNxEnvSqAttxNat.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + NationGeo3 | AmbientEnv + AAM_attitude2) +
          xlab(bquote("UAS loudness, sones"[HMS])) + labs(color = "Region of nationality", shape = "Region of nationality", linetype = "Region of nationality") +
          scale_y_continuous(n.breaks=10) + scale_x_continuous(n.breaks=6) +
          theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 0, maxColorValue = 255)))
          
          #geom_point(data=data, aes(x=UASLoudECMAHMSPowAvgBin, y=Annoyance, shape=NationGeo3))

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | NationGeo3 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttxNat.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxNat.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxNat.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq,
                                 mFSxTNxEnvSqAttxNat.FNEnvSq)

```

### PANAS negative

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxNatPAn.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*NationGeo3 +
                                      PANAS_negative +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxNatPAn.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | PANAS_negative + AAM_attitude2)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | PANAS_negative + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAttxNat.FNEnvSq, model2=mFSxTNxEnvSqAttxNatPAn.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq,
                                 mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq)

```

### Area soundscape

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxNatScp.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumber +
                                    UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                    UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*NationGeo3 +
                                      Area_soundscape2 +
                                  (1 + TrialNumber + UASLoudECMAHMSPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=control, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxNatScp.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLoudECMAHMSPowAvgBin + ID. | Area_soundscape2 + AmbientEnv)

flexplot::compare.fits(Annoyance ~ UASLoudECMAHMSPowAvgBin | Area_soundscape2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAttxNat.FNEnvSq, model2=mFSxTNxEnvSqAttxNatScp.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatScp.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatScp.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq,
                                 mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq,
                                 mFSxTNxEnvSqAttxNatScp.FNEnvSq)

```

## Examine best performing models

### model parameters

```{r}
mFSxTNxEnvSq.FNEnvSq.params <- parameters::model_parameters(mFSxTNxEnvSq.FNEnvSq)
mFSxTNxEnvSq.FNEnvSq.params
mFSxTNxEnvSq.FNEnvSq.perform <- performance::model_performance(mFSxTNxEnvSq.FNEnvSq, estimator='ML')
mFSxTNxEnvSq.FNEnvSq.perform

mFSxTNxEnvSqAttxNat.FNEnvSq.params <- parameters::model_parameters(mFSxTNxEnvSqAttxNat.FNEnvSq)
mFSxTNxEnvSqAttxNat.FNEnvSq.params
mFSxTNxEnvSqAttxNat.FNEnvSq.perform <- performance::model_performance(mFSxTNxEnvSqAttxNat.FNEnvSq, estimator='ML')
mFSxTNxEnvSqAttxNat.FNEnvSq.perform

```

# Part B analysis

## Fit a baseline model

```{r}
# baseline model (no predictors, only clustered intercept)
mBBL <- lme4::lmer(Annoyance ~ 1 + (1 | ID.), data=subjDataB,
                  control=control, REML=FALSE)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mBBL)
performance::r2(mBBL)

params <- parameters::model_parameters(mBBL)

```

```{r, fig.width=9, fig.height=5}
# plot the baseline

pred <- ggeffects::predict_response(mBBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

df <- data.frame(ID=pred$ID., Annoyance=pred$predicted,
                   AnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   AnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   AnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=AnnoyCILow, ymax=AnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[1]) +
  geom_line(mapping=aes(ID, AnnoyMean), group=1, color=mycolours[1]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[1], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=10),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Mean annoyance rating")

```

## Basic comparison model

```{r}

mBLAeq.LAeq <- lme4::lmer(Annoyance ~ LAeqMaxLR + (1 + LAeqMaxLR | ID.), data=subjDataB,
                         control=control, REML=FALSE)

flexplot::visualize(mBLAeq.LAeq, plot='model',
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ LAeqMaxLR | ID., data=subjDataB,
                       model1=mBBL, model2=mBLAeq.LAeq, clusters=5, re=T)

flexplot::model.comparison(model1=mBBL, model2=mBLAeq.LAeq)

lmtest::lrtest(mBBL, mBLAeq.LAeq)

performance::compare_performance(mBBL, mBLAeq.LAeq)

```
```{r}

mBLAeq <- lme4::lmer(Annoyance ~ LAeqMaxLR + (1 | ID.), data=subjDataB,
                         control=control, REML=FALSE)

flexplot::visualize(mBLAeq, plot='model',
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ LAeqMaxLR | ID., data=subjDataB,
                       model1=mBLAeq.LAeq, model2=mBLAeq, clusters=5, re=T)

flexplot::model.comparison(model1=mBLAeq.LAeq, model2=mBLAeq)

lmtest::lrtest(mBLAeq, mBLAeq.LAeq)  # note order of inputs is reversed

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq)

```


## Event quantity model

```{r, fig.width=10,fig.height=5}
mBQ <- lme4::lmer(Annoyance ~ UASEvents +
                   (1 | ID.), data=subjDataB,
                   control=control, REML=FALSE)

mBQ.Q <- lme4::lmer(Annoyance ~ UASEvents +
                     (1 + UASEvents | ID.), data=subjDataB,
                     control=control, REML=FALSE)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBBL, model2=mBQ, clusters=5, re=T)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBBL, model2=mBQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBQ, model2=mBQ.Q)

MuMIn::AICc(mBQ, mBQ.Q)

lmtest::lrtest(mBQ, mBQ.Q)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q)

```
#### power transformation of events

```{r}

mBPwQ.Q <- lme4::lmer(Annoyance ~ UASEvents + I(UASEvents^0.17) +
                     (1 + UASEvents | ID.), data=subjDataB,
                     control=control, REML=FALSE)

flexplot::visualize(mBPwQ.Q, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBQ.Q, model2=mBPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBQ.Q, model2=mBPwQ.Q)

lmtest::lrtest(mBQ.Q, mBPwQ.Q)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q)

```
##Loudness
### Loudness with events^pwr

```{r}

mBNPwQ.Q <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin +
                         UASEvents + I(UASEvents^0.17) +
                       (1 + UASEvents | ID.), data=subjDataB,
                       control=control, REML=FALSE)

flexplot::visualize(mBNPwQ.Q, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASLoudECMAHMSPowAvgBin + ID., data=subjDataB,
                       model1=mBPwQ.Q, model2=mBNPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBPwQ.Q, model2=mBNPwQ.Q)

lmtest::lrtest(mBPwQ.Q, mBNPwQ.Q)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q)

```
### Loudness as mixed with events^pwr

```{r}

mBNPwQ.NQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin +
                         UASEvents + I(UASEvents^0.17) +
                        (1 + UASLoudECMAHMSPowAvgBin + UASEvents | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNPwQ.NQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASLoudECMAHMSPowAvgBin + ID., data=subjDataB,
                       model1=mBNPwQ.Q, model2=mBNPwQ.NQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNPwQ.Q, model2=mBNPwQ.NQ)

lmtest::lrtest(mBNPwQ.Q, mBNPwQ.NQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ)

```

### Loudness*events + events^pwr

```{r}

mBNxQPwQ.Q <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + I(UASEvents^0.17) +
                        (1 + UASEvents | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxQPwQ.Q, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNPwQ.Q, model2=mBNxQPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBNPwQ.Q, model2=mBNxQPwQ.Q)

lmtest::lrtest(mBNPwQ.Q, mBNxQPwQ.Q)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q)

```

### Loudness*events^pwr

```{r}

mBNxPwQ.Q <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASEvents | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxPwQ.Q, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNPwQ.Q, model2=mBNxPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBNPwQ.Q, model2=mBNxPwQ.Q)

lmtest::lrtest(mBNPwQ.Q, mBNxPwQ.Q)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q)

```
### Loudness*events^pwr as mixed

```{r}

mBNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ)

```
### Loudness*events^pw as fixed and loudness + events^pw as random

```{r}

mBNxPwQ.NPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAHMSPowAvgBin + I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxPwQ.NPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.NPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.NPwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.NPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ)

```

### Loudness fixed + events^pw as mixed

```{r}

mBNxPwQ.PwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxPwQ.PwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.PwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.PwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.PwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ)

```

### Loudness + events^pw as mixed

```{r}

mBNxPwQ.QNxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxPwQ.QNxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.QNxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.QNxPwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.QNxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ)

```

## Trial sequence

### fixed effect

```{r}

mBNxPwQSq.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                            TrialNumber +
                            (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                            control=control, REML=FALSE)

flexplot::visualize(mBNxPwQSq.NPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ TrialNumber | UASEvents + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBNxPwQSq.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, mBNxPwQSq.NxPwQ)

```

### mixed effect

```{r}

mBNxPwQSq.NxPwQSq <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                  TrialNumber +
                              (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) + TrialNumber | ID.), data=subjDataB,
                              control=control, REML=FALSE)


flexplot::visualize(mBNxPwQSq.NxPwQSq, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ TrialNumber | UASEvents + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQSq, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQSq)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBNxPwQSq.NxPwQSq)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq)

```
### show plot of model predictions with CIs and mean data points

```{r, fig.width=6, fig.height=5}

df <- subjDataB |> dplyr::group_by(TrialNumber) |> dplyr::summarise(Annoyance = mean(Annoyance), .groups = 'keep')

pred <- ggeffects::predict_response(mBNxPwQSq.NxPwQSq, terms=c("TrialNumber [all]"), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "TrialNumber"

ggplot(pred) +
  geom_ribbon(mapping=aes(TrialNumber, ymin=conf.low, ymax=conf.high, group=1),
                          alpha=0.1, colour = NA, fill=mycolours[1]) +
  geom_line(mapping=aes(TrialNumber, predicted), color=mycolours[1]) +
  geom_point(data=df, mapping=aes(x=TrialNumber, y=Annoyance, group=1), color=mycolours[1], alpha=0.5) +
  scale_x_continuous(n.breaks=17, limits=c(1, 17)) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif", size=12), axis.text=element_text(size=12),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) +
labs(x="Trial number", y="Annoyance")


```

## Sound quality models

### Tonality 

#### Tonal loudness (independent)

```{r}

mBTnNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                UASTonLdECMAHMSPowAvgBin +
                              (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBTnNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonLdECMAHMSPowAvgBin + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTnNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTnNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTnNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ)

```
#### Tonal loudness*events^pw

```{r}

mBTnxPwQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                  UASTonLdECMAHMSPowAvgBin*UASEvents + UASTonLdECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                                control=control, REML=FALSE)

flexplot::visualize(mBTnxPwQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonLdECMAHMSPowAvgBin + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTnxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTnxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ)

```
#### Tonality (integrated HMS)

```{r}

mBTNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASTonalInt05ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBTNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonalInt05ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ)

```

#### Tonality (Aures)

```{r}

mBTNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBTNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ)

```

#### Tonality (Aures)*events^pw

```{r}

mBTxPwQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR*I(UASEvents^0.17) +
                              (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBTxPwQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ)

```
#### Tonality (Aures as mixed)

```{r}

mBTNxPwQ.TNxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR +
                              (1 + UASTonalAu10ExMaxLR + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBTNxPwQ.TNxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.TNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.TNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTNxPwQ.TNxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ, mBTNxPwQ.TNxPwQ)

```
```{r}

# mixed model
# fixed effects: 
# random effects: 

# optimx_options <- c("L-BFGS-B", "nlminb", "nlm", "bobyqa", "nmkb", "hjkb")
# for(i in 1:length(optimx_options)){
#   print(paste0("Testing optimx: ", optimx_options[i]))
#   mBTNxPwQ.TNPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
#                               UASTonalAu10ExMaxLR +
#                               (1 + UASTonalAu10ExMaxLR + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
#                               control=lme4::lmerControl(optimizer = "optimx",
#                                             optCtrl = list(method = optimx_options[i],
#                                                                     maxit = 1e9)), REML=FALSE)
# 
#    if(is.null(mBTNxPwQ.TNPwQ@optinfo$conv$lme4$messages)){
#      print(paste0("One of the optimx options, ", optimx_options[i],", worked!"))
#      print(mBTNxPwQ.TNPwQ)
#      break
#  }
# }
# 
#  
# algoptions <- c("NLOPT_LN_PRAXIS", "NLOPT_GN_CRS2_LM",
# "NLOPT_LN_COBYLA", "NLOPT_LN_NEWUOA",
# "NLOPT_LN_NEWUOA_BOUND", "NLOPT_LN_NELDERMEAD",
# "NLOPT_LN_SBPLX", "NLOPT_LN_BOBYQA")
#  
# for(i in 1:length(algoptions)){
#   print(paste0("Testing nloptwrap: ", algoptions[i]))
#   mBTNxPwQ.TNPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
#                               UASTonalAu10ExMaxLR +
#                               (1 + UASTonalAu10ExMaxLR + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
#                               control = lme4::lmerControl(optimizer = "nloptwrap",
#                                             optCtrl = list(algorithm = algoptions[i],
#                                                            maxfun = 1e9,
#                                                            maxeval = 1e7,
#                                                            xtol_abs = 1e-9,
#                                                            ftol_abs = 1e-9)), REML=FALSE)
#    if(is.null(mBTNxPwQ.TNPwQ@optinfo$conv$lme4$messages)){
#      print(paste0("One of the nloptwrap options, ", algoptions[i],", worked!"))
#      print(mBTNxPwQ.TNPwQ)
#      break
#    }
#  }


```


#### Tonality (Aures interaction sharpness)

```{r}

mBTxSNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR*UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBTxSNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTxSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTxSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ)

```


### Roughness

#### independent

```{r}

mBRNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ)

```

#### mixed

```{r}

mBRNxPwQ.RNxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR +
                              (1 + UASRoughFZ10ExMaxLR + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRNxPwQ.RNxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.RNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.RNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRNxPwQ.RNxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRNxPwQ.RNxPwQ)

```

#### interaction (events)

```{r}

mBRxPwQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR:I(UASEvents^0.17) +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRxPwQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID. + UASRoughFZ10ExMaxLR,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxPwQNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ)

```

#### interaction (loudness)

```{r}

mBRxNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASLoudECMAHMSPowAvgBin +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRxNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ)

```
#### interaction (fluctuation)

```{r}

mBRxFNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASFluctOV10ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRxFNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxFNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxFNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxFNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ)

```
#### interaction (sharpness)

```{r}

mBRxSNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRxSNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ)

```

#### interaction (tonality)

```{r}

mBRxTNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASTonalInt05ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRxTNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASTonalInt05ExMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ)

```

#### interaction (impulsiveness)

```{r}

mBRxINxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASImpulsHMSAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBRxINxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASImpulsHMSAvgMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ)

```


### Fluctuation strength

#### independent

```{r}

mBFNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ)

```

#### mixed

```{r}

mBFNxPwQ.FNxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR +
                              (1 + UASFluctOV10ExMaxLR + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFNxPwQ.FNxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.FNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.FNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFNxPwQ.FNxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFNxPwQ.FNxPwQ)

```

#### interaction (events)

```{r}

mBFxQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASEvents +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFxQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ)

```

#### interaction (loudness)

```{r}

mBFxNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASLoudECMAHMSPowAvgBin +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFxNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASLoudECMAHMSPowAvgBin + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ)

```

#### interaction (sharpness)

```{r}

mBFxSNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFxSNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ)

```

#### interaction (tonality)

```{r}

mBFxTNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASTonalInt05ExMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFxTNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASTonalInt05ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxTNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ)

```

#### interaction (impulsiveness)

```{r}

mBFxINxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASImpulsHMSAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBFxINxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASImpulsHMSAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ)

```

### Sharpness

#### independent

```{r}

mBSNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBSNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ)

```

#### mixed

```{r}

mBSNxPwQ.SNxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASSharpAuresISO3PowAvgMaxLR + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBSNxPwQ.SNxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.SNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.SNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSNxPwQ.SNxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSNxPwQ.SNxPwQ)

```

#### interaction (events)

```{r}

mBSxPwQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR*UASEvents +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBSxPwQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ)

```

#### interaction (loudness)

```{r}

mBSxNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR*UASLoudECMAHMSPowAvgBin +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBSxNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSxNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSxNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSxNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ)

```

#### interaction (impulsiveness)

```{r}

mBSxINxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR*UASImpulsHMSAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBSxINxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + UASImpulsHMSAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSxINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSxINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ)

```

### Impulsiveness 

#### independent

```{r}

mBINxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASImpulsHMSAvgMaxLR +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBINxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASImpulsHMSAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ,
                                 mBINxPwQ.NxPwQ)

```

#### interaction (events^pw)

```{r}

mBIxPwQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASImpulsHMSAvgMaxLR + UASImpulsHMSAvgMaxLR:I(UASEvents^0.17) +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBIxPwQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASImpulsHMSAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBIxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBIxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBIxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ,
                                 mBINxPwQ.NxPwQ, mBIxPwQNxPwQ.NxPwQ)

```

#### interaction (events)

```{r}

mBIxQNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                              UASImpulsHMSAvgMaxLR + UASImpulsHMSAvgMaxLR:UASEvents +
                              (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBIxQNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASImpulsHMSAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBIxQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBIxQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBIxQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLAeq.LAeq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ,
                                 mBINxPwQ.NxPwQ, mBIxPwQNxPwQ.NxPwQ,
                                 mBIxQNxPwQ.NxPwQ)

```

## Test if adding UAS type adds further explanatory power

```{r}

mBNxPwQType.NxPwQ <- lme4::lmer(Annoyance ~ UASType + UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBNxPwQType.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID. | UASType,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | UASType + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBNxPwQType.NxPwQ, clusters=3, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBNxPwQType.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBNxPwQType.NxPwQ)

performance::compare_performance(mBNxPwQ.NxPwQ, mBNxPwQType.NxPwQ)

```

## Test if adding difference variables adds further explanatory power

### dSharpness (fixed)

```{r}

mBdSNxPwQ.NxPwQ <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR + UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + dSharpAuresISO3PowAvgMaxLR, data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBdSNxPwQ.NxPwQ, clusters=3, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBdSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBdSNxPwQ.NxPwQ)

performance::compare_performance(mBNxPwQ.NxPwQ, mBdSNxPwQ.NxPwQ)

```
### dSharpness (mixed)

```{r}

mBdSNxPwQ.dSNxPwQ <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR + UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                        (1 + dSharpAuresISO3PowAvgMaxLR + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.dSNxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | dSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.dSNxPwQ, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.dSNxPwQ)

lmtest::lrtest(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.dSNxPwQ)

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.dSNxPwQ)

```
## Test if adding intermittency ratio improves model

```{r}

mBdSNxPwQIR.NxPwQ <- lme4::lmer(Annoyance ~ IntermitRatioMaxLR + dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                          (1  + UASLoudECMAHMSPowAvgBin +
                                 UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                          control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQIR.NxPwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + IntermitRatioMaxLR, data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQIR.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQIR.NxPwQ)

lmtest::lrtest(mBdSNxPwQ.NxPwQ, mBdSNxPwQIR.NxPwQ)

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQIR.NxPwQ)

```

## Test if removing loudness*events^pw random effects improves model

```{r}

mBdSNxPwQ.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                          (1 + UASEvents | ID.), data=subjDataB,
                          control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.Q, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQ.NxPwQ)  # Note the order of inputs has reversed here

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.Q)

```

```{r}

mBdSNxPwQ.PwQ <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                          (1 + I(UASEvents^0.17) | ID.), data=subjDataB,
                          control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.PwQ, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.PwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.PwQ)

lmtest::lrtest(mBdSNxPwQ.PwQ, mBdSNxPwQ.NxPwQ)  # Note the order of inputs has reversed here

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.Q,
                                 mBdSNxPwQ.PwQ)

```


```{r}

mBdSNxQPwQ.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAHMSPowAvgBin*UASEvents + I(UASEvents^0.17) +
                          (1 + UASEvents | ID.), data=subjDataB,
                          control=control, REML=FALSE)

flexplot::visualize(mBdSNxQPwQ.Q, plot='model', formula=Annoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxQPwQ.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxQPwQ.Q)

lmtest::lrtest(mBdSNxQPwQ.Q, mBdSNxPwQ.NxPwQ)  # Note the order of inputs has reversed here

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.Q,
                                 mBdSNxPwQ.PwQ, mBdSNxQPwQ.Q)

```

## Personal factors

### AAM attitude

```{r}


mBdSNxPwQAtt.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                               UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                               AAM_attitude2 +
                            (1 + UASEvents | ID.), data=subjDataB,
                            control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAtt.Q, plot='model', formula=Annoyance ~ UASEvents + ID. | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + AAM_attitude2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q)

```

### AAM attitude (alternative grouping)

```{r}


mBdSNxPwQAtt2.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                               UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                               AAM_attitude2_2 +
                            (1 + UASEvents | ID.), data=subjDataB,
                            control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAtt2.Q, plot='model', formula=Annoyance ~ UASEvents + ID. | AAM_attitude2_2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + AAM_attitude2_2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt2.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt2.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQAtt2.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAtt2.Q)

```

### Area of residence

#### no attitude

```{r}

mBdSNxPwQAoR.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                             UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                             Home_Area2 +
                          (1 + UASEvents | ID.), data=subjDataB,
                          control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAoR.Q, plot='model', formula=Annoyance ~ UASEvents + ID. | Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAoR.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAoR.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q)

```
#### with attitude

```{r}
mBdSNxPwQAttAoR.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + Home_Area2 +
                              (1 + UASEvents | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttAoR.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + AAM_attitude2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAttAoR.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q)

```
#### interaction attitude

```{r}


mBdSNxPwQAttxAoR.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2*Home_Area2 +
                              (1 + UASEvents | ID.), data=subjDataB,
                              control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoR.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + AAM_attitude2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAttxAoR.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q)

```
### Area soundscape

```{r}

mBdSNxPwQAttScp.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + Area_soundscape2 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttScp.Q, plot='model', formula=Annoyance ~ UASEvents + Area_soundscape2 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Area_soundscape2, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScp.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScp.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttScp.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q)

```
#### interaction (area of residence)

```{r}

mBdSNxPwQAttScpxAoR.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + Area_soundscape2*Home_Area2 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttScpxAoR.Q, plot='model', formula=Annoyance ~ UASEvents + Area_soundscape2 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttScpxAoR.Q, plot='model', formula=Annoyance ~ UASEvents + Area_soundscape2 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)


flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Area_soundscape2 + Home_Area2, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScpxAoR.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScpxAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttScpxAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q)

```

#### interaction (AAM attitude and area of residence)

```{r}

mBdSNxPwQAttxScpxAoR.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2*Area_soundscape2*Home_Area2 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxScpxAoR.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxScpxAoR.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Home_Area2 + Area_soundscape2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)


flexplot::compare.fits(Annoyance ~ UASEvents | ID. + AAM_attitude2 + Area_soundscape2 + Home_Area2, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxScpxAoR.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxScpxAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxScpxAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q)

```

### National region 

#### with attitude

```{r}

mBdSNxPwQAttNat.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + NationGeo3 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttNat.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q)

```

#### interaction with attitude

```{r}

mBdSNxPwQAttxNat.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2*NationGeo3 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxNat.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q)

```
#### interaction with attitude and area of residence

```{r}

mBdSNxPwQAttxAoRxNat.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*Home_Area2*NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoRxNat.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxAoRxNat.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Home_Area2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoRxNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q, mBdSNxPwQAttxAoRxNat.Q)

```

#### with attitude and area of residence (no interaction)

```{r}

mBdSNxPwQAttAoRNat.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2 + Home_Area2 + NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttAoRNat.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttAoRNat.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Home_Area2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttAoRNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q, mBdSNxPwQAttxAoRxNat.Q,
                                 mBdSNxPwQAttAoRNat.Q)

```


### full interaction

```{r}

mBdSNxPwQAttxAoRxScpxNat.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*Home_Area2*Area_soundscape2*NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoRxScpxNat.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxAoRxScpxNat.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxScpxNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxScpxNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoRxScpxNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q)

```

### all factors, no interaction

```{r}

mBdSNxPwQAttAoRScpNat.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2 + Home_Area2 + Area_soundscape2 + NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttAoRScpNat.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttAoRScpNat.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRScpNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRScpNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttAoRScpNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q,
                                 mBdSNxPwQAttAoRScpNat.Q)

```

### all factors, attitude x national region

```{r}

mBdSNxPwQAttxNatAoRScp.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*NationGeo3 + Home_Area2 + Area_soundscape2 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxNatAoRScp.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxNatAoRScp.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNatAoRScp.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNatAoRScp.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxNatAoRScp.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q,
                                 mBdSNxPwQAttAoRScpNat.Q, mBdSNxPwQAttxNatAoRScp.Q)

```

### all factors, attitude x area of residence

```{r, R.options=list(width=10)}

mBdSNxPwQAttxAoRNatScp.Q <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*Home_Area2 + NationGeo3 + Area_soundscape2 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=control, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoRNatScp.Q, plot='model', formula=Annoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxAoRNatScp.Q, plot='model', formula=Annoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRNatScp.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRNatScp.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoRNatScp.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q,
                                 mBdSNxPwQAttAoRScpNat.Q, mBdSNxPwQAttxNatAoRScp.Q,
                                 mBdSNxPwQAttxAoRNatScp.Q)

```

## Examine best performing models

### model parameters

```{r}
mBdSNxPwQ.Q.params <- parameters::model_parameters(mBdSNxPwQ.Q)
mBdSNxPwQ.Q.params
mBdSNxPwQ.Q.perform <- performance::model_performance(mBdSNxPwQ.Q, estimator='ML')
mBdSNxPwQ.Q.perform

mBdSNxPwQAtt.Q.params <- parameters::model_parameters(mBdSNxPwQAtt.Q)
mBdSNxPwQAtt.Q.params
mBdSNxPwQAtt.Q.perform <- performance::model_performance(mBdSNxPwQAtt.Q, estimator='ML')
mBdSNxPwQAtt.Q.perform

mBdSNxPwQAttAoR.Q.params <- parameters::model_parameters(mBdSNxPwQAttAoR.Q)
mBdSNxPwQAttAoR.Q.params
mBdSNxPwQAttAoR.Q.perform <- performance::model_performance(mBdSNxPwQAttAoR.Q, estimator='ML')
mBdSNxPwQAttAoR.Q.perform

mBdSNxPwQAttxNat.Q.params <- parameters::model_parameters(mBdSNxPwQAttxNat.Q)
mBdSNxPwQAttxNat.Q.params
mBdSNxPwQAttxNat.Q.perform <- performance::model_performance(mBdSNxPwQAttxNat.Q, estimator='ML')
mBdSNxPwQAttxNat.Q.perform

mBdSNxPwQAttxNatAoRScp.Q.params <- parameters::model_parameters(mBdSNxPwQAttxNatAoRScp.Q)
mBdSNxPwQAttxNatAoRScp.Q.params
mBdSNxPwQAttxNatAoRScp.Q.perform <- performance::model_performance(mBdSNxPwQAttxNatAoRScp.Q, estimator='ML')
mBdSNxPwQAttxNatAoRScp.Q.perform

mBdSNxPwQAttxAoRxScpxNat.Q.params <- parameters::model_parameters(mBdSNxPwQAttxAoRxScpxNat.Q)
mBdSNxPwQAttxAoRxScpxNat.Q.params
mBdSNxPwQAttxAoRxScpxNat.Q.perform <- performance::model_performance(mBdSNxPwQAttxAoRxScpxNat.Q, estimator='ML')
mBdSNxPwQAttxAoRxScpxNat.Q.perform

```


# Parts A & B combined analysis

## wrangle data

```{r}

# Add dummy UAS noticed column to Part B data
subjDataB2 <- subjDataB
subjDataB2$UAS_noticed <- 1
subjDataB2 <- subjDataB2 |> dplyr::mutate(TrialNumber=TrialNumber + 80)

# combine dataframes and scale trial number
subjData <- rbind(subjDataA, subjDataB2)
subjData <- subjData |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber))

```

## Fit a baseline model

```{r}
# baseline model (no predictors, only clustered intercept)
mABBL <- lme4::lmer(Annoyance ~ 1 + (1 | ID.), data=subjData,
                    control=control, REML=FALSE)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mABBL)
performance::r2(mABBL)

params <- parameters::model_parameters(mABBL)

```

## Plot baseline model

```{r, fig.width=9, fig.height=5}
# plot the baseline

pred <- ggeffects::predict_response(mABBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

pred <- pred[order(as.numeric(as.character(pred$ID.))), ]
pred$ID. <- factor(pred$ID., levels=paste(sort(as.integer(levels(pred$ID.)))))

df <- data.frame(ID=pred$ID., Annoyance=pred$predicted,
                   AnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   AnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   AnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=AnnoyCILow, ymax=AnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[4]) +
  geom_line(mapping=aes(ID, AnnoyMean), group=1, color=mycolours[4]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[4], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=10),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Mean annoyance rating")

```

## Fit a basic comparison model

```{r}

# basic comparison model

mABLAeq.LAeq <- lme4::lmer(Annoyance ~ LAeqMaxLR +
                                          (1 + LAeqMaxLR | ID.),
                                           data=subjData, control=control, REML=FALSE)

flexplot::visualize(mABLAeq.LAeq, plot='model',
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(Annoyance ~ LAeqMaxLR | ID., data=subjDataB,
                       model1=mABBL, model2=mABLAeq.LAeq, clusters=3, re=T)

flexplot::model.comparison(model1=mABBL, model2=mABLAeq.LAeq)

lmtest::lrtest(mABBL, mABLAeq.LAeq)

performance::compare_performance(mABBL, mABLAeq.LAeq)

```

## Fit combined models

### No personal factors

```{r}

mABdSFSxTNxEnvNxPwQSq.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + UASLoudECMAHMSPowAvgBin +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.FNEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQ.FNEnv <- lme4::lmer(Annoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                        UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                        UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                        UASFluctOV10ExMaxLR +
                                        UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                        (1 + UASLoudECMAHMSPowAvgBin +
                                           UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                         data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.NEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin +
                                             AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.NEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + UASLoudECMAHMSPowAvgBin +
                                             AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABFSxTNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSSxTNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                           AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABSFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + UASSharpAuresISO305ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSTFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR + UASTonalInt05ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR*UASTonalInt05ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAHMSPowAvgBin + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=control, REML=FALSE)

flexplot::visualize(mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, plot='model',
                    formula=Annoyance ~ UASEvents +  ID.,
                    sample=length(levels(subjData$ID.)), alpha=0.1)

flexplot::visualize(mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, plot='model',
                    formula=Annoyance ~ UASLoudECMAHMSPowAvgBin +  ID. | AmbientEnv,
                    sample=length(levels(subjData$ID.)), alpha=0.1)

performance::compare_performance(mABBL, mFSxTNxEnvSq.FNEnvSq, mBdSNxPwQ.Q, mABLAeq.LAeq,
                                 mABdSFSxTNxEnvNxPwQ.FNEnv, mABdSFSxTNxEnvNxPwQSq.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSq.FNEnvSq, mABdSFSxTNxEnvNxPwQSq.NEnvSq,
                                 mABdSFSxTNxEnvNxPwQSq.NEnv, mABdSFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                 mABdSFSxTNxEnvNxPwQSq.FNxPwQEnvSq, mABFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                 mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSNxEnvNxPwQSq.NxPwQEnvSq,
                                 mABSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSTFNxEnvNxPwQSq.FNxPwQEnvSq,
                                 mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq)

```
```{r, fig.width=15, fig.height=12}

perfres <- performance::compare_performance(mABdSFSxTNxEnvNxPwQ.FNEnv, mABdSFSxTNxEnvNxPwQSq.FNEnv,
                                             mABdSFSxTNxEnvNxPwQSq.FNEnvSq, mABdSFSxTNxEnvNxPwQSq.NEnvSq,
                                             mABdSFSxTNxEnvNxPwQSq.NEnv, mABdSFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                             mABdSFSxTNxEnvNxPwQSq.FNxPwQEnvSq, mABFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                             mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSNxEnvNxPwQSq.NxPwQEnvSq,
                                             mABSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSTFNxEnvNxPwQSq.FNxPwQEnvSq,
                                             mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq, rank=T)

checkres <- performance::check_model(mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq)

checkres2 <- performance::check_model(mABdSFNxEnvNxPwQSq.FNxPwQEnvSq)

perfres

plot(perfres)

plot(checkres)

```

### With personal factors

```{r}

mABdSFSxTNxEnvNxPwQSqAttxNat.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2*NationGeo3 +
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAtt.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2 +
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqNat.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      NationGeo3 + 
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAoR.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      Home_Area2 + 
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqScp.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      Area_soundscape2 + 
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2*NationGeo3 + Home_Area2 + Area_soundscape2 +
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAttNatAoRScp.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2 + NationGeo3 + Home_Area2 + Area_soundscape2 +
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)


mABdSFSxTNxEnvNxPwQSqAttNatAoR.FNEnv <- lme4::lmer(Annoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*AmbientEnv +
                                                      UASTonalInt05ExMaxLR*UASSharpAuresISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAHMSPowAvgBin*UASEvents + UASLoudECMAHMSPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2 + NationGeo3 + Home_Area2 +
                                                      (1 + UASLoudECMAHMSPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=control, REML=FALSE)


flexplot::visualize(mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv, plot='model',
                    formula=Annoyance ~ UASLoudECMAHMSPowAvgBin +  ID. | AmbientEnv + AAM_attitude2,
                    sample=length(levels(subjData$ID.)), alpha=0.1)

flexplot::model.comparison(model1=mABdSFSxTNxEnvNxPwQSq.FNEnv, model2=mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv)

performance::compare_performance(mABdSFSxTNxEnvNxPwQSq.FNEnv, mABdSFSxTNxEnvNxPwQSqAtt.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqNat.FNEnv, mABdSFSxTNxEnvNxPwQSqAoR.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqScp.FNEnv, mABdSFSxTNxEnvNxPwQSqAttxNat.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv, mABdSFSxTNxEnvNxPwQSqAttNatAoRScp.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqAttNatAoR.FNEnv)

```