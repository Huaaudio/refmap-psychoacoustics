---
title: "REFMAP listening test 1 analysis: Multi-level linear models for annoyance"
output: html_document
date: "2024-06-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup

Load packages

```{r}
library(conflicted)
library(dplyr)
library(flexplot)
library(lme4)
#library(lmerTest)
library(lmtest)
library(merTools)
library(ggeffects)
library(marginaleffects)
library(stats)
library(ggplot2)
library(openxlsx)
library(easystats)
library(partR2)
#library(rstanarm)
#library(MuMIn)
#library(future)
library(jtools)
# set package parameters
theme_set(theme_bw())

#numCores <- parallel::detectCores()

#future::plan(multisession, workers = numCores-6)

```

Set parameters

```{r}

# plot colour scheme

mycolourlist = list(c(0, 102, 255), c(0, 204, 153), c(255, 0, 102), c(74, 111, 152), c(251, 164, 49), c(204, 153, 255), c(90, 192, 255), c(80, 245, 233), c(255, 90, 192), c(164, 201, 242), c(255, 254, 139), c(255, 243, 255))
mycolours = matrix()

for (ii in 1:length(mycolourlist)){
  mycolours[ii] = rgb(mycolourlist[[ii]][1]/255,
                      mycolourlist[[ii]][2]/255,
                      mycolourlist[[ii]][3]/255)
}

# toggle to save plots
saveplots = TRUE

if (saveplots){
  # set output plot directory
  choose.files(caption="Just cancel this", filters=matrix(data=c(" ", " "), ncol=2))  # workaround for bug in RTerm choose.dir
  outFigPath <- utils::choose.dir(caption="Select output folder to save plots")
  
  if (!dir.exists(file.path(outFigPath, "svg"))){dir.create(file.path(outFigPath, "svg"))}
  if (!dir.exists(file.path(outFigPath, "pdf"))){dir.create(file.path(outFigPath, "pdf"))}
  
}

# toggle to save data
savedata = TRUE

if (savedata){
  # set output plot directory
  if (saveplots==FALSE){
    choose.files(caption="Just cancel this", filters=matrix(data=c(" ", " "), ncol=2))  # workaround for bug in RTerm choose.dir
  }
  outDataPath <- utils::choose.dir(caption="Select output folder to save data")
}

set.seed(3212165)

lmcontrol <- lme4::lmerControl(optimizer = 'bobyqa',
                               optCtrl = list(maxfun = 1e6))
glmcontrol <- lme4::lmerControl(optimizer = 'bobyqa',
                                optCtrl = list(maxfun = 1e6))

```

# Import data and wrangle

## Part A

```{r}

subjDataApath <- utils::choose.files(caption=r"(Select refmap_listest1_testdataA_BySubj.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdataA_BySubj.csv", "refmap_listest1_testdataA_BySubj.csv"), ncol=2))

subjDataA <- read.csv(subjDataApath, header=TRUE)

```

```{r}
# definition of ordinal variable levels
UASLAeqCatsA <- c("No UAS", "42", "48", "54", "60")
SNRCatsA <- c("No UAS", "-16", "-10", "-4", "2", "8")
UASOpCatsA <- c("No UAS", "Flyover", "Landing", "Takeoff")
UASTypeCatsA <- c("No UAS", "H520", "M300", "T150")

# encode factors
subjDataA$ID. <- factor(subjDataA$ID.)
subjDataA$UASLAeq <- factor(subjDataA$UASLAeq, levels=UASLAeqCatsA, order=TRUE)
subjDataA$SNRlevel <- factor(subjDataA$SNRlevel, levels=SNRCatsA, order=TRUE)
subjDataA$UASOperation <- factor(subjDataA$UASOperation, levels=UASOpCatsA)
subjDataA$UASType <- factor(subjDataA$UASType, levels=UASTypeCatsA)
subjDataA$AmbientEnv <- factor(subjDataA$AmbientEnv, levels=c("Street", "Park"))
subjDataA$AAM_attitude <- factor(subjDataA$AAM_attitude)
subjDataA$Home_Area <- factor(subjDataA$Home_Area)
subjDataA$Area_soundscape <- factor(subjDataA$Area_soundscape)
subjDataA$NationGeo <- factor(subjDataA$NationGeo)

# recode AAM_attitude to 3 groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude3 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned") ~ "Ambiv_Concern",
                                                                      "Neutral" ~ "Neutral"))
subjDataA$AAM_attitude3 <- factor(subjDataA$AAM_attitude3)

# recode AAM_attitude to 2 groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude2 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))
subjDataA$AAM_attitude2 <- factor(subjDataA$AAM_attitude2)

# recode AAM_attitude to 2 other groups
subjDataA <- subjDataA |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Support_Ambiv",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Concern_Neutral"))

subjDataA$AAM_attitude2_2 <- factor(subjDataA$AAM_attitude2_2)

# recode NationGeo to 4 groups
subjDataA <- subjDataA |> dplyr::mutate(NationGeo4 = case_match(NationGeo,
                                                               "UK" ~ "UK",
                                                               c("Africa",
                                                                 "SouthAsia") ~ "Africa_SAsia",
                                                               c("Australasia",
                                                                 "EastAsia",
                                                                 "Europe",
                                                                 "MidEast",
                                                                 "SouthAmerica") ~ "Other",
                                                               "" ~ "Unspecified"))
subjDataA$NationGeo4 <- factor(subjDataA$NationGeo4)

# recode NationGeo to 3 groups
subjDataA <- subjDataA |> dplyr::mutate(NationGeo3 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjDataA$NationGeo3 <- factor(subjDataA$NationGeo3)

# recode Area of residence to 2 groups
subjDataA <- subjDataA |> dplyr::mutate(Home_Area2 = case_match(Home_Area,
                                                         "Urban" ~ "Urban",
                                                         c("Suburban",
                                                           "Rural") ~ "Suburban_Rural"))
subjDataA$Home_Area2 <- factor(subjDataA$Home_Area2)


# recode Area soundscape to 2 groups
subjDataA <- subjDataA |> dplyr::mutate(Area_soundscape2 = case_match(Area_soundscape,
                                                                       c("Calm",
                                                                         "Monotonous") ~ "Uneventful",
                                                                       c("Chaotic",
                                                                         "Vibrant") ~ "Eventful"))

subjDataA$Area_soundscape2 <- factor(subjDataA$Area_soundscape2)


# reorder by trial number
subjDataA <- subjDataA[with(subjDataA, order(ID., TrialNumber)), ]

# rescale trial number variable
subjDataA <- subjDataA |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber, scale=FALSE))

# omit ambient-only stimuli
subjDataANoAmb <- subjDataA |> dplyr::filter(UASLAeq != "No UAS")

```


## Part B

```{r}

subjDataBpath <- utils::choose.files(caption=r"(Select refmap_listest1_testdataB_BySubj.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdataB_BySubj.csv", "refmap_listest1_testdataB_BySubj.csv"), ncol=2))

subjDataB <- read.csv(subjDataBpath, header=TRUE)

```

```{r}
# definition of ordinal variable levels
UASLAeqCatsB <- c("No UAS", "54", "60")
SNRCatsB <- c("No UAS", "2", "8")
UASOpCatsB <- c("No UAS", "Flyover")
UASTypeCatsB <- c("No UAS", "H520", "T150")

# encode factors
subjDataB$ID. <- factor(subjDataB$ID.)
subjDataB$UASLAeq <- factor(subjDataB$UASLAeq, levels=UASLAeqCatsB, order=TRUE)
subjDataB$SNRlevel <- factor(subjDataB$SNRlevel, levels=SNRCatsB, order=TRUE)
subjDataB$UASOperation <- factor(subjDataB$UASOperation, levels=UASOpCatsB)
subjDataB$UASType <- factor(subjDataB$UASType, levels=UASTypeCatsB)
subjDataB$AmbientEnv <- factor(subjDataB$AmbientEnv)
subjDataB$AAM_attitude <- factor(subjDataB$AAM_attitude)
subjDataB$Home_Area <- factor(subjDataB$Home_Area)
subjDataB$Area_soundscape <- factor(subjDataB$Area_soundscape)
subjDataB$NationGeo <- factor(subjDataB$NationGeo)

# recode AAM_attitude to 3 groups
subjDataB <- subjDataB |> dplyr::mutate(AAM_attitude3 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned") ~ "Ambiv_Concern",
                                                                      "Neutral" ~ "Neutral"))
subjDataB$AAM_attitude3 <- factor(subjDataB$AAM_attitude3)

# recode AAM_attitude to 2 groups
subjDataB <- subjDataB |> dplyr::mutate(AAM_attitude2 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))
subjDataB$AAM_attitude2 <- factor(subjDataB$AAM_attitude2)

# recode AAM_attitude to 2 other groups
subjDataB <- subjDataB |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Support_Ambiv",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Concern_Neutral"))

subjDataB$AAM_attitude2_2 <- factor(subjDataB$AAM_attitude2_2)

# recode NationGeo to 4 groups
subjDataB <- subjDataB |> dplyr::mutate(NationGeo4 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica") ~ "Other",
                                                                 "" ~ "Unspecified"))
subjDataB$NationGeo4 <- factor(subjDataB$NationGeo4)

# recode NationGeo to 3 groups
subjDataB <- subjDataB |> dplyr::mutate(NationGeo3 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjDataB$NationGeo3 <- factor(subjDataB$NationGeo3)

# recode Area of residence to 2 groups
subjDataB <- subjDataB |> dplyr::mutate(Home_Area2 = case_match(Home_Area,
                                                                 "Urban" ~ "Urban",
                                                                 c("Suburban",
                                                                   "Rural") ~ "Suburban_Rural"))
subjDataB$Home_Area2 <- factor(subjDataB$Home_Area2)


# recode Area soundscape to 2 groups
subjDataB <- subjDataB |> dplyr::mutate(Area_soundscape2 = case_match(Area_soundscape,
                                                                       c("Calm",
                                                                         "Monotonous") ~ "Uneventful",
                                                                       c("Chaotic",
                                                                         "Vibrant") ~ "Eventful"))
subjDataB$Area_soundscape2 <- factor(subjDataB$Area_soundscape2)


# reorder by trial number
subjDataB <- subjDataB[with(subjDataB, order(ID., TrialNumber)), ]

# rescale trial number variable
subjDataB <- subjDataB |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber, scale=FALSE))

# omit ambient-only stimuli
subjDataBNoAmb <- subjDataB |> dplyr::filter(UASLAeq != "No UAS")

```

## Parts A & B combined

```{r}

subjDataPath <- utils::choose.files(caption=r"(Select refmap_listest1_testdata_BySubj.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdata_BySubj.csv", "refmap_listest1_testdata_BySubj.csv"), ncol=2))

subjData <- read.csv(subjDataPath, header=TRUE)

```

```{r}

# encode factors
subjData$ID. <- factor(subjData$ID.)
subjData$UASLAeq <- factor(subjData$UASLAeq, levels=UASLAeqCatsA, order=TRUE)
subjData$SNRlevel <- factor(subjData$SNRlevel, levels=SNRCatsA, order=TRUE)
subjData$UASOperation <- factor(subjData$UASOperation, levels=UASOpCatsA)
subjData$UASType <- factor(subjData$UASType, levels=UASTypeCatsA)
subjData$AmbientEnv <- factor(subjData$AmbientEnv, levels=c("Street", "Park"))
subjData$AAM_attitude <- factor(subjData$AAM_attitude)
subjData$Home_Area <- factor(subjData$Home_Area)
subjData$Area_soundscape <- factor(subjData$Area_soundscape)
subjData$NationGeo <- factor(subjData$NationGeo)

# recode AAM_attitude to 3 groups
subjData <- subjData |> dplyr::mutate(AAM_attitude3 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned") ~ "Ambiv_Concern",
                                                                      "Neutral" ~ "Neutral"))
subjData$AAM_attitude3 <- factor(subjData$AAM_attitude3)

# recode AAM_attitude to 2 groups
subjData <- subjData |> dplyr::mutate(AAM_attitude2 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))
subjData$AAM_attitude2 <- factor(subjData$AAM_attitude2)

# recode AAM_attitude to 2 other groups
subjData <- subjData |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Support_Ambiv",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Concern_Neutral"))

subjData$AAM_attitude2_2 <- factor(subjData$AAM_attitude2_2)

# recode NationGeo to 4 groups
subjData <- subjData |> dplyr::mutate(NationGeo4 = case_match(NationGeo,
                                                               "UK" ~ "UK",
                                                               c("Africa",
                                                                 "SouthAsia") ~ "Africa_SAsia",
                                                               c("Australasia",
                                                                 "EastAsia",
                                                                 "Europe",
                                                                 "MidEast",
                                                                 "SouthAmerica") ~ "Other",
                                                               "" ~ "Unspecified"))
subjData$NationGeo4 <- factor(subjData$NationGeo4)

# recode NationGeo to 3 groups
subjData <- subjData |> dplyr::mutate(NationGeo3 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjData$NationGeo3 <- factor(subjData$NationGeo3)

# recode NationGeo to 2 groups
subjData <- subjData |> dplyr::mutate(NationGeo2 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia",
                                                                   "Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjData$NationGeo2 <- factor(subjData$NationGeo2)


subjData$NationGeo3 <- factor(subjData$NationGeo3)

# recode Area of residence to 2 groups
subjData <- subjData |> dplyr::mutate(Home_Area2 = case_match(Home_Area,
                                                         "Urban" ~ "Urban",
                                                         c("Suburban",
                                                           "Rural") ~ "Suburban_Rural"))
subjData$Home_Area2 <- factor(subjData$Home_Area2)


# recode Area soundscape to 2 groups
subjData <- subjData |> dplyr::mutate(Area_soundscape2 = case_match(Area_soundscape,
                                                                       c("Calm",
                                                                         "Monotonous") ~ "Uneventful",
                                                                       c("Chaotic",
                                                                         "Vibrant") ~ "Eventful"))

subjData$Area_soundscape2 <- factor(subjData$Area_soundscape2)


# reorder by trial number
subjData <- subjData[with(subjData, order(ID., TrialNumber)), ]

# create column with Part B TrialNumbers continuing from Part A
subjData$TrialNumberCnt <- subjData$TrialNumber
subjData$TrialNumberCnt[subjData$SessionPart == "B"] <- subjData$TrialNumberCnt[subjData$SessionPart == "B"] + 
                                                              max(subjData$TrialNumber[subjData$SessionPart=="A"])

# rescale trial number variables separately for each session part
subjData <- rbind(subjData[subjData$SessionPart == "A", ] |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber, scale=TRUE)),
                    subjData[subjData$SessionPart == "B", ] |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber, scale=TRUE)))
subjData <- subjData |> dplyr::mutate(TrialNumberCntScl = datawizard::standardise(TrialNumberCnt, scale=TRUE))

# rescale dB variables
subjData <- subjData |> dplyr::mutate(UASLAeqMaxLRScl = datawizard::standardise(UASLAeqMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(UASLAEMaxLRScl = datawizard::standardise(UASLAEMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(UASEPNLMaxLRScl = datawizard::standardise(UASEPNLMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(Detect0p1IntMaxLRLog = datawizard::standardise(Detect0p1dBIntMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(Detect0p5IntMaxLRLog = datawizard::standardise(Detect0p5dBIntMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(LAELAF50diffScl = datawizard::standardise(LAELAF50diff, scale=FALSE))

# convert detectability dB to log variables
subjData <- subjData |> dplyr::mutate(Detect0p1IntMaxLRLog = Detect0p1dBIntMaxLR/10)
subjData <- subjData |> dplyr::mutate(Detect0p5IntMaxLRLog = Detect0p5dBIntMaxLR/10)

# convert events variables to reciprocal
subjData <- subjData |> dplyr::mutate(UASEventsInv = 1/UASEvents)
subjData <- subjData |> dplyr::mutate(UASEventPerMinInv = 1/UASEventPerMin)


# omit ambient-only stimuli
subjDataNoAmb <- subjData |> dplyr::filter(UASLAeq != "No UAS")

subjDataNoAmb$SNRlevel <- factor(subjDataNoAmb$SNRlevel, levels=SNRCatsA[2:length(SNRCatsA)], order=TRUE)
subjDataNoAmb$UASOperation <- factor(subjDataNoAmb$UASOperation, levels=UASOpCatsA[2: length(UASOpCatsA)])
subjDataNoAmb$UASType <- factor(subjDataNoAmb$UASType, levels=UASTypeCatsA[2:length(UASTypeCatsA)])

```

# Parts A & B combined analysis: change in mean annoyance rating

## Fit a baseline model

```{r}
# baseline model (no predictors, only clustered intercept)
mABBL <- lme4::lmer(dAnnoyance ~ 1 + (1 | ID.), data=subjDataNoAmb,
                    control=lmcontrol, REML=FALSE)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mABBL)
performance::r2(mABBL)

params <- parameters::model_parameters(mABBL)

```

### Plot baseline model

```{r, fig.width=7, fig.height=5}
# plot the baseline

pred <- ggeffects::predict_response(mABBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

pred <- pred[order(as.numeric(as.character(pred$ID.))), ]
pred$ID. <- factor(pred$ID., levels=paste(sort(as.integer(levels(pred$ID.)))))

df <- data.frame(ID=pred$ID., dAnnoyance=pred$predicted,
                   dAnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   dAnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   dAnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=dAnnoyCILow, ymax=dAnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[4]) +
  geom_line(mapping=aes(ID, dAnnoyMean), group=1, color=mycolours[4]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[4], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(-4, 7)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=8),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Mean change in annoyance rating \n(rel. to baseline)")

```

## Fit ambient environment models

```{r, fig.width=8,fig.height=5}

model1 <- mABEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv +
                               (1 | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

model2 <- mABEnv.Env <- lme4::lmer(dAnnoyance ~ AmbientEnv +
                                   (1 + AmbientEnv | ID.), data=subjDataNoAmb,
                                   control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ AmbientEnv | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=5, re=T, alpha=0.2)


flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env)

```

## Fit UAS multiple events model

### Events/min

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventPerMin = UASEventPerMin + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABBL

model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventPerMin + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  scale_x_continuous()

# convert data back for intended model
subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEvents']*60/25
subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEvents']*60/75

model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEventPerMin | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ)

```
```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventPerMin = UASEventPerMin + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABQ

model2 <- mABQ.Q <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                               (1 + UASEventPerMin | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventPerMin + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  scale_x_continuous()

# convert data back for intended model
subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEvents']*60/25
subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEvents']*60/75

model2 <- mABQ.Q <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                               (1 + UASEventPerMin | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEventPerMin | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mABQ.Q)

```


```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventPerMin = UASEventPerMin + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABQ

model2 <- mABEnvQ.EnvQ <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEventPerMin +
                                     (1 + UASEventPerMin + AmbientEnv | ID.), data=subjDataNoAmb,
                                     control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventPerMin + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(0, 10, by=1)) +
  labs(x="UAS events per min", y="Change in annoyance rating\n(rel. to baseline)")

# convert data back for intended model
subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEvents']*60/25
subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEvents']*60/75

model2 <- mABEnvQ.EnvQ <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEventPerMin +
                                     (1 + UASEventPerMin + AmbientEnv | ID.), data=subjDataNoAmb,
                                     control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEventPerMin | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mABQ.Q,
                                 mABEnvQ.EnvQ)

```
### Events total

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABBL

model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEventsRand +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEvents +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ)

```

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABQ

model2 <- mAB1_Q <- lme4::lmer(dAnnoyance ~ UASEventsRand + I(UASEventsRand^-1) +
                               (1 | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mAB1_Q <- lme4::lmer(dAnnoyance ~ UASEvents + I(UASEvents^-1) +
                               (1 | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q)

```   

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mAB1_Q

model2 <- mAB1_Q.Q <- lme4::lmer(dAnnoyance ~ UASEventsRand + I(UASEventsRand^-1) +
                                 (1 + UASEventsRand| ID.), data=subjDataNoAmb,
                                 control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mAB1_Q.Q <- lme4::lmer(dAnnoyance ~ UASEvents + I(UASEvents^-1) +
                                 (1 + UASEvents | ID.), data=subjDataNoAmb,
                                 control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.Q)

```
```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mAB1_Q.Q

model2 <- mABEnv1_Q.EnvQ <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEventsRand + I(UASEventsRand^-1) +
                                      (1 + AmbientEnv + UASEventsRand| ID.), data=subjDataNoAmb,
                                      control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mABEnv1_Q.EnvQ <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEvents + I(UASEvents^-1) +
                                       (1 + AmbientEnv + UASEvents | ID.), data=subjDataNoAmb,
                                       control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.Q, mABEnv1_Q.EnvQ)

```

## Absolute metrics

### Fit LAE models

```{r}

model1 <- mABBL

model2 <- mABLAE <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl +
                              (1 | ID.),
                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE), max(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)), round(max(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)) + 3, by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=3, re=T)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE)

```

```{r}

model1 <- mABLAE

model2 <- mABLAE.LAE <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl +
                                   (1 + UASLAEMaxLRScl | ID.),
                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE), max(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)), round(max(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)) + 3, by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=3, re=T)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE)

```

### Ambient env and LAE mixed model

Fit a model combining ambient environment category and LAE and compare with ambient environment only model

```{r, fig.width=8,fig.height=5}

model1 <- mABEnv.Env

model2 <- mABLAEEnv.LAEEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASLAEMaxLRScl +
                                         (AmbientEnv + UASLAEMaxLRScl | ID.), data=subjDataNoAmb,
                                         control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjData$ID.)), alpha=0.1)  + 
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE), max(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)), round(max(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)) + 3, by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | AmbientEnv + ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv)

```

### Ambient env, LAE and events mixed model

```{r, fig.width=8,fig.height=5}
# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABLAEEnv.LAEEnv

model2 <- mABLAEEnv1_Q.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl + AmbientEnv +
                                             UASEventsRand + I(UASEventsRand^-1) +
                                             (1 + UASLAEMaxLRScl + UASEventsRand + AmbientEnv | ID.), data=subjDataNoAmb,
                                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID. | UASLAEMaxLRScl,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# convert back to intended model
model2 <- mABLAEEnv1_Q.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl + AmbientEnv +
                                             UASEvents + I(UASEvents^-1) +
                                             (1 + UASLAEMaxLRScl + UASEvents + AmbientEnv | ID.), data=subjDataNoAmb,
                                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    formula=dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE), max(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)), round(max(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + UASLAEMaxLRScl, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ)

```

### Ambient env, events and LAE interaction mixed model

This model accounts for the different rates of growth in annoyance between the two environments

```{r, fig.width=8,fig.height=5}

model1 <- mABLAEEnv1_Q.LAEEnvQ

model2 <- mABLAExEnv1_Q.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                              UASEvents + I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + UASEvents + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE), max(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)), round(max(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + UASLAEMaxLRScl,
                       data=subjDataNoAmb, model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ)

```
### LAE interaction with events
```{r, fig.width=8,fig.height=5}
# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABLAExEnv1_Q.LAEEnvQ

model2 <- mAB1_QxLAExEnv.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                              UASLAEMaxLRScl*UASEventsRand + I(UASEventsRand^-1) +
                                               (1 + UASLAEMaxLRScl + UASEventsRand + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID. | UASLAEMaxLRScl,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
              labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")


#refit intended model
model2 <- mAB1_QxLAExEnv.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                              UASLAEMaxLRScl*UASEvents + I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + UASEvents + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE), max(subjDataNoAmb$UASLAEMaxLRScl, na.rm=TRUE) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)), round(max(subjDataNoAmb$UASLAEMaxLR, na.rm=TRUE)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + UASLAEMaxLRScl,
                       data=subjDataNoAmb, model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ)

```

### Trial sequence models

#### Parts A + B standardised trial indexing plot

```{r, 6.4, fig.height=4}

dataFrame <- subjData |> group_by(TrialNumberScl) |> summarise(dAnnoyance = mean(dAnnoyance))

ggplot(data=dataFrame, mapping=aes(TrialNumberScl, dAnnoyance)) + geom_point(color=mycolours[1], alpha=0.3) +
       geom_smooth(formula = y ~ x, method = "lm", alpha=0.3, color=mycolours[1]) +
       theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) + 
       labs(x="Trial number (standardised)", y="Change in annoyance rating\n(rel. to baseline)") + scale_y_continuous(n.breaks=10, limits=c(-4, 7)) +
       scale_x_continuous(breaks=seq(min(subjData$TrialNumberScl), max(subjData$TrialNumberScl) + 1, by=10))

```

#### fixed effect

```{r}

model1 <- mABLAExEnv1_Q.LAEEnvQ

model2 <- mABLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                UASLAEMaxLRScl*AmbientEnv +
                                                UASEvents + I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + UASEvents +
                                                  AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ TrialNumberScl + ID. | AmbientEnv) +
  labs(x="Trial number (standardised)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ TrialNumberScl | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ)

```

NOTE: Although trial sequence could be modelled as a mixed effect, this would allow a random slope for each participant, which would 
explain more of the variation in annoyance, but would be artificially 'stealing' explanatory power from the other candidate predictors.

### EPNL model

```{r}

model1 <- mABLAExEnv1_QSq.LAEEnvQ

model2 <- mABEPNLxEnv1_QSq.EPNLEnvQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                  UASEvents + I(UASEvents^-1) +
                                                  UASEPNLMaxLRScl*AmbientEnv +
                                                  (1 + UASEvents + UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASEPNLMaxLRScl), max(subjDataNoAmb$UASEPNLMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASEPNLMaxLR)), round(max(subjDataNoAmb$UASEPNLMaxLR)) + 3, by=3))

# flexplot::compare.fits(dAnnoyance ~ AmbientEnv | ID. + UASEPNLMaxLRScl, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2) # - different predictors

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2) #- NOT NESTED

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ)

```
### Loudness models

#### Sottek

```{r}

model1 <- mABEPNLxEnv1_QSq.EPNLEnvQ

model2 <- mABNxEnv1_QSq.NEnvQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                            UASEvents + I(UASEvents^-1) +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                          data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Change in annoyance rating\n(rel. to baseline)")

# flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)  # - different predictors

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2) #- NOT NESTED

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ, mABNxEnv1_QSq.NEnvQ)

```
#### ISO 532-3

```{r}

model1 <- mABEPNLxEnv1_QSq.EPNLEnvQ

model2 <- mABN3xEnv1_QSq.NEnvQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                              UASEvents + I(UASEvents^-1) +
                                            UASLoudISO3PowAvgBin*AmbientEnv +
                                            (1 + UASEvents + UASLoudISO3PowAvgBin + AmbientEnv | ID.),
                                            data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudISO3PowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Moore-Glasberg-Schlittenlacher), sone", y="Change in annoyance rating\n(rel. to baseline)")

# flexplot::compare.fits(dAnnoyance ~ UASLoudISO3PowAvgBin | ID. + AmbientEnv, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)  # - different predictors

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2) #- NOT NESTED

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABN3xEnv1_QSq.NEnvQ)

```
### EPNL with mixed interaction

```{r}

model1 <- mABEPNLxEnv1_QSq.EPNLEnvQ

model2 <- mABEPNLxEnv1_QSq.EPNLxEnvQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                    (1 + UASEvents + UASEPNLMaxLRScl*AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASEPNLMaxLRScl), max(subjDataNoAmb$UASEPNLMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASEPNLMaxLR)), round(max(subjDataNoAmb$UASEPNLMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASEPNLMaxLRScl | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ)

```

### Tonal loudness and tonality

#### tonal loudness

```{r}

model1 <- mABLAExEnv1_QSq.LAEEnvQ

model2 <- mABTnLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASTonLdECMAPowAvgBin + TrialNumberScl +
                                                 UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + UASEvents + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ)

```
#### tonality

```{r}

model1 <- mABLAExEnv1_QSq.LAEEnvQ

model2 <- mABTLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                 UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + UASEvents + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASTonalSHMInt05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ)

```

#### tonality (EPNL)

```{r}

model1 <- mABTLAExEnv1_QSq.LAEEnvQ

model2 <- mABTEPNLxEnv1_QSq.EPNLEnvQ <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                    (1 + UASEvents + UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASEPNLMaxLRScl), max(subjDataNoAmb$UASEPNLMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASEPNLMaxLR)), round(max(subjDataNoAmb$UASEPNLMaxLR)) + 3, by=3))

# flexplot::compare.fits(dAnnoyance ~ UASEPNLMaxLRScl | ID. + UASTonalSHMInt05ExMaxLR, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ)

```

#### tonality as mixed

```{r}

model1 <- mABTLAExEnv1_QSq.LAEEnvQ

model2 <- mABTLAExEnv1_QSq.TLAEEnvQ <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + UASEvents + UASTonalSHMInt05ExMaxLR +
                                                     UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASTonalSHMInt05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ)

```

#### with tonality interaction

```{r}

model1 <- mABTLAExEnv1_QSq.LAEEnvQ

model2 <- mABTxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR*UASLAEMaxLRScl +
                                                  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + UASEvents + UASLAEMaxLRScl +
                                                     AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASTonalSHMInt05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ)

```
#### EPNL tonality interaction

```{r}

model1 <- mABTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABTxEPNLxEnv1_QSq.EPNLEnvQ <- lme4::lmer(dAnnoyance ~ UASEPNLMaxLRScl*UASTonalSHMInt05ExMaxLR +
                                                    TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                   UASEPNLMaxLRScl*AmbientEnv +
                                                   (1 + UASEvents +
                                                      UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASEPNLMaxLRScl), max(subjDataNoAmb$UASEPNLMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASEPNLMaxLR)), round(max(subjDataNoAmb$UASEPNLMaxLR)) + 3, by=3))
# 
# flexplot::compare.fits(dAnnoyance ~ UASEPNLMaxLRScl | ID. + UASTonalSHMInt05ExMaxLR, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ)

```
#### with tonality and env interaction

```{r}

model1 <- mABTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABLAExTxEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                    UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR*AmbientEnv +
                                                    (1 + UASEvents + UASLAEMaxLRScl +
                                                       AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASTonalSHMInt05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ)

```

### Sharpness

#### sharpness (Aures | Moore-Glasberg)

```{r}

model1 <- mABTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABSTxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR +
                                                 UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                 UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                 (1 + UASEvents +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASSharpAurISO305ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ)

```

#### sharpness interacting with tonality

```{r}

model1 <- mABSTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABSxTxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + UASEvents +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASSharpAurISO305ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ)

```

#### sharpness (Aures | Sottek)

```{r}

model1 <- mABSTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmTxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR +
                                                   UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                 (1 + UASEvents +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASSharpAurSHM05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ)

```

#### sharpness (Aures | Sottek) interaction with tonality

```{r}

model1 <- mABShmTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                 (1 + UASEvents +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASSharpAurSHM05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ)

```

#### sharpness and tonal loudness instead of tonality

```{r}

model1 <- mABShmxTxLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*UASTonLdECMAPowAvgBin + 
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
# 
# flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASTonLdECMAPowAvgBin, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ)

```

#### sharpness, tonal loudness, LAE and env interaction

```{r}

model1 <- mABShmxTnxLAExEnv1_QSq.LAEEnvQ

model2 <- mABLAExEnvxShmxTn1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin*UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ)

```

#### sharpness and tonal loudness interaction

```{r}

model1 <- mABShmxTnxLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                      UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ)

```

### Fluctuation strength

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABFShmxTnLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASFluctOV10ExMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASFluctOV10ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ)

```

### Roughness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABRShmxTnLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASRoughFZ05ExMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASRoughFZ05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ)

```

### Impulsiveness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABIShmxTnLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASImpulsSHMAvgMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + UASImpulsSHMAvgMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ)

```

### Substitute EPNL for LAE

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ <- lme4::lmer(dAnnoyance ~  UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASEPNLMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + UASEvents +
                                                          UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASEPNLMaxLRScl), max(subjDataNoAmb$UASEPNLMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASEPNLMaxLR)), round(max(subjDataNoAmb$UASEPNLMaxLR)) + 3, by=3))

flexplot::model.comparison(model1=model1, model2=model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ)

```
### Curvilinear LAE

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnLAE2xEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                       I(UASLAEMaxLRScl^2) +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnvQ)

```

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTn1_LAE2xEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                       I(UASLAEMaxLRScl^2) + I(UASLAEMaxLRScl^-1) +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnvQ,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnvQ)

```

### Comparison with categorical models

#### type and op as fixed

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABTypeOpLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASType + UASOperation +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::model.comparison(model1=model1, model2=model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnvQ,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnvQ,
                                 mABTypeOpLAExEnv1_QSq.LAEEnvQ)



```
#### type and op interactions (similar to ANOVA)

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABTypexOpxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                        UASLAEMaxLRScl*UASOperation +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        UASType:AmbientEnv +
                                                        UASLAEMaxLRScl*UASType +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::model.comparison(model1=model1, model2=model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnvQ,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnvQ,
                                 mABTypeOpLAExEnv1_QSq.LAEEnvQ,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnvQ)

parameters::model_parameters(mABTypexOpxLAExEnv1_QSq.LAEEnvQ)

```

#### reduced interactions

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSq.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::model.comparison(model1=model1, model2=model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABEnv1_Q.EnvQ, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnvQ, mABLAExEnv1_Q.LAEEnvQ,
                                 mAB1_QxLAExEnv.LAEEnvQ, mABLAExEnv1_QSq.LAEEnvQ,
                                 mABEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABNxEnv1_QSq.NEnvQ, mABEPNLxEnv1_QSq.EPNLxEnvQ,
                                 mABTnLAExEnv1_QSq.LAEEnvQ, mABTLAExEnv1_QSq.LAEEnvQ,
                                 mABTEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABTLAExEnv1_QSq.TLAEEnvQ, mABTxLAExEnv1_QSq.LAEEnvQ,
                                 mABTxEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABLAExTxEnv1_QSq.LAEEnvQ, mABSTxLAExEnv1_QSq.LAEEnvQ,
                                 mABSxTxLAExEnv1_QSq.LAEEnvQ, mABShmTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTxLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnxLAExEnv1_QSq.LAEEnvQ,
                                 mABLAExEnvxShmxTn1_QSq.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnvQ,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnvQ,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnvQ,
                                 mABTypeOpLAExEnv1_QSq.LAEEnvQ,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSq.LAEEnvQ)

```


## Difference metrics

### UASLAE - AmbLAF50

```{r}

model1 <- mAB1_Q.Q

model2 <- mABdLAELAF501_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl +
                                           TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + UASEvents | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + TrialNumberScl, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q)


```
#### with dTonal loudness

```{r}

model1 <- mABdLAELAF501_QSq.dLAELAF50Q

model2 <- mABdTndLAELAF501_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl +
                                                         dTonLdECMAPowAvgBin +
                                           TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + UASEvents | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q)


```
#### with dTonal loudness interaction

```{r}

model1 <- mABdTndLAELAF501_QSq.dLAELAF50Q

model2 <- mABdTnxdLAELAF501_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl*dTonLdECMAPowAvgBin +
                                                         TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         (1 + LAELAF50diffScl + UASEvents | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q)


```

#### with curvilinear LAEdiff

```{r}

model1 <- mABdTnxdLAELAF501_QSq.dLAELAF50Q

model2 <- mABdTnxdLAELAF5021_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl*dTonLdECMAPowAvgBin +
                                                           I(LAELAF50diffScl^2) +
                                                         TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         (1 + LAELAF50diffScl + UASEvents | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q)


```

### Detectability

0.1 s averaging

#### mixed

```{r}

model1 <- mABdTnxdLAELAF501_QSq.dLAELAF50Q

model2 <-  mABDt1i1_QSq.Dt1iQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             (1 + Detect0p1IntMaxLRLog + UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + TrialNumberScl, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ)

```
#### 0.5 s averaging

```{r}

model1 <- mABDt1i1_QSq.Dt1iQ

model2 <-  mABDt5i1_QSq.Dt5iQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p5IntMaxLRLog +
                                             (1 + Detect0p5IntMaxLRLog + UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + TrialNumberScl, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ)

```

#### curvilinear mixed effect

```{r}

model1 <- mABDt1i1_QSq.Dt1iQ

model2 <-  mABDt1i21_QSq.Dt1iQ <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + TrialNumberScl, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ)

```
#### difference in sharpness

##### sharpness

```{r}

model1 <- mABDt1i21_QSq.Dt1iQ

model2 <-  mABdSDt1i21_QSq.Dt1iQ <- lme4::lmer(dAnnoyance ~ dSharpAurSHMPowAvgMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, #plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dSharpAurSHMPowAvgMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ)

```

##### sharpness interaction with detectability

```{r}

model1 <- mABdSDt1i21_QSq.Dt1iQ

model2 <-  mABdSxDt1i21_QSq.Dt1iQ <- lme4::lmer(dAnnoyance ~ dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, #plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dSharpAurSHMPowAvgMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ)

```

##### mixed, no interaction

```{r}

model1 <- mABdSDt1i21_QSq.Dt1iQ

model2 <-  mABdSDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dSharpAurSHMPowAvgMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, #plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ)

parameters::model_parameters(mABdSDt1i21_QSq.dSDt1iQ)

```

##### fixed interaction with detectability

```{r}

model1 <- mABdSDt1i21_QSq.dSDt1iQ

model2 <-  mABdSxDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ 
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog + dSharpAurSHMPowAvgMaxLR +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ)

parameters::model_parameters(mABdSxDt1i21_QSq.dSDt1iQ)

```

##### mixed interaction with detectability

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdSxDt1i21_QSq.dSxDt1i1Q <- lme4::lmer(dAnnoyance ~ 
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSxDt1i1Q)

```


#### difference in fluctuation strength

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdFdSxDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dFluctSHM10ExBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dFluctSHM10ExBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ)

```

#### difference in roughness

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdRdSxDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dRoughFZ05ExMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dRoughFZ05ExMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ)

```

#### difference in impulsiveness

##### fixed

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdIdSxDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dImpulsSHMAvgMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ)

```

##### mixed

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdIdSxDt1i21_QSq.dIdSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                                dImpulsSHMAvgMaxLR +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ)

```

##### interaction with detectability

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdSxDt1i2xdI1_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ 
                                                    dImpulsSHMAvgMaxLR*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ)

```

#### difference in tonal loudness

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdTndIdSxDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ)

```
##### interaction with detectability

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ)

```

##### mixed

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdTndIdSxDt1i21_QSq.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dTonLdECMAPowAvgBin + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dTndSDt1iQ)

```

##### interaction with sharpness difference

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <-  mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + dTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ)

```

### LAELAF50diff with all other factors from best absolute model, omitting AmbientEnv

```{r}

model1 <- mABdLAELAF501_QSq.dLAELAF50Q

model2 <- mABShmxTnxdLAELAF501_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     LAELAF50diffScl*UASTonLdECMAPowAvgBin +
                                           TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + UASEvents | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + UASSharpAurSHM05ExMaxLR + UASTonLdECMAPowAvgBin, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q)


```

### LAELAF50diff with other factors from best detectability model

```{r}

model1 <- mABdLAELAF501_QSq.dLAELAF50Q

model2 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                   dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin + 
                                                     LAELAF50diffScl +
                                                   (1 + dSharpAurSHMPowAvgMaxLR + LAELAF50diffScl +
                                                    UASEvents | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + dTonLdECMAPowAvgBin + dSharpAurSHMPowAvgMaxLR + dImpulsSHMAvgMaxLR, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q)


```

### Swap impulsiveness difference from best detectability model for tonal loudness difference

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1iQ

model2 <- mABdTndSxDt1i21_QSq.dSDt1iQ <- lme4::lmer(dAnnoyance ~ dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

   
# flexplot::compare.fits(dAnnoyance ~ LAELAF50diffScl | ID. + dTonLdECMAPowAvgBin + dSharpAurSHMPowAvgMaxLR + dImpulsSHMAvgMaxLR, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTndLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF50Q,
                                 mABDt1i1_QSq.Dt1iQ, mABDt5i1_QSq.Dt5iQ,
                                 mABDt1i21_QSq.Dt1iQ, mABdSDt1i21_QSq.Dt1iQ,
                                 mABdSxDt1i21_QSq.Dt1iQ,
                                 mABdSDt1i21_QSq.dSDt1iQ,
                                 mABdSxDt1i21_QSq.dSDt1iQ,
                                 mABdFdSxDt1i21_QSq.dSDt1iQ,
                                 mABdRdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdSxDt1i21_QSq.dIdSDt1iQ,
                                 mABdSxDt1i2xdI1_QSq.dSDt1iQ,
                                 mABdTndIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABdTndSxDt1i21_QSq.dSDt1iQ)


```

## LAE model without ambient env

### initial

```{r}

model1 <- mABShmxTnxLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnxLAE1_QSq.LAEQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*UASTonLdECMAPowAvgBin + 
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ)

```

### mixed tonal loudness

```{r}

model1 <- mABShmxTnxLAE1_QSq.LAEQ

model2 <- mABShmxTnxLAE1_QSq.LAETnQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*UASTonLdECMAPowAvgBin + 
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + UASTonLdECMAPowAvgBin | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABShmxTnxLAE1_QSq.LAETnQ)

```

### mixed sharpness

```{r}

model1 <- mABShmxTnxLAE1_QSq.LAEQ

model2 <- mABShmxTnxLAE1_QSq.LAEShmQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*UASTonLdECMAPowAvgBin + 
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + UASEvents +
                                                        UASLAEMaxLRScl + UASSharpAurSHM05ExMaxLR | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABShmxTnxLAE1_QSq.LAETnQ,
                                 mABShmxTnxLAE1_QSq.LAEShmQ)

```

## Personal factors

### Categorical model

#### Attitude

```{r}

model1 <- mABTypeOpxLAExEnv1_QSq.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          AAM_attitude2 + 
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + AAM_attitude2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ)

```

#### National region

```{r}

model1 <- mABTypeOpxLAExEnv1_QSq.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2 + 
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + NationGeo2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ)

```
#### National region and AAM attitude interaction

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2*AAM_attitude2 + 
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + AAM_attitude2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnvQ)

```
#### Home area of residence

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2 + Home_Area2 + 
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + Home_Area2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnvQ)

```

#### Home area of residence interaction with national region

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2*Home_Area2 + 
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + Home_Area2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnvQ)

```

#### Home area soundscape character

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ

model2 <- mABTypeOpxLAExEnv1_QSqNatScp.LAEEnvQ <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2 + Area_soundscape +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + Area_soundscape, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABdIdSxDt1i21_QSq.dSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABShmxTnxdLAELAF501_QSq.dLAELAF50Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF50Q,
                                 mABShmxTnxLAE1_QSq.LAEQ,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNatScp.LAEEnvQ)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqNatScp.LAEEnvQ)

```

### Absolute model

#### AAM attitude

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         AAM_attitude2 +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + AAM_attitude2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ)

parameters::model_parameters(mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ)

```

#### National region

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnvQ

model2 <- mABShmxTnLAExEnv1_QSqNat.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         NationGeo2 +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + NationGeo2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ)

parameters::model_parameters(mABShmxTnLAExEnv1_QSqNat.LAEEnvQ)

```

#### Home area of residence

```{r}

model1 <- mABShmxTnLAExEnv1_QSqNat.LAEEnvQ

model2 <- mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         NationGeo2 + Home_Area2 +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + Home_Area2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ)

parameters::model_parameters(mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ)

```

#### Home area soundscape character

```{r}

model1 <- mABShmxTnLAExEnv1_QSqNat.LAEEnvQ

model2 <- mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         NationGeo2 + Area_soundscape +
                                                       (1 + UASEvents +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(round(min(subjDataNoAmb$UASLAEMaxLR)), round(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID. + Area_soundscape, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ)

parameters::model_parameters(mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ)

```

### Detectability model

#### AAM attitude

```{r}

model1 <- mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ

model2 <- mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               Detect0p1IntMaxLRLog +
                                               AAM_attitude2 +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | AAM_attitude2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + AAM_attitude2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ)

parameters::model_parameters(mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ)

```

#### National region

```{r}

model1 <- mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ

model2 <- mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               Detect0p1IntMaxLRLog +
                                               NationGeo2 +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | NationGeo2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + NationGeo2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ)

parameters::model_parameters(model2)

```

#### Home area of residence

```{r}

model1 <- mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ

model2 <- mABdTnxdSdIDt1i21_QSqNatAoR.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               Detect0p1IntMaxLRLog +
                                               NationGeo2 + Home_Area2 +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | Home_Area2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + Home_Area2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatAoR.dTndSDt1iQ)

parameters::model_parameters(model2)

```

#### Home area of residence interaction with national region

```{r}

model1 <- mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ

model2 <- mABdTnxdSdIDt1i21_QSqNatxAoR.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               Detect0p1IntMaxLRLog +
                                               NationGeo2*Home_Area2 +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | Home_Area2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + Home_Area2, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatxAoR.dTndSDt1iQ)

parameters::model_parameters(model2)

```

#### Area soundscape character

```{r}

model1 <- mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ

model2 <- mABdTnxdSdIDt1i21_QSqNatScp.dTndSDt1iQ <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               Detect0p1IntMaxLRLog +
                                               NationGeo2 + Area_soundscape +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHMPowAvgMaxLR + Detect0p1IntMaxLRLog +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | Area_soundscape) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + Area_soundscape, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatxAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatScp.dTndSDt1iQ)

parameters::model_parameters(model2)

```

### Replace detectability with LAELAF50diff

```{r}

model1 <- mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ

model2 <- mABdTnxdSdIdLAELAF501_QSqNat.dTndSdLAELAF50Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               LAELAF50diffScl +
                                               NationGeo2 +
                                             (1 + dSharpAurSHMPowAvgMaxLR + LAELAF50diffScl +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))
  
# flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + Area_soundscape, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatxAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatScp.dTndSDt1iQ,
                                 mABdTnxdSdIdLAELAF501_QSqNat.dTndSdLAELAF50Q)

parameters::model_parameters(model2)

```

### Curvilinear LAELAF50diff

```{r}

model1 <- mABdTnxdSdIdLAELAF501_QSqNat.dTndSdLAELAF50Q

model2 <- mABdTnxdSdIdLAELAF5021_QSqNat.dTndSdLAELAF50Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHMPowAvgMaxLR*dTonLdECMAPowAvgBin +
                                               LAELAF50diffScl + I(LAELAF50diffScl^2) +
                                               NationGeo2 +
                                             (1 + dSharpAurSHMPowAvgMaxLR + LAELAF50diffScl +
                                              UASEvents | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$LAELAF50diffScl), max(subjDataNoAmb$LAELAF50diffScl) + 3, by=3),
                     labels=seq(round(min(subjDataNoAmb$LAELAF50diff)), round(max(subjDataNoAmb$LAELAF50diff)) + 3, by=3))
  
# flexplot::compare.fits(dAnnoyance ~ Detect0p1IntMaxLRLog | ID. + Area_soundscape, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnvQ,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnvQ,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnvQ,
                                 mABdTnxdSdIDt1i21_QSq.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqAtt.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNat.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatxAoR.dTndSDt1iQ,
                                 mABdTnxdSdIDt1i21_QSqNatScp.dTndSDt1iQ,
                                 mABdTnxdSdIdLAELAF501_QSqNat.dTndSdLAELAF50Q,
                                 mABdTnxdSdIdLAELAF5021_QSqNat.dTndSdLAELAF50Q)

parameters::model_parameters(model2)

```

# Parts A & B combined analysis: Highly annoyed probability

## Fit LAE logistic model

```{r}

mABHLAE <- lme4::glmer(dHiAnnoy ~ UASLAEMaxLRScl + (1 | ID.),
                       data=subjDataNoAmb, family=binomial, control=glmcontrol)

```

# Part A analysis


## Fit a baseline model

```{r}

# baseline model (no predictors, only clustered intercept)
mBL <- lme4::lmer(dAnnoyance ~ 1 + (1 | ID.), data=subjDataANoAmb,
                        control=lmcontrol, REML=FALSE)

#mBL_stn <- rstanarm::stan_glmer(dAnnoyance ~ 1 + (1 | ID.), data=subjDataA, cores=12, iter=4000, seed=2134)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mBL)
performance::r2(mBL)

#performance::icc(mBL_stn)
#performance::r2(mBL_stn)

params <- parameters::model_parameters(mBL)
```


```{r, fig.width=7, fig.height=4}
# plot the baseline

pred <- ggeffects::predict_response(mBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

df <- data.frame(ID=pred$ID., dAnnoyance=pred$predicted,
                   dAnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   dAnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   dAnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=dAnnoyCILow, ymax=dAnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[1]) +
  geom_line(mapping=aes(ID, dAnnoyMean), group=1, color=mycolours[1]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[1], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(-4, 6)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=8),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Change in annoyance rating\n(rel. to baseline)")

```

## Basic comparison models

```{r}

subjDataANoAmb <- subjDataANoAmb |> dplyr::mutate(UASLAeqMaxLRScl = datawizard::standardise(UASLAeqMaxLR, scale=FALSE))

mLq <- lme4::lmer(dAnnoyance ~ UASLAeqMaxLRScl + (1 | ID.), data=subjDataANoAmb,
                         control=lmcontrol, REML=FALSE, na.action=na.omit)

# visualize the model using flexplot, with x-axis tick labels adjusted to the values in subjDataA$LAeqMaxLR
flexplot::visualize(mLq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1) + 
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 2, by=2),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 2, by=2)) + 
  labs(x="UAS LAeq, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAeqMaxLRScl | ID., data=subjDataA,
                       model1=mBL, model2=mLq, clusters=5, re=T, alpha=0.2) + 
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 1, max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), by=4),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 1, round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), by=4))

flexplot::model.comparison(model1=mBL, model2=mLq)

performance::compare_performance(mBL, mLq)

```


```{r}

mLq.Lq <- lme4::lmer(dAnnoyance ~ UASLAeqMaxLRScl + (1 + UASLAeqMaxLRScl | ID.), data=subjDataANoAmb,
                         control=lmcontrol, REML=FALSE, na.action=na.omit)

flexplot::visualize(mLq.Lq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1) + 
    scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 2, by=2),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 2, by=2)) +
  labs(x="UAS LAeq, dB", y="Change in annoyance rating\n(rel. to baseline)")


flexplot::compare.fits(dAnnoyance ~ UASLAeqMaxLRScl | ID., data=subjDataA,
                       model1=mLq, model2=mLq.Lq, clusters=5, re=T, alpha=0.2) + 
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 1, max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), by=4),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 1, round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), by=4))

flexplot::model.comparison(model1=mLq, model2=mLq.Lq)

lmtest::lrtest(mLq, mLq.Lq)

performance::compare_performance(mBL, mLq, mLq.Lq)

```

## Ambient environment model

Now fit a model which includes ambient environment category as (i) fixed effect and (ii) mixed effect predictor, and compare with the baseline

```{r, fig.width=8,fig.height=5}
mEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv +
                   (1 | ID.), data=subjDataANoAmb,
                   control=lmcontrol, REML=FALSE)
mEnv.Env <- lme4::lmer(dAnnoyance ~ AmbientEnv +
                       (1 + AmbientEnv | ID.), data=subjDataANoAmb,
                       control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ AmbientEnv | ID., data=subjDataANoAmb,
                       model1=mBL, model2=mEnv, clusters=5, re=T, alpha=0.2)

flexplot::compare.fits(dAnnoyance ~ AmbientEnv | ID., data=subjDataANoAmb,
                       model1=mBL, model2=mEnv.Env, clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=mEnv, model2=mEnv.Env)

lmtest::lrtest(mEnv, mEnv.Env)

performance::compare_performance(mBL, mLq, mLq.Lq, mEnv, mEnv.Env)

```

Lastly, fit a model combining ambient environment category and LAeq and compare with ambient environment only model

```{r, fig.width=8,fig.height=5}
mLqEnv.LqEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASLAeqMaxLRScl +
                          (AmbientEnv + UASLAeqMaxLRScl | ID.), data=subjDataANoAmb,
                          control=lmcontrol, REML=FALSE)

flexplot::visualize(mLqEnv.LqEnv, plot='model', formula = dAnnoyance ~ UASLAeqMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataA$ID.)), alpha=0.1)  + 
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 2, by=2),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 2, by=2)) +
  labs(x="UAS LAeq, dB", y="Change in annoyance rating\n(rel. to baseline)")


flexplot::compare.fits(dAnnoyance ~ UASLAeqMaxLRScl | AmbientEnv + ID., data=subjDataA,
                       model1=mLq.Lq, model2=mLqEnv.LqEnv, clusters=5, re=T, alpha=0.2) + 
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 1, max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), by=4),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 1, round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), by=4))


flexplot::model.comparison(model1=mEnv.Env, model2=mLqEnv.LqEnv)

performance::compare_performance(mBL, mLq, mLq.Lq, mEnv, mEnv.Env,
                                 mLqEnv.LqEnv)

```

## Loudness (fixed) + amb env model
```{r}

mNEnv.Env <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin + AmbientEnv +
                        (1 + AmbientEnv | ID.),
                        data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mEnv.Env, model2=mNEnv.Env, clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=mEnv.Env, model2=mNEnv.Env)

lmtest::lrtest(mEnv.Env, mNEnv.Env)

performance::compare_performance(mBL, mLq, mLq.Lq, mEnv, mEnv.Env,
                                 mLqEnv.LqEnv, mNEnv.Env)
```
## Loudness (mixed) + amb env model

```{r}

mNEnv.NEnv <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin + AmbientEnv +
                         (1 + AmbientEnv + UASLoudECMAPowAvgBin | ID.),
                         data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mNEnv.Env, model2=mNEnv.NEnv, clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=mNEnv.Env, model2=mNEnv.NEnv)

lmtest::lrtest(mNEnv.Env, mNEnv.NEnv)

performance::compare_performance(mBL, mLq, mLq.Lq, mEnv, mEnv.Env,
                                 mLqEnv.LqEnv, mNEnv.Env, mNEnv.NEnv)

```

## Loudness + amb env with fixed interaction model

```{r}

mNxEnv.NEnv <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*AmbientEnv +
                          (1 +  UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                          data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mNxEnv.NEnv, plot='model', sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1) +
  labs(x="UAS loudness (Sottek ECMA), sone", y="Change in annoyance rating\n(rel. to baseline)")


flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mNEnv.NEnv, model2=mNxEnv.NEnv, re=T, alpha=0.2)

flexplot::model.comparison(model1=mNEnv.NEnv, model2=mNxEnv.NEnv)

lmtest::lrtest(mNEnv.NEnv, mNxEnv.NEnv)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv)


```
```{r}

mLqxEnv.LqEnv <- lme4::lmer(dAnnoyance ~ UASLAeqMaxLRScl*AmbientEnv +
                          (1 +  UASLAeqMaxLRScl + AmbientEnv | ID.),
                          data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mLqxEnv.LqEnv, plot='model', sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1) +
  labs(x="UAS LAeq, dB", y="Change in annoyance rating\n(rel. to baseline)") + 
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 4, by=2),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 4, by=2))

flexplot::compare.fits(dAnnoyance ~ UASLAeqMaxLRScl | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mLqEnv.LqEnv, model2=mLqxEnv.LqEnv, re=T, alpha=0.2)

flexplot::model.comparison(model1=mLqEnv.LqEnv, model2=mLqxEnv.LqEnv)

lmtest::lrtest(mLqEnv.LqEnv, mLqxEnv.LqEnv)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv)


```

```{r}

tempcontrol <- lme4::lmerControl(optimizer = 'nmkbw',
                                 optCtrl = list(maxfun=4e30, maxfeval=4e30, maxit = 4e30))


mLqxEnv.LqxEnv <- lme4::lmer(dAnnoyance ~ UASLAeqMaxLRScl*AmbientEnv +
                          (1 +  UASLAeqMaxLRScl*AmbientEnv | ID.),
                          data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mLqxEnv.LqxEnv, plot='model', sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(min(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE), max(subjDataA$UASLAeqMaxLRScl, na.rm=TRUE) + 2, by=2),
                     labels=seq(round(min(subjDataA$UASLAeqMaxLR, na.rm=TRUE)), round(max(subjDataA$UASLAeqMaxLR, na.rm=TRUE)) + 2, by=2)) +
  labs(x="UAS LAeq, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAeqMaxLRScl | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mLqxEnv.LqEnv, model2=mLqxEnv.LqxEnv, re=T, alpha=0.2)

flexplot::model.comparison(model1=mLqxEnv.LqEnv, model2=mLqxEnv.LqxEnv)

lmtest::lrtest(mLqxEnv.LqEnv, mLqxEnv.LqEnv)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv, mLqxEnv.LqxEnv)


```

## Loudness + amb env with mixed interaction model

```{r}

mNxEnv.NxEnv <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*AmbientEnv +
                           (1 + UASLoudECMAPowAvgBin*AmbientEnv | ID.),
                           data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mNxEnv.NxEnv, plot='model', sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1) +
  labs(x="UAS loudness (Sottek ECMA), sone", y="Change in annoyance rating\n(rel. to baseline)")


flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mNxEnv.NEnv, model2=mNxEnv.NxEnv, re=T, alpha=0.2)

flexplot::model.comparison(model1=mNxEnv.NEnv, model2=mNxEnv.NxEnv)

lmtest::lrtest(mNxEnv.NEnv, mNxEnv.NxEnv)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv)

```

## Loudness poly (2) + amb env with linear interaction model

```{r}

mN2xEnv.NEnv <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*AmbientEnv +
                           I(UASLoudECMAPowAvgBin^2) +
                           (1 +  UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                           data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mN2xEnv.NEnv, plot='model', sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1) +
  labs(x="UAS loudness (Sottek ECMA), sone", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mNxEnv.NEnv, model2=mN2xEnv.NEnv, re=T, alpha=0.2)

flexplot::model.comparison(model1=mNxEnv.NEnv, model2=mN2xEnv.NEnv)

lmtest::lrtest(mNxEnv.NEnv, mN2xEnv.NEnv)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv)


```

## Trial sequence

```{r, 6.4, fig.height=4}

df <- subjDataA |> group_by(TrialNumber) |> summarise(dAnnoyance = mean(dAnnoyance))

ggplot(data=df, mapping=aes(TrialNumber, dAnnoyance)) + geom_point(color=mycolours[1], alpha=0.5) +
       geom_smooth(formula = y ~ x, method = "lm", alpha=0.3) +
       theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) + 
       labs(x="Trial number", y="Change in annoyance rating\n(rel. to baseline)") + scale_y_continuous(n.breaks=10, limits=c(-4, 7))

```


### fixed effect

```{r}

mNxEnvSq.NEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                            UASLoudECMAPowAvgBin*AmbientEnv +
                            (1 +  UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                            data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mNxEnvSq.NEnv, plot='model',
                    sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ TrialNumberScl + ID. | AmbientEnv) +
  scale_x_continuous(breaks=seq(min(subjDataA$TrialNumberScl), max(subjDataA$TrialNumberScl), by=10),
                     labels=seq(round(min(subjDataA$TrialNumber)), round(max(subjDataA$TrialNumber)), by=10)) +
  labs(x="Trial number", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ TrialNumberScl | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mNxEnv.NEnv, model2=mNxEnvSq.NEnv, re=T)

flexplot::model.comparison(model1=mNxEnv.NEnv, model2=mNxEnvSq.NEnv)

lmtest::lrtest(mNxEnv.NEnv, mNxEnvSq.NEnv)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv)


```
### mixed effect

```{r}

# mixed model with SHM loudness, ambient env and trial sequence as mixed effects, and loudness*ambient as fixed effects

mNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                              UASLoudECMAPowAvgBin*AmbientEnv +
                              (1 + TrialNumberScl + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                              data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ TrialNumberScl + ID. | AmbientEnv) +
  scale_x_continuous(breaks=seq(min(subjDataA$TrialNumberScl), max(subjDataA$TrialNumberScl), by=10),
                     labels=seq(round(min(subjDataA$TrialNumber)), round(max(subjDataA$TrialNumber)), by=10)) +
  labs(x="Trial number", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ TrialNumberScl | ID. + AmbientEnv, data=subjDataANoAmb,
                       model1=mNxEnv.NEnv, model2=mNxEnvSq.NEnvSq, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnv, model2=mNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq)

```
### show plot of model predictions with CIs and mean data points

```{r}

df <- subjDataA |> dplyr::group_by(TrialNumberScl, AmbientEnv) |> dplyr::summarise(dAnnoyance = mean(dAnnoyance), UASLoudECMAPowAvgBin = mean(UASLoudECMAPowAvgBin), .groups = 'keep')

pred <- ggeffects::predict_response(mNxEnvSq.NEnvSq, terms=c("TrialNumberScl [all]", "AmbientEnv"), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "TrialNumberScl"
colnames(pred)[which(names(pred) == "group")] <- "AmbientEnv"

ggplot(pred, aes(color=AmbientEnv)) +
  geom_ribbon(mapping=aes(TrialNumberScl, ymin=conf.low, ymax=conf.high, fill=AmbientEnv),
                          alpha=0.1, colour = NA) +
  geom_line(mapping=aes(TrialNumberScl, predicted)) +
  geom_point(data=df, mapping=aes(x=TrialNumberScl, y=dAnnoyance, colour = AmbientEnv, shape=AmbientEnv), alpha=0.5) +
  facet_wrap(vars(AmbientEnv)) +
  scale_x_continuous(breaks=seq(min(subjDataA$TrialNumberScl), max(subjDataA$TrialNumberScl) +1, by=10),
                     labels=seq(round(min(subjDataA$TrialNumber)), round(max(subjDataA$TrialNumber)) +1, by=10)) +
  scale_y_continuous(n.breaks=10, limits=c(-4, 7)) +
  theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) +
labs(x="Trial number", y="Mean change in annoyance", colour = "Amb. env.", fill = "Amb. env.", shape = "Amb. env.") + 
scale_color_manual(values = c("Street" = mycolours[1], "Park" = mycolours[2])) + 
  scale_fill_manual(values = c("Street" = mycolours[1], "Park" = mycolours[2]))


```

```{r, fig.width=5, fig.height=4}

df <- subjDataA |> dplyr::group_by(TrialNumberScl) |> dplyr::summarise(dAnnoyance = mean(dAnnoyance), UASLoudECMAPowAvgBin = mean(UASLoudECMAPowAvgBin), .groups = 'keep')

pred <- ggeffects::predict_response(mNxEnvSq.NEnvSq, terms=c("TrialNumberScl [all]"), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "TrialNumberScl"

ggplot(pred) +
  geom_ribbon(mapping=aes(TrialNumberScl, ymin=conf.low, ymax=conf.high, group=1),
                          alpha=0.1, colour = NA, fill=mycolours[3]) +
  geom_line(mapping=aes(TrialNumberScl, predicted), color=mycolours[3]) +
  geom_point(data=df, mapping=aes(x=TrialNumberScl, y=dAnnoyance, group=1), color=mycolours[3], alpha=0.5) +
  scale_x_continuous(breaks=seq(min(subjDataA$TrialNumberScl), max(subjDataA$TrialNumberScl) +1, by=10),
                     labels=seq(round(min(subjDataA$TrialNumber)), round(max(subjDataA$TrialNumber)) +1, by=10)) +
  scale_y_continuous(n.breaks=10, limits=c(-4, 7)) +
  theme(text = element_text(family = "serif", size=12), axis.text = element_text(size=12), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) +
labs(x="Trial number", y="Mean change in annoyance")


```


## Sound quality models

### Tonality

#### independent

```{r}

mTNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                 UASLoudECMAPowAvgBin*AmbientEnv +
                                 UASTonalSHMInt05ExMaxLR +
                                 (1 + TrialNumberScl + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                 data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mTNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek ECMA), sone", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASTonalSHMInt05ExMaxLR + AmbientEnv + ID., data=subjDataANoAmb,
                       model1=mNxEnvSq.NEnvSq, model2=mTNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnvSq, model2=mTNxEnvSq.NEnvSq)

lmtest::lrtest(mNxEnvSq.NEnvSq, mTNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mTNxEnvSq.NEnvSq)

```

#### independent (tonal loudness)

```{r}

mTnNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonLdECMAPowAvgBin +
                                  (1 + TrialNumberScl + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                  data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mTnNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek ECMA), sone", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASTonLdECMAPowAvgBin + AmbientEnv + ID., data=subjDataANoAmb,
                       model1=mNxEnvSq.NEnvSq, model2=mTnNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnvSq, model2=mTnNxEnvSq.NEnvSq)

lmtest::lrtest(mNxEnvSq.NEnvSq, mTnNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mTNxEnvSq.NEnvSq, mTnNxEnvSq.NEnvSq)

```

#### random effect

```{r}

# mixed model

mTNxEnvSq.TNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                 UASLoudECMAPowAvgBin*AmbientEnv +
                                 UASTonalSHMInt05ExMaxLR +
                                 (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASTonalSHMInt05ExMaxLR + 
                                    AmbientEnv | ID.),
                                 data=subjDataANoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(mTNxEnvSq.TNEnvSq, plot='model',
                    sample=length(levels(subjDataANoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek ECMA), sone", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASTonalSHMInt05ExMaxLR + AmbientEnv + ID., data=subjDataANoAmb,
                       model1=mTNxEnvSq.NEnvSq, model2=mTNxEnvSq.TNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mTNxEnvSq.NEnvSq, model2=mTNxEnvSq.TNEnvSq)

lmtest::lrtest(mTNxEnvSq.NEnvSq, mTNxEnvSq.TNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv, mLqxEnv.LqEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mTNxEnvSq.NEnvSq, mTnNxEnvSq.NEnvSq,
                                 mTNxEnvSq.TNEnvSq)

```

### Sharpness

#### independent (fixed)

```{r}

# mixed model with SHM loudness, ambient env  and trial sequence as mixed effects, and sharpness and loudness*ambient as fixed effects
mSNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                               UASLoudECMAPowAvgBin*AmbientEnv +
                               UASSharpAurISO305ExMaxLR +
                               (1 + TrialNumberScl + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                               data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mSNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)


flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASSharpAurISO305ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mNxEnvSq.NEnvSq, model2=mSNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnvSq, model2=mSNxEnvSq.NEnvSq)

lmtest::lrtest(mNxEnvSq.NEnvSq, mSNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq)

```
#### random effect

```{r}

# mixed model with SHM loudness, ambient env  and trial sequence as mixed effects, and sharpness and loudness*ambient as fixed effects
mSNxEnvSq.SNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                               UASLoudECMAPowAvgBin*AmbientEnv +
                               UASSharpAurISO305ExMaxLR +
                               (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                  UASSharpAurISO305ExMaxLR + AmbientEnv | ID.),
                               data=subjDataA, control=lmcontrol,
                               REML=FALSE)

flexplot::visualize(mSNxEnvSq.SNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASSharpAurISO305ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSNxEnvSq.NEnvSq, model2=mSNxEnvSq.SNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSNxEnvSq.NEnvSq, model2=mSNxEnvSq.SNEnvSq)

lmtest::lrtest(mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq)

```


#### interaction with loudness

```{r}

# mixed model with SHM loudness, ambient env and trial sequence as mixed effects, and sharpness, sharpness*loudness and loudness*ambient as fixed effects
mSxNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                UASLoudECMAPowAvgBin*UASSharpAurISO305ExMaxLR +
                                UASLoudECMAPowAvgBin*AmbientEnv +
                                (1 + TrialNumber + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mSxNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASSharpAurISO305ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mNxEnvSq.NEnvSq, model2=mSxNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mNxEnvSq.NEnvSq, model2=mSxNxEnvSq.NEnvSq)

lmtest::lrtest(mNxEnvSq.NEnvSq, mSxNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq)

```
#### interaction (sharpness with tonality)

```{r}

# mixed model

mSxTNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                 UASLoudECMAPowAvgBin*AmbientEnv +
                                 UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                 (1 + TrialNumber + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                 data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mSxTNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASTonalSHMInt05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mSxTNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mSxTNxEnvSq.NEnvSq)

lmtest::lrtest(mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq)

```
#### interaction (sharpness with tonal loudness)

```{r}

# mixed model

mSxTnNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonLdECMAPowAvgBin*UASSharpAurISO305ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mSxTnNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASTonLdECMAPowAvgBin + AmbientEnv + ID., data=subjDataA,
                       model1=mSxNxEnvSq.NEnvSq, model2=mSxTnNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxNxEnvSq.NEnvSq, model2=mSxTnNxEnvSq.NEnvSq)

lmtest::lrtest(mSxNxEnvSq.NEnvSq, mSxTnNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq)

```


### Fluctuation strength

#### independent (fixed)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSq.NEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.NEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.NEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.NEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq)

```

#### random effect

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with ambient)

```{r}

# mixed model with SHM loudness, ambient env and trial sequence as mixed effects, and sharpness, tonality, fluctuation strength, fluctuation*ambient and loudness*sharpness*ambient as fixed effects
mFxEnvSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                      UASFluctOV10ExMaxLR*AmbientEnv +
                                      (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                      data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFxEnvSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxEnvSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxEnvSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxEnvSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with loudness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxNSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASLoudECMAPowAvgBin +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFxNSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxNSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxNSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxNSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq)

```
#### interaction (fluctuation with sharpness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxSSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFxSSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxSSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxSSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxSSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq)

```
#### interaction (fluctuation with tonality)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxTSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFxTSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxTSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxTSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxTSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with roughness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxRSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASRoughFZ05ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFxRSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxRSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxRSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxRSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq)

```

#### interaction (fluctuation with impulsiveness)

```{r}

# mixed model
# fixed effects:
# random effects:
mFxISxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR*UASImpulsSHMAvgMaxLR +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                    data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFxISxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASFluctOV10ExMaxLR + UASImpulsSHMAvgMaxLR + ID., data=subjDataA,
                       model1=mSxTNxEnvSq.NEnvSq, model2=mFxISxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mSxTNxEnvSq.NEnvSq, model2=mFxISxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mSxTNxEnvSq.NEnvSq, mFxISxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq)

```


### Roughness

#### independent (fixed)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mRFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq)

```

#### random effect

```{r}

# mixed model
# fixed effects: 
# random effects: 

# optimx_options <- c("L-BFGS-B", "nlminb", "nlm", "bobyqa", "nmkb", "hjkb")
# for(i in 1:length(optimx_options)){
#   print(paste0("Testing optimx: ", optimx_options[i]))
#   mRFSxTNxEnvSq.RFNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
#                                   UASLoudECMAPowAvgBin*AmbientEnv +
#                                   UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
#                                   UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                   (1 + TrialNumber + UASLoudECMAPowAvgBin +
#                                      UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                      AmbientEnv | ID.),
#                                   data=subjDataA, control=lme4::lmerControl(optimizer = "optimx",
#                                            optCtrl = list(method = optimx_options[i],
#                                                                    maxit = 1e9)),
#                                   REML=F)
#   if(is.null(mRFSxTNxEnvSq.RFNEnvSq@optinfo$conv$lme4$messages)){
#     print(paste0("One of the optimx options, ", optimx_options[i],", worked!"))
#     print(mRFSxTNxEnvSq.RFNEnvSq)
#     break
#   }
# }
# 
# 
# algoptions <- c("NLOPT_LN_PRAXIS", "NLOPT_GN_CRS2_LM",
# "NLOPT_LN_COBYLA", "NLOPT_LN_NEWUOA",
# "NLOPT_LN_NEWUOA_BOUND", "NLOPT_LN_NELDERMEAD",
# "NLOPT_LN_SBPLX", "NLOPT_LN_BOBYQA")
# 
# for(i in 1:length(algoptions)){
#   print(paste0("Testing nloptwrap: ", algoptions[i]))
#   mRFSxTNxEnvSq.RFNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
#                                   UASLoudECMAPowAvgBin*AmbientEnv +
#                                   UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
#                                   UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                   (1 + TrialNumber + UASLoudECMAPowAvgBin +
#                                      UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
#                                      AmbientEnv | ID.),
#                                   data=subjDataA, 
#                      control = lme4::lmerControl(optimizer = "nloptwrap",
#                                            optCtrl = list(algorithm = algoptions[i],
#                                                           maxfun = 1e9,
#                                                           maxeval = 1e7,
#                                                           xtol_abs = 1e-9,
#                                                           ftol_abs = 1e-9)), REML=F)
#   if(is.null(mRFSxTNxEnvSq.RFNEnvSq@optinfo$conv$lme4$messages)){
#     print(paste0("One of the nloptwrap options, ", algoptions[i],", worked!"))
#     print(mRFSxTNxEnvSq.RFNEnvSq)
#     break
#   }
# }

```

```{r}

# fails to converge using any optimiser
tempcontrol <- lme4::lmerControl(optimizer = 'nmkbw',
                                 optCtrl = list(maxfun=4e6, maxfeval=4e6, maxit = 4e6))

mRFSxTNxEnvSq.RFNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                     AmbientEnv | ID.),
                                  data=subjDataA, control=tempcontrol,
                                  REML=FALSE)

flexplot::visualize(mRFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.RFNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRFSxTNxEnvSq.RFNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.RFNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRFSxTNxEnvSq.RFNEnvSq)

# since it failed to converge, the results are not carried forwards in the analysis

```

#### interaction (roughness with loudness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASLoudECMAPowAvgBin +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mRxNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq)

```

#### interaction (roughness with tonality)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxTFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mRxTFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxTFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxTFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq)

```

#### interaction (roughness with sharpness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxSFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin + 
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mRxSFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxSFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxSFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxSFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq)

```
#### interaction (roughness with ambient)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxEnvFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin + 
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mRxEnvFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxEnvFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxEnvFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq)

```
#### interaction (roughness with impulsiveness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mRxIFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASRoughFZ05ExMaxLR*UASImpulsSHMAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mRxIFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASRoughFZ05ExMaxLR + UASImpulsSHMAvgMaxLR + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxIFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mRxIFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mRxIFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq)

```



### Impulsiveness

#### independent (fixed)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASImpulsSHMAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASImpulsSHMAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq)

```
#### random effect

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIFSxTNxEnvSq.IFNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASImpulsSHMAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASImpulsSHMAvgMaxLR + UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIFSxTNxEnvSq.IFNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASImpulsSHMAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.IFNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIFSxTNxEnvSq.IFNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.IFNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq)

```
#### interaction (impulsiveness with loudness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                     UASLoudECMAPowAvgBin*AmbientEnv +
                                     UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                     UASFluctOV10ExMaxLR +
                                     UASImpulsSHMAvgMaxLR*UASLoudECMAPowAvgBin +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIxNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASImpulsSHMAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq)

```

#### interaction (impulsiveness with ambient)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxEnvFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                       UASLoudECMAPowAvgBin*AmbientEnv +
                                       UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                       UASFluctOV10ExMaxLR +
                                       UASImpulsSHMAvgMaxLR*AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIxEnvFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASImpulsSHMAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxEnvFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxEnvFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq)

```
#### interaction (impulsiveness with sharpness)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxSFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                       UASLoudECMAPowAvgBin*AmbientEnv +
                                       UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                       UASFluctOV10ExMaxLR +
                                       UASImpulsSHMAvgMaxLR*UASSharpAurISO305ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIxSFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASImpulsSHMAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxSFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxSFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxSFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq,
                                 mIxSFSxTNxEnvSq.FNEnvSq)

```
#### interaction (impulsiveness with tonality)

```{r}

# mixed model
# fixed effects: 
# random effects: 
mIxTFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                       UASLoudECMAPowAvgBin*AmbientEnv +
                                       UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                       UASFluctOV10ExMaxLR +
                                       UASImpulsSHMAvgMaxLR*UASTonalSHMInt05ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                  data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIxTFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASImpulsSHMAvgMaxLR + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxTFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIxTFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIxTFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mBL, mLq.Lq, mEnv, mEnv.Env, mNEnv.Env,
                                 mNEnv.NEnv, mNxEnv.NEnv,
                                 mNxEnv.NxEnv, mN2xEnv.NEnv,
                                 mNxEnvSq.NEnv, mNxEnvSq.NEnvSq,
                                 mSNxEnvSq.NEnvSq, mSNxEnvSq.SNEnvSq,
                                 mSxNxEnvSq.NEnvSq, mSxTNxEnvSq.NEnvSq,
                                 mSxTnNxEnvSq.NEnvSq, mTSxNxEnvSq.NEnvSq,
                                 mTnSxNxEnvSq.NEnvSq, mTSxNxEnvSq.TNEnvSq,
                                 mFSxTNxEnvSq.NEnvSq, mFSxTNxEnvSq.FNEnvSq,
                                 mFxEnvSxTNxEnvSq.FNEnvSq,
                                 mFxNSxTNxEnvSq.FNEnvSq, mFxSSxTNxEnvSq.FNEnvSq,
                                 mFxTSxTNxEnvSq.FNEnvSq, mFxRSxTNxEnvSq.FNEnvSq,
                                 mFxISxTNxEnvSq.FNEnvSq, mRFSxTNxEnvSq.FNEnvSq,
                                 mRxNFSxTNxEnvSq.FNEnvSq, mRxTFSxTNxEnvSq.FNEnvSq,
                                 mRxSFSxTNxEnvSq.FNEnvSq, mRxEnvFSxTNxEnvSq.FNEnvSq,
                                 mRxIFSxTNxEnvSq.FNEnvSq, mIFSxTNxEnvSq.FNEnvSq,
                                 mIFSxTNxEnvSq.IFNEnvSq,
                                 mIxNFSxTNxEnvSq.FNEnvSq, mIxEnvFSxTNxEnvSq.FNEnvSq,
                                 mIxSFSxTNxEnvSq.FNEnvSq, mIxTFSxTNxEnvSq.FNEnvSq)

```
## Test if adding UAS type or operation adds further explanatory power

### UAS type

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqType.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASType +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqType.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv + UASType)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASType + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqType.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqType.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq)

```
### UAS type interaction with env

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqTypexEnv.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASType + UASType:AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqType.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv + UASType)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASType + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypexEnv.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypexEnv.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqTypexEnv.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq)

```

### UAS operation

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqOp.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASOperation +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                    UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqOp.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv + UASOperation)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASOperation + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOp.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOp.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq)

```

### UAS operation interaction with env

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqOpxEnv.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASOperation + UASOperation:AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                    UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqOpxEnv.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv + UASOperation)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASOperation + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOpxEnv.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqOpxEnv.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqOpxEnv.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq,
                                 mFSxTNxEnvSqOpxEnv.FNEnvSq)

```

### UAS type x operation interaction

```{r}

# mixed model
# fixed effects: 
# random effects: 
mFSxTNxEnvSqTypeOp.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    UASType*UASOperation + 
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqTypeOp.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv + UASType)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | UASOperation + UASType + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypeOp.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqTypeOp.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqTypeOp.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqType.FNEnvSq,
                                 mFSxTNxEnvSqTypexEnv.FNEnvSq, mFSxTNxEnvSqOp.FNEnvSq,
                                 mFSxTNxEnvSqOpxEnv.FNEnvSq, mFSxTNxEnvSqTypeOp.FNEnvSq)

```
## Test if adding difference variables adds further explanatory power

### PNLM-LAeq

```{r}

# mixed model
# fixed effects: 
# random effects:

# remove No UAS scenarios
df <- subjDataA[complete.cases(subjDataA),]
df$PNLMLAeqdiff <- as.numeric(df$PNLMLAeqdiff)

# refit main model
mFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=df, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)


mPNLdLAeqFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                    PNLMLAeqdiff +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=df, control=lmcontrol, REML=FALSE)

flexplot::visualize(mPNLdLAeqFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | PNLMLAeqdiff + ID., data=df,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPNLdLAeqFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPNLdLAeqFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mPNLdLAeqFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPNLdLAeqFSxTNxEnvSq.FNEnvSq)

# refit main model with full data
mFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                  UASLoudECMAPowAvgBin*AmbientEnv +
                                  UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                  UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

```
### Partial loudness

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      PartLoudGMSTPowAvg +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mPtNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ PartLoudGMSTPowAvg + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | PartLoudGMSTPowAvg + AmbientEnv + ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mPtNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNFSxTNxEnvSq.FNEnvSq)

```

### Does partial loudness explain the variation better than loudness with ambient?

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNFSxTSq.PtNFSq <- lme4::lmer(dAnnoyance ~ TrialNumber + PartLoudGMSTPowAvg +
                                UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                 UASFluctOV10ExMaxLR +
                                  (1 + TrialNumber + PartLoudGMSTPowAvg + UASFluctOV10ExMaxLR | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mPtNFSxTSq.PtNFSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ PartLoudGMSTPowAvg + ID.)

flexplot::compare.fits(dAnnoyance ~ PartLoudGMSTPowAvg | ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTSq.PtNFSq, clusters=5, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNFSxTSq.PtNFSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNFSxTSq.PtNFSq)

```
Or with ambient?

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNEnvSq.PtNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber + PartLoudGMSTPowAvg +
                                  AmbientEnv +
                                  (1 + TrialNumber + PartLoudGMSTPowAvg + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mPtNEnvSq.PtNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ PartLoudGMSTPowAvg + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ PartLoudGMSTPowAvg | ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNEnvSq.PtNEnvSq, clusters=5, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNEnvSq.PtNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNEnvSq.PtNEnvSq)

```

```{r}

# mixed model
# fixed effects: 
# random effects:

mPtNxEnvFSxTEnvSq.PtNxEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber + PartLoudGMSTPowAvg*AmbientEnv +
                                           UASFluctOV10ExMaxLR +
                                    UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                  (1 + TrialNumber + PartLoudGMSTPowAvg*AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mPtNxEnvFSxTEnvSq.PtNxEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ PartLoudGMSTPowAvg + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ PartLoudGMSTPowAvg | ID., data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNxEnvFSxTEnvSq.PtNxEnvSq, clusters=5, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPtNxEnvFSxTEnvSq.PtNxEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPtNxEnvFSxTEnvSq.PtNxEnvSq)

```


### Impulsiveness difference

```{r}

# mixed model
# fixed effects: 
# random effects:

mdIFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      dImpulsSHMAvgMaxLR +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mdIFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv + dImpulsSHMAvgMaxLR, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mdIFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mdIFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mdIFSxTNxEnvSq.FNEnvSq)

```
## Test if adding intermittency ratio adds further explanatory power

```{r}

# mixed model
# fixed effects: 
# random effects:

mIRFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR + IntermitRatioMaxLR +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                     data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mIRFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv + IntermitRatioMaxLR, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mIRFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mIRFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mIRFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mIRFSxTNxEnvSq.FNEnvSq)

```
## Test if raising loudness to exponent adds further explanatory power

```{r}

# mixed model
# fixed effects: 
# random effects:

mPwNFSxTNxEnvSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber + I(UASLoudECMAPowAvgBin^2) +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                    (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                       UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                     data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mPwNFSxTNxEnvSq.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mPwNFSxTNxEnvSq.FNEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mPwNFSxTNxEnvSq.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mPwNFSxTNxEnvSq.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mPwNFSxTNxEnvSq.FNEnvSq)

```

## Test if adding random effect for loudness x env interaction adds further explanatory power

```{r}

# mixed model
# fixed effects: 
# random effects:

mNFSxTNxEnvSq.FNxEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                    (1 + TrialNumber +
                                       UASLoudECMAPowAvgBin*AmbientEnv +
                                       UASFluctOV10ExMaxLR | ID.),
                                     data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mNFSxTNxEnvSq.FNxEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mNFSxTNxEnvSq.FNxEnvSq, clusters=2, re=T)

flexplot::model.comparison(model1=mFSxTNxEnvSq.FNEnvSq, model2=mNFSxTNxEnvSq.FNxEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mNFSxTNxEnvSq.FNxEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mNFSxTNxEnvSq.FNxEnvSq)

```

## Personal factors

### AAM attitude

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAtt.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAtt.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + AAM_attitude2 | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | AAM_attitude2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqAtt.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq)

```
### AAM attitude (alternative groupings)

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAtt2.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2_2 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAtt2.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + AAM_attitude2_2 | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | AAM_attitude2_2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqAtt2.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt2.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt2.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAtt2.FNEnvSq)

```

### AAM attitude interaction with env

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxEnv.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 + AAM_attitude2:AmbientEnv +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxEnv.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + AAM_attitude2 | AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | AAM_attitude2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSq.FNEnvSq, model2=mFSxTNxEnvSqAttxEnv.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAttxEnv.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAttxEnv.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq)

```

### Area of residence

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttAoR.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 + Home_Area2 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttAoR.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + Home_Area2 | AAM_attitude2 + AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | Home_Area2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttAoR.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq)

```

### Area of residence interaction with attitude

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxAoR.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*Home_Area2 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxAoR.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + Home_Area2 | AAM_attitude2 + AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | Home_Area2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttxAoR.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxAoR.FNEnvSq)

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxAoR.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq)

```

### National region


```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttNat.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2 + NationGeo3 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

#data = subjDataA |> group_by(AmbientEnv, UASLoudECMAPowAvgBin, AAM_attitude2, NationGeo3) |> summarise(Annoyance = mean(Annoyance))

flexplot::visualize(mFSxTNxEnvSqAttNat.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + NationGeo3 | AmbientEnv + AAM_attitude2) +
          xlab(bquote("UAS loudness, sones"[SHM])) + labs(color = "Region of nationality", shape = "Region of nationality", linetype = "Region of nationality") +
          scale_y_continuous(n.breaks=10) + scale_x_continuous(n.breaks=6) +
          theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 0, maxColorValue = 255)))
          
          #geom_point(data=data, aes(x=UASLoudECMAPowAvgBin, y=Annoyance, shape=NationGeo3))

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | NationGeo3 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttNat.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq)

```

### National region interaction with AAM attitude

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxNat.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*NationGeo3 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

#data = subjDataA |> group_by(AmbientEnv, UASLoudECMAPowAvgBin, AAM_attitude2, NationGeo3) |> summarise(Annoyance = mean(Annoyance))

flexplot::visualize(mFSxTNxEnvSqAttxNat.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + NationGeo3 | AmbientEnv + AAM_attitude2) +
          xlab(bquote("UAS loudness, sones"[SHM])) + labs(color = "Region of nationality", shape = "Region of nationality", linetype = "Region of nationality") +
          scale_y_continuous(n.breaks=10) + scale_x_continuous(n.breaks=6) +
          theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 0, maxColorValue = 255)))
          
          #geom_point(data=data, aes(x=UASLoudECMAPowAvgBin, y=Annoyance, shape=NationGeo3))

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | NationGeo3 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAtt.FNEnvSq, model2=mFSxTNxEnvSqAttxNat.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxNat.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAtt.FNEnvSq, mFSxTNxEnvSqAttxNat.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq,
                                 mFSxTNxEnvSqAttxNat.FNEnvSq)

```

### PANAS negative

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxNatPAn.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*NationGeo3 +
                                      PANAS_negative +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxNatPAn.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | PANAS_negative + AAM_attitude2)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | PANAS_negative + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAttxNat.FNEnvSq, model2=mFSxTNxEnvSqAttxNatPAn.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq,
                                 mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq)

```

### Area soundscape

```{r}

# mixed model
# fixed effects: 
# random effects:

mFSxTNxEnvSqAttxNatScp.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumber +
                                    UASLoudECMAPowAvgBin*AmbientEnv +
                                    UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                    UASFluctOV10ExMaxLR +
                                      AAM_attitude2*NationGeo3 +
                                      Area_soundscape2 +
                                  (1 + TrialNumber + UASLoudECMAPowAvgBin +
                                     UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                   data=subjDataA, control=lmcontrol, REML=FALSE)

flexplot::visualize(mFSxTNxEnvSqAttxNatScp.FNEnvSq, plot='model',
                    sample=length(levels(subjDataA$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | Area_soundscape2 + AmbientEnv)

flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | Area_soundscape2 + AmbientEnv, data=subjDataA,
                       model1=mFSxTNxEnvSqAttxNat.FNEnvSq, model2=mFSxTNxEnvSqAttxNatScp.FNEnvSq)

flexplot::model.comparison(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatScp.FNEnvSq)        

lmtest::lrtest(mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatScp.FNEnvSq)

performance::compare_performance(mFSxTNxEnvSq.FNEnvSq, mFSxTNxEnvSqAtt.FNEnvSq,
                                 mFSxTNxEnvSqAttxEnv.FNEnvSq, mFSxTNxEnvSqAttAoR.FNEnvSq,
                                 mFSxTNxEnvSqAttxAoR.FNEnvSq, mFSxTNxEnvSqAttNat.FNEnvSq,
                                 mFSxTNxEnvSqAttxNat.FNEnvSq, mFSxTNxEnvSqAttxNatPAn.FNEnvSq,
                                 mFSxTNxEnvSqAttxNatScp.FNEnvSq)

```

## Examine best performing models

### model parameters

```{r}
mFSxTNxEnvSq.FNEnvSq.params <- parameters::model_parameters(mFSxTNxEnvSq.FNEnvSq)
mFSxTNxEnvSq.FNEnvSq.params
mFSxTNxEnvSq.FNEnvSq.perform <- performance::model_performance(mFSxTNxEnvSq.FNEnvSq, estimator='ML')
mFSxTNxEnvSq.FNEnvSq.perform

mFSxTNxEnvSqAttxNat.FNEnvSq.params <- parameters::model_parameters(mFSxTNxEnvSqAttxNat.FNEnvSq)
mFSxTNxEnvSqAttxNat.FNEnvSq.params
mFSxTNxEnvSqAttxNat.FNEnvSq.perform <- performance::model_performance(mFSxTNxEnvSqAttxNat.FNEnvSq, estimator='ML')
mFSxTNxEnvSqAttxNat.FNEnvSq.perform

```

# Part B analysis

## Fit a baseline model

```{r}
# baseline model (no predictors, only clustered intercept)
mBBL <- lme4::lmer(dAnnoyance ~ 1 + (1 | ID.), data=subjDataB,
                  control=lmcontrol, REML=FALSE)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mBBL)
performance::r2(mBBL)

params <- parameters::model_parameters(mBBL)

```

```{r, fig.width=9, fig.height=5}
# plot the baseline

pred <- ggeffects::predict_response(mBBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

df <- data.frame(ID=pred$ID., Annoyance=pred$predicted,
                   AnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   AnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   AnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=AnnoyCILow, ymax=AnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[1]) +
  geom_line(mapping=aes(ID, AnnoyMean), group=1, color=mycolours[1]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[1], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=10),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Mean annoyance rating")

```

## Basic comparison model

```{r}

mBLq.Lq <- lme4::lmer(dAnnoyance ~ LAeqMaxLR + (1 + LAeqMaxLR | ID.), data=subjDataB,
                         control=lmcontrol, REML=FALSE)

flexplot::visualize(mBLq.Lq, plot='model',
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ LAeqMaxLR | ID., data=subjDataB,
                       model1=mBBL, model2=mBLq.Lq, clusters=5, re=T)

flexplot::model.comparison(model1=mBBL, model2=mBLq.Lq)

lmtest::lrtest(mBBL, mBLq.Lq)

performance::compare_performance(mBBL, mBLq.Lq)

```
```{r}

mBLAeq <- lme4::lmer(dAnnoyance ~ LAeqMaxLR + (1 | ID.), data=subjDataB,
                         control=lmcontrol, REML=FALSE)

flexplot::visualize(mBLAeq, plot='model',
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ LAeqMaxLR | ID., data=subjDataB,
                       model1=mBLq.Lq, model2=mBLAeq, clusters=5, re=T)

flexplot::model.comparison(model1=mBLq.Lq, model2=mBLAeq)

lmtest::lrtest(mBLAeq, mBLq.Lq)  # note order of inputs is reversed

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq)

```


## Event quantity model

```{r, fig.width=10,fig.height=5}
mBQ <- lme4::lmer(dAnnoyance ~ UASEvents +
                   (1 | ID.), data=subjDataB,
                   control=lmcontrol, REML=FALSE)

mBQ.Q <- lme4::lmer(dAnnoyance ~ UASEvents +
                     (1 + UASEvents | ID.), data=subjDataB,
                     control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBBL, model2=mBQ, clusters=5, re=T)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBBL, model2=mBQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBQ, model2=mBQ.Q)

MuMIn::AICc(mBQ, mBQ.Q)

lmtest::lrtest(mBQ, mBQ.Q)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q)

```
#### power transformation of events

```{r}

mBPwQ.Q <- lme4::lmer(dAnnoyance ~ UASEvents + I(UASEvents^0.17) +
                     (1 + UASEvents | ID.), data=subjDataB,
                     control=lmcontrol, REML=FALSE)

flexplot::visualize(mBPwQ.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBQ.Q, model2=mBPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBQ.Q, model2=mBPwQ.Q)

lmtest::lrtest(mBQ.Q, mBPwQ.Q)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q)

```
##Loudness
### Loudness with events^pwr

```{r}

mBNPwQ.Q <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin +
                         UASEvents + I(UASEvents^0.17) +
                       (1 + UASEvents | ID.), data=subjDataB,
                       control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNPwQ.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASLoudECMAPowAvgBin + ID., data=subjDataB,
                       model1=mBPwQ.Q, model2=mBNPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBPwQ.Q, model2=mBNPwQ.Q)

lmtest::lrtest(mBPwQ.Q, mBNPwQ.Q)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q)

```
### Loudness as mixed with events^pwr

```{r}

mBNPwQ.NQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin +
                         UASEvents + I(UASEvents^0.17) +
                        (1 + UASLoudECMAPowAvgBin + UASEvents | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNPwQ.NQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASLoudECMAPowAvgBin + ID., data=subjDataB,
                       model1=mBNPwQ.Q, model2=mBNPwQ.NQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNPwQ.Q, model2=mBNPwQ.NQ)

lmtest::lrtest(mBNPwQ.Q, mBNPwQ.NQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ)

```

### Loudness*events + events^pwr

```{r}

mBNxQPwQ.Q <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + I(UASEvents^0.17) +
                        (1 + UASEvents | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxQPwQ.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNPwQ.Q, model2=mBNxQPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBNPwQ.Q, model2=mBNxQPwQ.Q)

lmtest::lrtest(mBNPwQ.Q, mBNxQPwQ.Q)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q)

```

### Loudness*events^pwr

```{r}

mBNxPwQ.Q <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASEvents | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQ.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNPwQ.Q, model2=mBNxPwQ.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBNPwQ.Q, model2=mBNxPwQ.Q)

lmtest::lrtest(mBNPwQ.Q, mBNxPwQ.Q)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q)

```
### Loudness*events^pwr as mixed

```{r}

mBNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ)

```
### Loudness*events^pw as fixed and loudness + events^pw as random

```{r}

mBNxPwQ.NPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAPowAvgBin + I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQ.NPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.NPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.NPwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.NPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ)

```

### Loudness fixed + events^pw as mixed

```{r}

mBNxPwQ.PwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQ.PwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.PwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.PwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.PwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ)

```

### Loudness + events^pw as mixed

```{r}

mBNxPwQ.QNxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQ.QNxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBNxPwQ.Q, model2=mBNxPwQ.QNxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.Q, model2=mBNxPwQ.QNxPwQ)

lmtest::lrtest(mBNxPwQ.Q, mBNxPwQ.QNxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ)

```

## Trial sequence

### fixed effect

```{r}

mBNxPwQSq.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                            TrialNumber +
                            (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                            control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQSq.NPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ TrialNumber | UASEvents + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBNxPwQSq.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, mBNxPwQSq.NxPwQ)

```

### mixed effect

```{r}

mBNxPwQSq.NxPwQSq <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                  TrialNumber +
                              (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) + TrialNumber | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)


flexplot::visualize(mBNxPwQSq.NxPwQSq, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ TrialNumber | UASEvents + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQSq, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBNxPwQSq.NxPwQSq)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBNxPwQSq.NxPwQSq)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq)

```
### show plot of model predictions with CIs and mean data points

```{r, fig.width=6, fig.height=5}

df <- subjDataB |> dplyr::group_by(TrialNumber) |> dplyr::summarise(Annoyance = mean(Annoyance), .groups = 'keep')

pred <- ggeffects::predict_response(mBNxPwQSq.NxPwQSq, terms=c("TrialNumber [all]"), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "TrialNumber"

ggplot(pred) +
  geom_ribbon(mapping=aes(TrialNumber, ymin=conf.low, ymax=conf.high, group=1),
                          alpha=0.1, colour = NA, fill=mycolours[1]) +
  geom_line(mapping=aes(TrialNumber, predicted), color=mycolours[1]) +
  geom_point(data=df, mapping=aes(x=TrialNumber, y=Annoyance, group=1), color=mycolours[1], alpha=0.5) +
  scale_x_continuous(n.breaks=17, limits=c(1, 17)) +
  scale_y_continuous(n.breaks=10, limits=c(0, 10)) +
  theme(text = element_text(family = "serif", size=12), axis.text=element_text(size=12),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) +
labs(x="Trial number", y="Annoyance")


```

## Sound quality models

### Tonality 

#### Tonal loudness (independent)

```{r}

mBTnNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                UASTonLdECMAPowAvgBin +
                              (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTnNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonLdECMAPowAvgBin + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTnNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTnNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTnNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ)

```
#### Tonal loudness*events^pw

```{r}

mBTnxPwQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                  UASTonLdECMAPowAvgBin*UASEvents + UASTonLdECMAPowAvgBin:I(UASEvents^0.17) +
                                (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                                control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTnxPwQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonLdECMAPowAvgBin + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTnxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTnxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ)

```
#### Tonality (integrated SHM)

```{r}

mBTNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASTonalSHMInt05ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonalSHMInt05ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ)

```

#### Tonality (Aures)

```{r}

mBTNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ)

```

#### Tonality (Aures)*events^pw

```{r}

mBTxPwQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR*I(UASEvents^0.17) +
                              (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTxPwQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ)

```
#### Tonality (Aures as mixed)

```{r}

mBTNxPwQ.TNxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR +
                              (1 + UASTonalAu10ExMaxLR + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTNxPwQ.TNxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.TNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTNxPwQ.TNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTNxPwQ.TNxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ, mBTNxPwQ.TNxPwQ)

```
```{r}

# mixed model
# fixed effects: 
# random effects: 

# optimx_options <- c("L-BFGS-B", "nlminb", "nlm", "bobyqa", "nmkb", "hjkb")
# for(i in 1:length(optimx_options)){
#   print(paste0("Testing optimx: ", optimx_options[i]))
#   mBTNxPwQ.TNPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
#                               UASTonalAu10ExMaxLR +
#                               (1 + UASTonalAu10ExMaxLR + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
#                               control=lme4::lmerControl(optimizer = "optimx",
#                                             optCtrl = list(method = optimx_options[i],
#                                                                     maxit = 1e9)), REML=FALSE)
# 
#    if(is.null(mBTNxPwQ.TNPwQ@optinfo$conv$lme4$messages)){
#      print(paste0("One of the optimx options, ", optimx_options[i],", worked!"))
#      print(mBTNxPwQ.TNPwQ)
#      break
#  }
# }
# 
#  
# algoptions <- c("NLOPT_LN_PRAXIS", "NLOPT_GN_CRS2_LM",
# "NLOPT_LN_COBYLA", "NLOPT_LN_NEWUOA",
# "NLOPT_LN_NEWUOA_BOUND", "NLOPT_LN_NELDERMEAD",
# "NLOPT_LN_SBPLX", "NLOPT_LN_BOBYQA")
#  
# for(i in 1:length(algoptions)){
#   print(paste0("Testing nloptwrap: ", algoptions[i]))
#   mBTNxPwQ.TNPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
#                               UASTonalAu10ExMaxLR +
#                               (1 + UASTonalAu10ExMaxLR + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
#                               control = lme4::lmerControl(optimizer = "nloptwrap",
#                                             optCtrl = list(algorithm = algoptions[i],
#                                                            maxfun = 1e9,
#                                                            maxeval = 1e7,
#                                                            xtol_abs = 1e-9,
#                                                            ftol_abs = 1e-9)), REML=FALSE)
#    if(is.null(mBTNxPwQ.TNPwQ@optinfo$conv$lme4$messages)){
#      print(paste0("One of the nloptwrap options, ", algoptions[i],", worked!"))
#      print(mBTNxPwQ.TNPwQ)
#      break
#    }
#  }


```


#### Tonality (Aures interaction sharpness)

```{r}

mBTxSNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASTonalAu10ExMaxLR*UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBTxSNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + UASTonalAu10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBTxSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBTxSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBTxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ)

```


### Roughness

#### independent

```{r}

mBRNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ)

```

#### mixed

```{r}

mBRNxPwQ.RNxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR +
                              (1 + UASRoughFZ10ExMaxLR + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRNxPwQ.RNxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.RNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRNxPwQ.RNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRNxPwQ.RNxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRNxPwQ.RNxPwQ)

```

#### interaction (events)

```{r}

mBRxPwQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR:I(UASEvents^0.17) +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRxPwQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID. + UASRoughFZ10ExMaxLR,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxPwQNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ)

```

#### interaction (loudness)

```{r}

mBRxNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASLoudECMAPowAvgBin +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRxNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxNxPwQ.NxPwQ, clusters=5, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ)

```
#### interaction (fluctuation)

```{r}

mBRxFNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASFluctOV10ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRxFNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxFNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxFNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxFNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ)

```
#### interaction (sharpness)

```{r}

mBRxSNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRxSNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ)

```

#### interaction (tonality)

```{r}

mBRxTNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASTonalSHMInt05ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRxTNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASTonalSHMInt05ExMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ)

```

#### interaction (impulsiveness)

```{r}

mBRxINxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASRoughFZ10ExMaxLR*UASImpulsSHMAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBRxINxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASImpulsSHMAvgMaxLR + UASRoughFZ10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBRxINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBRxINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ)

```


### Fluctuation strength

#### independent

```{r}

mBFNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ)

```

#### mixed

```{r}

mBFNxPwQ.FNxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR +
                              (1 + UASFluctOV10ExMaxLR + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFNxPwQ.FNxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.FNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFNxPwQ.FNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFNxPwQ.FNxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFNxPwQ.FNxPwQ)

```

#### interaction (events)

```{r}

mBFxQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASEvents +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFxQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ)

```

#### interaction (loudness)

```{r}

mBFxNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASLoudECMAPowAvgBin +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFxNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASLoudECMAPowAvgBin + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ)

```

#### interaction (sharpness)

```{r}

mBFxSNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFxSNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ)

```

#### interaction (tonality)

```{r}

mBFxTNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASTonalSHMInt05ExMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFxTNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASTonalSHMInt05ExMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxTNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxTNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxTNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ)

```

#### interaction (impulsiveness)

```{r}

mBFxINxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASFluctOV10ExMaxLR*UASImpulsSHMAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBFxINxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASFluctOV10ExMaxLR + UASImpulsSHMAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBFxINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBFxINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ)

```

### Sharpness

#### independent

```{r}

mBSNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBSNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ)

```

#### mixed

```{r}

mBSNxPwQ.SNxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR +
                              (1 + UASSharpAuresISO3PowAvgMaxLR + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBSNxPwQ.SNxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.SNxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSNxPwQ.SNxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSNxPwQ.SNxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSNxPwQ.SNxPwQ)

```

#### interaction (events)

```{r}

mBSxPwQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR*UASEvents +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBSxPwQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ)

```

#### interaction (loudness)

```{r}

mBSxNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR*UASLoudECMAPowAvgBin +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBSxNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSxNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSxNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSxNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ)

```

#### interaction (impulsiveness)

```{r}

mBSxINxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASSharpAuresISO3PowAvgMaxLR*UASImpulsSHMAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBSxINxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASSharpAuresISO3PowAvgMaxLR + UASImpulsSHMAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBSxINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBSxINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ)

```

### Impulsiveness 

#### independent

```{r}

mBINxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASImpulsSHMAvgMaxLR +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBINxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASImpulsSHMAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBINxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBINxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBINxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ,
                                 mBINxPwQ.NxPwQ)

```

#### interaction (events^pw)

```{r}

mBIxPwQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASImpulsSHMAvgMaxLR + UASImpulsSHMAvgMaxLR:I(UASEvents^0.17) +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBIxPwQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASImpulsSHMAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBIxPwQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBIxPwQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBIxPwQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ,
                                 mBINxPwQ.NxPwQ, mBIxPwQNxPwQ.NxPwQ)

```

#### interaction (events)

```{r}

mBIxQNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                              UASImpulsSHMAvgMaxLR + UASImpulsSHMAvgMaxLR:UASEvents +
                              (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBIxQNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASImpulsSHMAvgMaxLR + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBIxQNxPwQ.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBIxQNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBIxQNxPwQ.NxPwQ)

performance::compare_performance(mBBL, mBLq.Lq, mBLAeq, mBQ, mBQ.Q, mBPwQ.Q, mBNPwQ.Q, mBNPwQ.NQ,
                                 mBNxQPwQ.Q, mBNxPwQ.Q, mBNxPwQ.NxPwQ,
                                 mBNxPwQ.NPwQ, mBNxPwQ.PwQ, mBNxPwQ.QNxPwQ, 
                                 mBNxPwQSq.NxPwQ, mBNxPwQSq.NxPwQSq,
                                 mBTnNxPwQ.NxPwQ, mBTnxPwQNxPwQ.NxPwQ,
                                 mBTNxPwQ.NxPwQ, mBTxPwQNxPwQ.NxPwQ,
                                 mBTxSNxPwQ.NxPwQ, mBRNxPwQ.NxPwQ,
                                 mBRxPwQNxPwQ.NxPwQ, mBRxNxPwQ.NxPwQ,
                                 mBRxFNxPwQ.NxPwQ, mBRxSNxPwQ.NxPwQ,
                                 mBRxTNxPwQ.NxPwQ, mBRxINxPwQ.NxPwQ,
                                 mBFNxPwQ.NxPwQ, mBFxQNxPwQ.NxPwQ,
                                 mBFxNxPwQ.NxPwQ, mBFxSNxPwQ.NxPwQ,
                                 mBFxTNxPwQ.NxPwQ, mBFxINxPwQ.NxPwQ,
                                 mBSNxPwQ.NxPwQ, mBSxPwQNxPwQ.NxPwQ,
                                 mBSxNxPwQ.NxPwQ, mBSxINxPwQ.NxPwQ,
                                 mBINxPwQ.NxPwQ, mBIxPwQNxPwQ.NxPwQ,
                                 mBIxQNxPwQ.NxPwQ)

```

## Test if adding UAS type adds further explanatory power

```{r}

mBNxPwQType.NxPwQ <- lme4::lmer(dAnnoyance ~ UASType + UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBNxPwQType.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID. | UASType,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | UASType + ID., data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBNxPwQType.NxPwQ, clusters=3, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBNxPwQType.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBNxPwQType.NxPwQ)

performance::compare_performance(mBNxPwQ.NxPwQ, mBNxPwQType.NxPwQ)

```

## Test if adding difference variables adds further explanatory power

### dSharpness (fixed)

```{r}

mBdSNxPwQ.NxPwQ <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR + UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + dSharpAuresISO3PowAvgMaxLR, data=subjDataB,
                       model1=mBNxPwQ.NxPwQ, model2=mBdSNxPwQ.NxPwQ, clusters=3, re=T)

flexplot::model.comparison(model1=mBNxPwQ.NxPwQ, model2=mBdSNxPwQ.NxPwQ)

lmtest::lrtest(mBNxPwQ.NxPwQ, mBdSNxPwQ.NxPwQ)

performance::compare_performance(mBNxPwQ.NxPwQ, mBdSNxPwQ.NxPwQ)

```
### dSharpness (mixed)

```{r}

mBdSNxPwQ.dSNxPwQ <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR + UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                        (1 + dSharpAuresISO3PowAvgMaxLR + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.dSNxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | dSharpAuresISO3PowAvgMaxLR + ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.dSNxPwQ, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.dSNxPwQ)

lmtest::lrtest(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.dSNxPwQ)

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.dSNxPwQ)

```
## Test if adding intermittency ratio improves model

```{r}

mBdSNxPwQIR.NxPwQ <- lme4::lmer(dAnnoyance ~ IntermitRatioMaxLR + dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                          (1  + UASLoudECMAPowAvgBin +
                                 UASLoudECMAPowAvgBin:I(UASEvents^0.17) | ID.), data=subjDataB,
                          control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQIR.NxPwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + IntermitRatioMaxLR, data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQIR.NxPwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQIR.NxPwQ)

lmtest::lrtest(mBdSNxPwQ.NxPwQ, mBdSNxPwQIR.NxPwQ)

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQIR.NxPwQ)

```

## Test if removing loudness*events^pw random effects improves model

```{r}

mBdSNxPwQ.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                          (1 + UASEvents | ID.), data=subjDataB,
                          control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQ.NxPwQ)  # Note the order of inputs has reversed here

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.Q)

```

```{r}

mBdSNxPwQ.PwQ <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                          (1 + I(UASEvents^0.17) | ID.), data=subjDataB,
                          control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQ.PwQ, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.PwQ, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxPwQ.PwQ)

lmtest::lrtest(mBdSNxPwQ.PwQ, mBdSNxPwQ.NxPwQ)  # Note the order of inputs has reversed here

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.Q,
                                 mBdSNxPwQ.PwQ)

```


```{r}

mBdSNxQPwQ.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                            UASLoudECMAPowAvgBin*UASEvents + I(UASEvents^0.17) +
                          (1 + UASEvents | ID.), data=subjDataB,
                          control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxQPwQ.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID.,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataB,
                       model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxQPwQ.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.NxPwQ, model2=mBdSNxQPwQ.Q)

lmtest::lrtest(mBdSNxQPwQ.Q, mBdSNxPwQ.NxPwQ)  # Note the order of inputs has reversed here

performance::compare_performance(mBdSNxPwQ.NxPwQ, mBdSNxPwQ.Q,
                                 mBdSNxPwQ.PwQ, mBdSNxQPwQ.Q)

```

## Personal factors

### AAM attitude

```{r}


mBdSNxPwQAtt.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                               UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                               AAM_attitude2 +
                            (1 + UASEvents | ID.), data=subjDataB,
                            control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAtt.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID. | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AAM_attitude2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q)

```

### AAM attitude (alternative grouping)

```{r}


mBdSNxPwQAtt2.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                               UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                               AAM_attitude2_2 +
                            (1 + UASEvents | ID.), data=subjDataB,
                            control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAtt2.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID. | AAM_attitude2_2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AAM_attitude2_2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt2.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAtt2.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQAtt2.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAtt2.Q)

```

### Area of residence

#### no attitude

```{r}

mBdSNxPwQAoR.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                             UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                             Home_Area2 +
                          (1 + UASEvents | ID.), data=subjDataB,
                          control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + ID. | Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAoR.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAoR.Q)

lmtest::lrtest(mBdSNxPwQ.Q, mBdSNxPwQAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q)

```
#### with attitude

```{r}
mBdSNxPwQAttAoR.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + Home_Area2 +
                              (1 + UASEvents | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + AAM_attitude2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAttAoR.Q, clusters=5, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q)

```
#### interaction attitude

```{r}


mBdSNxPwQAttxAoR.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2*Home_Area2 +
                              (1 + UASEvents | ID.), data=subjDataB,
                              control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + AAM_attitude2, data=subjDataB,
                       model1=mBdSNxPwQ.Q, model2=mBdSNxPwQAttxAoR.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q)

```
### Area soundscape

```{r}

mBdSNxPwQAttScp.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + Area_soundscape2 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttScp.Q, plot='model', formula=dAnnoyance ~ UASEvents + Area_soundscape2 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Area_soundscape2, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScp.Q, clusters=3, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScp.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttScp.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q)

```
#### interaction (area of residence)

```{r}

mBdSNxPwQAttScpxAoR.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + Area_soundscape2*Home_Area2 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttScpxAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + Area_soundscape2 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttScpxAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + Area_soundscape2 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)


flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Area_soundscape2 + Home_Area2, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScpxAoR.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttScpxAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttScpxAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q)

```

#### interaction (AAM attitude and area of residence)

```{r}

mBdSNxPwQAttxScpxAoR.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2*Area_soundscape2*Home_Area2 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxScpxAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxScpxAoR.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Home_Area2 + Area_soundscape2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)


flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AAM_attitude2 + Area_soundscape2 + Home_Area2, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxScpxAoR.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxScpxAoR.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxScpxAoR.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q)

```

### National region 

#### with attitude

```{r}

mBdSNxPwQAttNat.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2 + NationGeo3 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q)

```

#### interaction with attitude

```{r}

mBdSNxPwQAttxNat.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                 UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                 AAM_attitude2*NationGeo3 +
                                (1 + UASEvents | ID.), data=subjDataB,
                                control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q)

```
#### interaction with attitude and area of residence

```{r}

mBdSNxPwQAttxAoRxNat.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*Home_Area2*NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoRxNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxAoRxNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Home_Area2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoRxNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q, mBdSNxPwQAttxAoRxNat.Q)

```

#### with attitude and area of residence (no interaction)

```{r}

mBdSNxPwQAttAoRNat.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2 + Home_Area2 + NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttAoRNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttAoRNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Home_Area2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttAoRNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q, mBdSNxPwQAttxAoRxNat.Q,
                                 mBdSNxPwQAttAoRNat.Q)

```


### full interaction

```{r}

mBdSNxPwQAttxAoRxScpxNat.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*Home_Area2*Area_soundscape2*NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoRxScpxNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxAoRxScpxNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxScpxNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRxScpxNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoRxScpxNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q)

```

### all factors, no interaction

```{r}

mBdSNxPwQAttAoRScpNat.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2 + Home_Area2 + Area_soundscape2 + NationGeo3 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttAoRScpNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttAoRScpNat.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRScpNat.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttAoRScpNat.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttAoRScpNat.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q,
                                 mBdSNxPwQAttAoRScpNat.Q)

```

### all factors, attitude x national region

```{r}

mBdSNxPwQAttxNatAoRScp.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*NationGeo3 + Home_Area2 + Area_soundscape2 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxNatAoRScp.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxNatAoRScp.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNatAoRScp.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxNatAoRScp.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxNatAoRScp.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q,
                                 mBdSNxPwQAttAoRScpNat.Q, mBdSNxPwQAttxNatAoRScp.Q)

```

### all factors, attitude x area of residence

```{r, R.options=list(width=10)}

mBdSNxPwQAttxAoRNatScp.Q <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                         UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                         AAM_attitude2*Home_Area2 + NationGeo3 + Area_soundscape2 +
                                        (1 + UASEvents | ID.), data=subjDataB,
                                        control=lmcontrol, REML=FALSE)

flexplot::visualize(mBdSNxPwQAttxAoRNatScp.Q, plot='model', formula=dAnnoyance ~ UASEvents + NationGeo3 | AAM_attitude2 + Home_Area2,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::visualize(mBdSNxPwQAttxAoRNatScp.Q, plot='model', formula=dAnnoyance ~ UASEvents + AAM_attitude2 | Area_soundscape2 + NationGeo3,
                    sample=length(levels(subjDataB$ID.)), alpha=0.1)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + Home_Area2 + Area_soundscape2 + NationGeo3, data=subjDataB,
                       model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRNatScp.Q, clusters=2, re=T)

flexplot::model.comparison(model1=mBdSNxPwQAtt.Q, model2=mBdSNxPwQAttxAoRNatScp.Q)

lmtest::lrtest(mBdSNxPwQAtt.Q, mBdSNxPwQAttxAoRNatScp.Q)

performance::compare_performance(mBdSNxPwQ.Q, mBdSNxPwQAtt.Q, mBdSNxPwQAoR.Q,
                                 mBdSNxPwQAttAoR.Q, mBdSNxPwQAttxAoR.Q,
                                 mBdSNxPwQAttScp.Q, mBdSNxPwQAttScpxAoR.Q,
                                 mBdSNxPwQAttxScpxAoR.Q, mBdSNxPwQAttNat.Q,
                                 mBdSNxPwQAttxNat.Q,mBdSNxPwQAttxAoRxNat.Q, 
                                 mBdSNxPwQAttAoRNat.Q, mBdSNxPwQAttxAoRxScpxNat.Q,
                                 mBdSNxPwQAttAoRScpNat.Q, mBdSNxPwQAttxNatAoRScp.Q,
                                 mBdSNxPwQAttxAoRNatScp.Q)

```

## Examine best performing models

### model parameters

```{r}
mBdSNxPwQ.Q.params <- parameters::model_parameters(mBdSNxPwQ.Q)
mBdSNxPwQ.Q.params
mBdSNxPwQ.Q.perform <- performance::model_performance(mBdSNxPwQ.Q, estimator='ML')
mBdSNxPwQ.Q.perform

mBdSNxPwQAtt.Q.params <- parameters::model_parameters(mBdSNxPwQAtt.Q)
mBdSNxPwQAtt.Q.params
mBdSNxPwQAtt.Q.perform <- performance::model_performance(mBdSNxPwQAtt.Q, estimator='ML')
mBdSNxPwQAtt.Q.perform

mBdSNxPwQAttAoR.Q.params <- parameters::model_parameters(mBdSNxPwQAttAoR.Q)
mBdSNxPwQAttAoR.Q.params
mBdSNxPwQAttAoR.Q.perform <- performance::model_performance(mBdSNxPwQAttAoR.Q, estimator='ML')
mBdSNxPwQAttAoR.Q.perform

mBdSNxPwQAttxNat.Q.params <- parameters::model_parameters(mBdSNxPwQAttxNat.Q)
mBdSNxPwQAttxNat.Q.params
mBdSNxPwQAttxNat.Q.perform <- performance::model_performance(mBdSNxPwQAttxNat.Q, estimator='ML')
mBdSNxPwQAttxNat.Q.perform

mBdSNxPwQAttxNatAoRScp.Q.params <- parameters::model_parameters(mBdSNxPwQAttxNatAoRScp.Q)
mBdSNxPwQAttxNatAoRScp.Q.params
mBdSNxPwQAttxNatAoRScp.Q.perform <- performance::model_performance(mBdSNxPwQAttxNatAoRScp.Q, estimator='ML')
mBdSNxPwQAttxNatAoRScp.Q.perform

mBdSNxPwQAttxAoRxScpxNat.Q.params <- parameters::model_parameters(mBdSNxPwQAttxAoRxScpxNat.Q)
mBdSNxPwQAttxAoRxScpxNat.Q.params
mBdSNxPwQAttxAoRxScpxNat.Q.perform <- performance::model_performance(mBdSNxPwQAttxAoRxScpxNat.Q, estimator='ML')
mBdSNxPwQAttxAoRxScpxNat.Q.perform

```





## Fit combined models

### No personal factors

```{r}

mABdSFSxTNxEnvNxPwQSq.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + UASLoudECMAPowAvgBin +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.FNEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQ.FNEnv <- lme4::lmer(dAnnoyance ~ dSharpAuresISO3PowAvgMaxLR +
                                        UASLoudECMAPowAvgBin*AmbientEnv +
                                        UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                        UASFluctOV10ExMaxLR +
                                        UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                        (1 + UASLoudECMAPowAvgBin +
                                           UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                         data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.NEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin +
                                             AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.NEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + UASLoudECMAPowAvgBin +
                                             AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABFSxTNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSSxTNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                           AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSNxEnvNxPwQSq.NxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABSFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + UASSharpAurISO305ExMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSTFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR + UASTonalSHMInt05ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR*UASTonalSHMInt05ExMaxLR +
                                          UASLoudECMAPowAvgBin*AmbientEnv +
                                          UASFluctOV10ExMaxLR +
                                          UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                          (1 + TrialNumberScl + UASLoudECMAPowAvgBin + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                             UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                           data=subjData, control=lmcontrol, REML=FALSE)

flexplot::visualize(mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, plot='model',
                    formula=dAnnoyance ~ UASEvents +  ID.,
                    sample=length(levels(subjData$ID.)), alpha=0.1)

flexplot::visualize(mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, plot='model',
                    formula=dAnnoyance ~ UASLoudECMAPowAvgBin +  ID. | AmbientEnv,
                    sample=length(levels(subjData$ID.)), alpha=0.1)

performance::compare_performance(mABBL, mFSxTNxEnvSq.FNEnvSq, mBdSNxPwQ.Q, mABLq.Lq,
                                 mABdSFSxTNxEnvNxPwQ.FNEnv, mABdSFSxTNxEnvNxPwQSq.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSq.FNEnvSq, mABdSFSxTNxEnvNxPwQSq.NEnvSq,
                                 mABdSFSxTNxEnvNxPwQSq.NEnv, mABdSFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                 mABdSFSxTNxEnvNxPwQSq.FNxPwQEnvSq, mABFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                 mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSNxEnvNxPwQSq.NxPwQEnvSq,
                                 mABSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSTFNxEnvNxPwQSq.FNxPwQEnvSq,
                                 mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq)

```
```{r, fig.width=15, fig.height=12}

perfres <- performance::compare_performance(mABdSFSxTNxEnvNxPwQ.FNEnv, mABdSFSxTNxEnvNxPwQSq.FNEnv,
                                             mABdSFSxTNxEnvNxPwQSq.FNEnvSq, mABdSFSxTNxEnvNxPwQSq.NEnvSq,
                                             mABdSFSxTNxEnvNxPwQSq.NEnv, mABdSFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                             mABdSFSxTNxEnvNxPwQSq.FNxPwQEnvSq, mABFSxTNxEnvNxPwQSq.NxPwQEnvSq,
                                             mABdSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSNxEnvNxPwQSq.NxPwQEnvSq,
                                             mABSFNxEnvNxPwQSq.FNxPwQEnvSq, mABdSTFNxEnvNxPwQSq.FNxPwQEnvSq,
                                             mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq, rank=T)

checkres <- performance::check_model(mABdSxTFNxEnvNxPwQSq.FNxPwQEnvSq)

checkres2 <- performance::check_model(mABdSFNxEnvNxPwQSq.FNxPwQEnvSq)

perfres

plot(perfres)

plot(checkres)

```

### With personal factors

```{r}

mABdSFSxTNxEnvNxPwQSqAttxNat.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2*NationGeo3 +
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAtt.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2 +
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqNat.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      NationGeo3 + 
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAoR.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      Home_Area2 + 
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqScp.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      Area_soundscape2 + 
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2*NationGeo3 + Home_Area2 + Area_soundscape2 +
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)

mABdSFSxTNxEnvNxPwQSqAttNatAoRScp.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2 + NationGeo3 + Home_Area2 + Area_soundscape2 +
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)


mABdSFSxTNxEnvNxPwQSqAttNatAoR.FNEnv <- lme4::lmer(dAnnoyance ~ TrialNumberScl + dSharpAuresISO3PowAvgMaxLR +
                                                      UASLoudECMAPowAvgBin*AmbientEnv +
                                                      UASTonalSHMInt05ExMaxLR*UASSharpAurISO305ExMaxLR +
                                                      UASFluctOV10ExMaxLR +
                                                      UASLoudECMAPowAvgBin*UASEvents + UASLoudECMAPowAvgBin:I(UASEvents^0.17) +
                                                      AAM_attitude2 + NationGeo3 + Home_Area2 +
                                                      (1 + UASLoudECMAPowAvgBin +
                                                         UASFluctOV10ExMaxLR + AmbientEnv | ID.),
                                                       data=subjData, control=lmcontrol, REML=FALSE)


flexplot::visualize(mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv, plot='model',
                    formula=dAnnoyance ~ UASLoudECMAPowAvgBin +  ID. | AmbientEnv + AAM_attitude2,
                    sample=length(levels(subjData$ID.)), alpha=0.1)

flexplot::model.comparison(model1=mABdSFSxTNxEnvNxPwQSq.FNEnv, model2=mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv)

performance::compare_performance(mABdSFSxTNxEnvNxPwQSq.FNEnv, mABdSFSxTNxEnvNxPwQSqAtt.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqNat.FNEnv, mABdSFSxTNxEnvNxPwQSqAoR.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqScp.FNEnv, mABdSFSxTNxEnvNxPwQSqAttxNat.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqAttxNatAoRScp.FNEnv, mABdSFSxTNxEnvNxPwQSqAttNatAoRScp.FNEnv,
                                 mABdSFSxTNxEnvNxPwQSqAttNatAoR.FNEnv)

```