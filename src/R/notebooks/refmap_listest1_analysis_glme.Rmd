---
title: "REFMAP listening test 1 analysis: Generalised linear mixed models for annoyance"
output: html_document
date: "2024-06-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Setup

Load packages

```{r}
library(conflicted)
library(dplyr)
library(flexplot)
library(lme4)
#library(lmerTest)
library(lmtest)
library(merTools)
library(ggeffects)
library(marginaleffects)
library(stats)
library(ggplot2)
library(openxlsx)
library(easystats)
#library(partR2)
#library(rstanarm)
#library(MuMIn)
#library(future)
library(jtools)
library(viridis)
# set package parameters
theme_set(theme_bw())

#numCores <- parallel::detectCores()

#future::plan(multisession, workers = numCores-6)


```

Set parameters

```{r}

# plot colour scheme

mycolourlist = list(c(0, 102, 255), c(0, 204, 153), c(255, 0, 102), c(74, 111, 152), c(251, 164, 49), c(204, 153, 255), c(90, 192, 255), c(80, 245, 233), c(255, 90, 192), c(164, 201, 242), c(255, 254, 139), c(255, 243, 255))
mycolours = matrix()

for (ii in 1:length(mycolourlist)){
  mycolours[ii] = rgb(mycolourlist[[ii]][1]/255,
                      mycolourlist[[ii]][2]/255,
                      mycolourlist[[ii]][3]/255)
}

# toggle to save plots
saveplots = TRUE

if (saveplots){
  # set output plot directory
  choose.files(caption="Just cancel this", filters=matrix(data=c(" ", " "), ncol=2))  # workaround for bug in RTerm choose.dir
  outFigPath <- utils::choose.dir(caption="Select output folder to save plots")
  
  if (!dir.exists(file.path(outFigPath, "svg"))){dir.create(file.path(outFigPath, "svg"))}
  if (!dir.exists(file.path(outFigPath, "pdf"))){dir.create(file.path(outFigPath, "pdf"))}
  
}

# toggle to save data
savedata = TRUE

if (savedata){
  # set output plot directory
  if (saveplots==FALSE){
    choose.files(caption="Just cancel this", filters=matrix(data=c(" ", " "), ncol=2))  # workaround for bug in RTerm choose.dir
  }
  outDataPath <- utils::choose.dir(caption="Select output folder to save data")
}

set.seed(3212165)

lmcontrol <- lme4::lmerControl(optimizer = 'bobyqa',
                               optCtrl = list(maxfun = 1e6))
glmcontrol <- lme4::glmerControl(optimizer = 'bobyqa',
                                optCtrl = list(maxfun = 1e6))


```

# Import data and wrangle

## Parts A & B combined

```{r}

subjDataPath <- utils::choose.files(caption=r"(Select refmap_listest1_testdata_BySubj.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdata_BySubj.csv", "refmap_listest1_testdata_BySubj.csv"), ncol=2))

subjData <- read.csv(subjDataPath, header=TRUE)

stimDataPath <- utils::choose.files(caption=r"(Select refmap_listest1_testdata_ByStim.csv from 03 Experiment\Experiment 1\Analysis\PostProcess)",
                                     filters=matrix(data=c("refmap_listest1_testdata_ByStim.csv", "refmap_listest1_testdata_ByStim.csv"), ncol=2))

stimData <- read.csv(stimDataPath, header=TRUE)

```

```{r}
# definition of ordinal variable levels
UASLAeqCatsA <- c("No UAS", "42", "48", "54", "60")
SNRCatsA <- c("No UAS", "-16", "-10", "-4", "2", "8")
UASOpCatsA <- c("No UAS", "Flyover", "Landing", "Takeoff")
UASTypeCatsA <- c("No UAS", "H520", "M300", "T150")

# encode factors
subjData$ID. <- factor(subjData$ID.)
subjData$UASLAeq <- factor(subjData$UASLAeq, levels=UASLAeqCatsA, order=TRUE)
subjData$SNRlevel <- factor(subjData$SNRlevel, levels=SNRCatsA, order=TRUE)
subjData$UASOperation <- factor(subjData$UASOperation, levels=UASOpCatsA)
subjData$UASType <- factor(subjData$UASType, levels=UASTypeCatsA)
subjData$AmbientEnv <- factor(subjData$AmbientEnv, levels=c("Street", "Park"))
subjData$AAM_attitude <- factor(subjData$AAM_attitude)
subjData$Home_Area <- factor(subjData$Home_Area)
subjData$Area_soundscape <- factor(subjData$Area_soundscape)
subjData$NationGeo <- factor(subjData$NationGeo)

# recode AAM_attitude to 3 groups
subjData <- subjData |> dplyr::mutate(AAM_attitude3 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned") ~ "Ambiv_Concern",
                                                                      "Neutral" ~ "Neutral"))
subjData$AAM_attitude3 <- factor(subjData$AAM_attitude3)

# recode AAM_attitude to 2 groups
subjData <- subjData |> dplyr::mutate(AAM_attitude2 = case_match(AAM_attitude,
                                                                    "Supportive" ~ "Supportive",
                                                                    c("Ambivalent",
                                                                      "Concerned",
                                                                      "Neutral") ~ "Ambiv_Concern_Neutral"))
subjData$AAM_attitude2 <- factor(subjData$AAM_attitude2)

# recode AAM_attitude to 2 other groups
subjData <- subjData |> dplyr::mutate(AAM_attitude2_2 = case_match(AAM_attitude,
                                                                    c("Supportive",
                                                                      "Ambivalent") ~ "Support_Ambiv",
                                                                    c("Concerned",
                                                                      "Neutral") ~ "Concern_Neutral"))

subjData$AAM_attitude2_2 <- factor(subjData$AAM_attitude2_2)

# recode NationGeo to 4 groups
subjData <- subjData |> dplyr::mutate(NationGeo4 = case_match(NationGeo,
                                                               "UK" ~ "UK",
                                                               c("Africa",
                                                                 "SouthAsia") ~ "Africa_SAsia",
                                                               c("Australasia",
                                                                 "EastAsia",
                                                                 "Europe",
                                                                 "MidEast",
                                                                 "SouthAmerica") ~ "Other",
                                                               "" ~ "Unspecified"))
subjData$NationGeo4 <- factor(subjData$NationGeo4)

# recode NationGeo to 3 groups
subjData <- subjData |> dplyr::mutate(NationGeo3 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia") ~ "Africa_SAsia",
                                                                 c("Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjData$NationGeo3 <- factor(subjData$NationGeo3)

# recode NationGeo to 2 groups
subjData <- subjData |> dplyr::mutate(NationGeo2 = case_match(NationGeo,
                                                                 "UK" ~ "UK",
                                                                 c("Africa",
                                                                   "SouthAsia",
                                                                   "Australasia",
                                                                   "EastAsia",
                                                                   "Europe",
                                                                   "MidEast",
                                                                   "SouthAmerica",
                                                                   "") ~ "Other"))
subjData$NationGeo2 <- factor(subjData$NationGeo2)


subjData$NationGeo3 <- factor(subjData$NationGeo3)

# recode Area of residence to 2 groups
subjData <- subjData |> dplyr::mutate(Home_Area2 = case_match(Home_Area,
                                                         "Urban" ~ "Urban",
                                                         c("Suburban",
                                                           "Rural") ~ "Suburban_Rural"))
subjData$Home_Area2 <- factor(subjData$Home_Area2)


# recode Area soundscape to 2 groups
subjData <- subjData |> dplyr::mutate(Area_soundscape2 = case_match(Area_soundscape,
                                                                       c("Calm",
                                                                         "Monotonous") ~ "Uneventful",
                                                                       c("Chaotic",
                                                                         "Vibrant") ~ "Eventful"))

subjData$Area_soundscape2 <- factor(subjData$Area_soundscape2)

# create column with Part B TrialNumbers continuing from Part A
subjData$TrialNumberCnt <- subjData$TrialNumber
subjData$TrialNumberCnt[subjData$SessionPart == "B"] <- subjData$TrialNumberCnt[subjData$SessionPart == "B"] + 
                                                              max(subjData$TrialNumber[subjData$SessionPart=="A"])

# reorder by trial number
subjData <- subjData[with(subjData, order(ID., TrialNumberCnt)), ]

# rescale trial number variables separately for each session part
subjData <- rbind(subjData[subjData$SessionPart == "A", ] |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber, scale=TRUE)),
                    subjData[subjData$SessionPart == "B", ] |> dplyr::mutate(TrialNumberScl = datawizard::standardise(TrialNumber, scale=TRUE)))
subjData <- subjData |> dplyr::mutate(TrialNumberCntScl = datawizard::standardise(TrialNumberCnt, scale=TRUE))

# rescale dB variables
subjData <- subjData |> dplyr::mutate(UASLAeqMaxLRScl = datawizard::standardise(UASLAeqMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(UASLAEMaxLRScl = datawizard::standardise(UASLAEMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(UASEPNLMaxLRScl = datawizard::standardise(UASEPNLMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(Detect0p1IntMaxLRLog = datawizard::standardise(Detect0p1dBIntMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(Detect0p5IntMaxLRLog = datawizard::standardise(Detect0p5dBIntMaxLR, scale=FALSE))
subjData <- subjData |> dplyr::mutate(LAELAF50diffScl = datawizard::standardise(LAELAF50diff, scale=FALSE))

stimData <- stimData |> dplyr::mutate(UASLAeqMaxLRScl = datawizard::standardise(UASLAeqMaxLR, scale=FALSE))
stimData <- stimData |> dplyr::mutate(UASLAEMaxLRScl = datawizard::standardise(UASLAEMaxLR, scale=FALSE))
stimData <- stimData |> dplyr::mutate(UASEPNLMaxLRScl = datawizard::standardise(UASEPNLMaxLR, scale=FALSE))
stimData <- stimData |> dplyr::mutate(Detect0p1IntMaxLRLog = datawizard::standardise(Detect0p1dBIntMaxLR, scale=FALSE))
stimData <- stimData |> dplyr::mutate(Detect0p5IntMaxLRLog = datawizard::standardise(Detect0p5dBIntMaxLR, scale=FALSE))
stimData <- stimData |> dplyr::mutate(LAELAF50diffScl = datawizard::standardise(LAELAF50diff, scale=FALSE))

# convert detectability dB to log variables
subjData <- subjData |> dplyr::mutate(Detect0p1IntMaxLRLog = Detect0p1dBIntMaxLR/10)
subjData <- subjData |> dplyr::mutate(Detect0p5IntMaxLRLog = Detect0p5dBIntMaxLR/10)

stimData <- stimData |> dplyr::mutate(Detect0p1IntMaxLRLog = Detect0p1dBIntMaxLR/10)
stimData <- stimData |> dplyr::mutate(Detect0p5IntMaxLRLog = Detect0p5dBIntMaxLR/10)

# omit ambient-only stimuli
subjDataNoAmb <- subjData |> dplyr::filter(UASLAeq != "No UAS")
stimDataNoAmb <- stimData |> dplyr::filter(UASLAeq != "No UAS")

# re-encode factors omitting ambient-only stimuli
subjDataNoAmb$SNRlevel <- factor(subjDataNoAmb$SNRlevel, levels=SNRCatsA[2:length(SNRCatsA)], order=TRUE)
subjDataNoAmb$UASOperation <- factor(subjDataNoAmb$UASOperation, levels=UASOpCatsA[2: length(UASOpCatsA)])
subjDataNoAmb$UASType <- factor(subjDataNoAmb$UASType, levels=UASTypeCatsA[2:length(UASTypeCatsA)])
stimDataNoAmb$SNRlevel <- factor(stimDataNoAmb$SNRlevel, levels=SNRCatsA[2:length(SNRCatsA)], order=TRUE)
stimDataNoAmb$UASOperation <- factor(stimDataNoAmb$UASOperation, levels=UASOpCatsA[2: length(UASOpCatsA)])
stimDataNoAmb$UASType <- factor(stimDataNoAmb$UASType, levels=UASTypeCatsA[2:length(UASTypeCatsA)])

```

# Parts A & B combined analysis: change in mean annoyance rating

## Categorical models

### Fit a baseline model

```{r}
# baseline model (no predictors, only clustered intercept)
mABBL <- lme4::lmer(dAnnoyance ~ 1 + (1 | ID.), data=subjDataNoAmb,
                    control=lmcontrol, REML=FALSE)

# check the intraclass correlation coefficient and pseudo-Rsquared
performance::icc(mABBL)
performance::r2(mABBL)

params <- parameters::model_parameters(mABBL)

```

#### Plot baseline model

```{r, fig.width=7, fig.height=5}
# plot the baseline

pred <- ggeffects::predict_response(mABBL, terms=c("ID."), margin='empirical')
colnames(pred)[which(names(pred) == "x")] <- "ID."

pred <- pred[order(as.numeric(as.character(pred$ID.))), ]
pred$ID. <- factor(pred$ID., levels=paste(sort(as.integer(levels(pred$ID.)))))

df <- data.frame(ID=pred$ID., dAnnoyance=pred$predicted,
                   dAnnoyMean=rep(params$Coefficient[1], length(pred$ID.)),
                   dAnnoyCILow=rep(params$CI_low[1], length(pred$ID.)),
                   dAnnoyCIHigh=rep(params$CI_high[1], length(pred$ID.)))

ggplot(df) +
  geom_ribbon(mapping=aes(ID, ymin=dAnnoyCILow, ymax=dAnnoyCIHigh),
                          alpha=0.1, colour = NA, group=1, fill=mycolours[4]) +
  geom_line(mapping=aes(ID, dAnnoyMean), group=1, color=mycolours[4]) +
  geom_point(data=pred, mapping=aes(x=ID., y=predicted), color=mycolours[4], size=3, alpha=0.5) +
  scale_y_continuous(n.breaks=10, limits=c(-4, 7)) +
  theme(text = element_text(family = "serif"),
        panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255)),
        axis.text.x  = element_text(size=8),
        axis.text.y  = element_text(size=14),
        axis.title.x  = element_text(size=16),
        axis.title.y  = element_text(size=16)) +
labs(x="Participant", y="Mean change in annoyance rating \n(rel. to baseline)")

```

### Fit ambient environment models

```{r, fig.width=8,fig.height=5}

model1 <- mABEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv +
                               (1 | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

model2 <- mABEnv.Env <- lme4::lmer(dAnnoyance ~ AmbientEnv +
                                   (1 + AmbientEnv | ID.), data=subjDataNoAmb,
                                   control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ AmbientEnv | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=5, re=T, alpha=0.2)


flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env)

```

### Fit UAS multiple events model

#### Events/min

##### fixed effect

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventPerMin = UASEventPerMin + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABBL

model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventPerMin + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  scale_x_continuous()

# convert data back for intended model
subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEvents']*60/25
subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEvents']*60/75

model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEventPerMin | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ)

```

##### mixed events/min

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventPerMin = UASEventPerMin + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABQ

model2 <- mABQ.Q <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                               (1 + UASEventPerMin | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventPerMin + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  scale_x_continuous()

# convert data back for intended model
subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEvents']*60/25
subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEvents']*60/75

model2 <- mABQ.Q <- lme4::lmer(dAnnoyance ~ UASEventPerMin +
                               (1 + UASEventPerMin | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEventPerMin | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mABQ.Q)

```

##### mixed events/min with env

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventPerMin = UASEventPerMin + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABQ

model2 <- mABEnvQ.EnvQ <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEventPerMin +
                                     (1 + UASEventPerMin + AmbientEnv | ID.), data=subjDataNoAmb,
                                     control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventPerMin + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(0, 10, by=1)) +
  labs(x="UAS events per min", y="Change in annoyance rating\n(rel. to baseline)")

# convert data back for intended model
subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "A", 'UASEvents']*60/25
subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEventPerMin'] <- subjDataNoAmb[subjDataNoAmb$SessionPart == "B", 'UASEvents']*60/75

model2 <- mABEnvQ.EnvQ <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEventPerMin +
                                     (1 + UASEventPerMin + AmbientEnv | ID.), data=subjDataNoAmb,
                                     control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEventPerMin | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mABQ.Q,
                                 mABEnvQ.EnvQ)

```

#### Events total

##### fixed effect

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABBL

model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEventsRand +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mABQ <- lme4::lmer(dAnnoyance ~ UASEvents +
                             (1 | ID.), data=subjDataNoAmb,
                             control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ)

```

##### curvilinear events

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABQ

model2 <- mAB1_Q <- lme4::lmer(dAnnoyance ~ UASEventsRand + I(UASEventsRand^-1) +
                               (1 | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mAB1_Q <- lme4::lmer(dAnnoyance ~ UASEvents + I(UASEvents^-1) +
                               (1 | ID.), data=subjDataNoAmb,
                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q)

```   

##### mixed events with curvilinear effect

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mAB1_Q

model2 <- mAB1_Q.1_Q <- lme4::lmer(dAnnoyance ~ UASEventsRand + I(UASEventsRand^-1) +
                                 (1 + I(UASEventsRand^-1) | ID.), data=subjDataNoAmb,
                                 control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model (removing redundant UASEvents variable)
model2 <- mAB1_Q.1_Q <- lme4::lmer(dAnnoyance ~ I(UASEvents^-1) +
                                 (1 + I(UASEvents^-1) | ID.), data=subjDataNoAmb,
                                 control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q)

```


##### curvilinear events with mixed env

```{r, fig.width=8,fig.height=5}

# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mAB1_Q.1_Q

model2 <- mABEnv1_Q.Env1_Q <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASEventsRand + I(UASEventsRand^-1) +
                                      (1 + AmbientEnv + I(UASEventsRand^-1)| ID.), data=subjDataNoAmb,
                                      control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, formula=dAnnoyance ~ UASEventsRand + ID.,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
  labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

# remodel intended model
model2 <- mABEnv1_Q.Env1_Q <- lme4::lmer(dAnnoyance ~ AmbientEnv + I(UASEvents^-1) +
                                       (1 + AmbientEnv + I(UASEvents^-1) | ID.), data=subjDataNoAmb,
                                       control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AmbientEnv, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q)

```

#### type and op as fixed

```{r}

model1 <- mABEnv1_Q.Env1_Q

model2 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASType + UASOperation +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASType + UASOperation +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl [all]", "AmbientEnv", "UASEvents [1]"),
                                             type='fixed', margin='marginalmeans', by="UASLAEMaxLRScl")

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dAnnoyMean, colour=AmbientEnv, shape=AmbientEnv), alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="Mean change in annoyance") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(-2, 10, by=1), limits=c(-1, 9)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = TRUE)) +
  scale_fill_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = TRUE)) +
  scale_shape_manual(values=c(1, 3), guide=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q,
                                 mABTypeOpLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### type and op interactions (similar to ANOVA)

```{r}

model1 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                        UASLAEMaxLRScl*UASOperation +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        UASType:AmbientEnv +
                                                        UASLAEMaxLRScl*UASType +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                        UASLAEMaxLRScl*UASOperation +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        UASType:AmbientEnv +
                                                        UASLAEMaxLRScl*UASType +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q,
                                 mABTypeOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### reduced interactions 1

```{r}

model1 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q,
                                 mABTypeOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### reduced interactions 1

```{r}

model1 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypexOpLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation*UASType +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypexOpLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation*UASType +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q,
                                 mABTypeOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### mixed type

```{r}

model1 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypeOpLAExEnv1_QSq.TypeLAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + UASType + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refir to remove redundant UASEvents variable
model2 <- mABTypeOpLAExEnv1_QSq.TypeLAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + UASType + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q,
                                 mABTypeOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpLAExEnv1_QSq.TypeLAEEnv1_Q)

parameters::model_parameters(model2)

```

#### mixed operation

```{r}

model1 <- mABTypeOpLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypeOpLAExEnv1_QSq.OpLAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + UASOperation + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpLAExEnv1_QSq.OpLAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + UASOperation + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mABQ, mAB1_Q,
                                 mAB1_Q.1_Q, mABEnv1_Q.Env1_Q,
                                 mABTypeOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypexOpLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpLAExEnv1_QSq.TypeLAEEnv1_Q,
                                 mABTypeOpLAExEnv1_QSq.OpLAEEnv1_Q)

parameters::model_parameters(model2)

```


## Absolute metrics

### Fit LAE models

```{r}

model1 <- mABBL

model2 <- mABLAE <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl +
                              (1 | ID.),
                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=3, re=T)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE)

```

```{r}

model1 <- mABLAE

model2 <- mABLAE.LAE <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl +
                                   (1 + UASLAEMaxLRScl | ID.),
                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=3, re=T)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE)

```

### Ambient env and LAE mixed model

Fit a model combining ambient environment category and LAE and compare with ambient environment only model

```{r, fig.width=8,fig.height=5}

model1 <- mABEnv.Env

model2 <- mABLAEEnv.LAEEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv + UASLAEMaxLRScl +
                                         (AmbientEnv + UASLAEMaxLRScl | ID.), data=subjDataNoAmb,
                                         control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjData$ID.)), alpha=0.1)  + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | AmbientEnv + ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv)

```

### Ambient env and LAE interaction mixed model

Fit a model combining ambient environment category and LAE and compare with ambient environment only model

```{r, fig.width=8,fig.height=5}

model1 <- mABEnv.Env

model2 <- mABLAExEnv.LAEEnv <- lme4::lmer(dAnnoyance ~ AmbientEnv*UASLAEMaxLRScl +
                                         (AmbientEnv + UASLAEMaxLRScl | ID.), data=subjDataNoAmb,
                                         control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjData$ID.)), alpha=0.1)  + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::compare.fits(dAnnoyance ~ UASLAEMaxLRScl | AmbientEnv + ID., data=subjDataNoAmb,
                       model1=model1, model2=model2, clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv,
                                 mABLAExEnv.LAEEnv)

```

### Ambient env, LAE and events mixed model

```{r, fig.width=8,fig.height=5}
# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABLAEEnv.LAEEnv

model2 <- mABLAEEnv1_Q.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl + AmbientEnv +
                                             UASEventsRand + I(UASEventsRand^-1) +
                                             (1 + UASLAEMaxLRScl + I(UASEventsRand^-1) + AmbientEnv | ID.), data=subjDataNoAmb,
                                             control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID. | UASLAEMaxLRScl,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::visualize(model2, plot='model',
                    formula=dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# convert back to intended model
model2 <- mABLAEEnv1_Q.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl + AmbientEnv +
                                             I(UASEvents^-1) +
                                             (1 + UASLAEMaxLRScl + I(UASEvents^-1) + AmbientEnv | ID.), data=subjDataNoAmb,
                                             control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + UASLAEMaxLRScl, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q)

```

### Ambient env, events and LAE interaction mixed model

This model accounts for the different rates of growth in annoyance between the two environments

```{r, fig.width=8,fig.height=5}

model1 <- mABLAEEnv1_Q.LAEEnv1_Q

model2 <- mABLAExEnv1_Q.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                              UASEvents + I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + I(UASEvents^-1) + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABLAExEnv1_Q.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                                I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + I(UASEvents^-1) + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + UASLAEMaxLRScl,
                       data=subjDataNoAmb, model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q)

```

### LAE interaction with events

```{r, fig.width=8,fig.height=5}
# add random small number to UASEventPerMin variable to avoid flexplot converting to ordinal
subjDataNoAmb <- subjDataNoAmb |> dplyr::mutate(UASEventsRand = UASEvents + runif(nrow(subjDataNoAmb), -1e-15, 1e-15))

model1 <- mABLAExEnv1_Q.LAEEnv1_Q

model2 <- mAB1_QxLAExEnv.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                              UASLAEMaxLRScl*UASEventsRand + I(UASEventsRand^-1) +
                                               (1 + UASLAEMaxLRScl + I(UASEventsRand^-1) + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASEventsRand + ID. | UASLAEMaxLRScl,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) + 
              labs(x="UAS events", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::visualize(model2, plot='model', formula=dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv,
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1) +
                    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

#refit intended model
model2 <- mAB1_QxLAExEnv.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASLAEMaxLRScl*AmbientEnv +
                                              UASLAEMaxLRScl*I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + I(UASEvents^-1) + AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + UASLAEMaxLRScl,
                       data=subjDataNoAmb, model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q)

```

### Trial sequence models

#### Parts A + B standardised trial indexing plot

```{r, 6.4, fig.height=4}

dataFrame <- subjData |> group_by(TrialNumberScl) |> summarise(dAnnoyance = mean(dAnnoyance))

ggplot(data=dataFrame, mapping=aes(TrialNumberScl, dAnnoyance)) + geom_point(color=mycolours[1], alpha=0.3) +
       geom_smooth(formula = y ~ x, method = "lm", alpha=0.3, color=mycolours[1]) +
       theme(text = element_text(family = "serif"), panel.grid=element_line(color = rgb(235, 235, 235, 90, maxColorValue = 255))) + 
       labs(x="Trial number (standardised)", y="Change in annoyance rating\n(rel. to baseline)") + scale_y_continuous(n.breaks=10, limits=c(-4, 7)) +
       scale_x_continuous(breaks=seq(min(subjData$TrialNumberScl), max(subjData$TrialNumberScl) + 1, by=10))

```

#### fixed effect

```{r}

model1 <- mABLAExEnv1_Q.LAEEnv1_Q

model2 <- mABLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                UASLAEMaxLRScl*AmbientEnv +
                                                UASEvents + I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + I(UASEvents^-1) +
                                                  AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ TrialNumberScl + ID. | AmbientEnv) +
  labs(x="Trial number (standardised)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                UASLAEMaxLRScl*AmbientEnv +
                                                I(UASEvents^-1) +
                                               (1 + UASLAEMaxLRScl + I(UASEvents^-1) +
                                                  AmbientEnv | ID.), data=subjDataNoAmb,
                                               control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AmbientEnv + TrialNumberScl, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q)

```

NOTE: Although trial sequence could be modelled as a mixed effect, this would allow a random slope for each participant, which would 
explain more of the variation in annoyance, but would be artificially 'stealing' explanatory power from the other candidate predictors.

### EPNL model

```{r}

model1 <- mABLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                  UASEvents + I(UASEvents^-1) +
                                                  UASEPNLMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASEPNLMaxLR) - max(subjDataNoAmb$UASEPNLMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                    I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                   (1 + I(UASEvents^-1) + UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

# flexplot::compare.fits(dAnnoyance ~ AmbientEnv | ID. + UASEPNLMaxLRScl, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2) # - different predictors

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2) #- NOT NESTED

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q)

```
### Loudness models

#### Sottek

```{r}

model1 <- mABEPNLxEnv1_QSq.EPNLEnv1_Q

model2 <- mABNxEnv1_QSq.NEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                UASEvents + I(UASEvents^-1) +
                                              UASLoudECMAPowAvgBin*AmbientEnv +
                                              (1 + I(UASEvents^-1) + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                              data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABNxEnv1_QSq.NEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                I(UASEvents^-1) +
                                              UASLoudECMAPowAvgBin*AmbientEnv +
                                              (1 + I(UASEvents^-1) + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                              data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

# flexplot::compare.fits(dAnnoyance ~ UASLoudECMAPowAvgBin | ID. + AmbientEnv, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)  # - different predictors

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2) #- NOT NESTED

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q, mABNxEnv1_QSq.NEnv1_Q)

```
#### ISO 532-3

```{r}

model1 <- mABEPNLxEnv1_QSq.EPNLEnv1_Q

model2 <- mABN3xEnv1_QSq.NEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                              UASEvents + I(UASEvents^-1) +
                                            UASLoudISO3PowAvgBin*AmbientEnv +
                                            (1 + I(UASEvents^-1) + UASLoudISO3PowAvgBin + AmbientEnv | ID.),
                                            data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLoudISO3PowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Moore-Glasberg-Schlittenlacher), sone", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABN3xEnv1_QSq.NEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                              I(UASEvents^-1) +
                                            UASLoudISO3PowAvgBin*AmbientEnv +
                                            (1 + I(UASEvents^-1) + UASLoudISO3PowAvgBin + AmbientEnv | ID.),
                                            data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

# flexplot::compare.fits(dAnnoyance ~ UASLoudISO3PowAvgBin | ID. + AmbientEnv, data=subjDataNoAmb,
#                        model1=model1, model2=model2,
#                        clusters=5, re=T, alpha=0.2)  # - different predictors

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2) #- NOT NESTED

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q, mABN3xEnv1_QSq.NEnv1_Q)

```

### EPNL with mixed interaction

```{r}

model1 <- mABEPNLxEnv1_QSq.EPNLEnv1_Q

model2 <- mABEPNLxEnv1_QSq.EPNLxEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                    (1 + I(UASEvents^-1) + UASEPNLMaxLRScl*AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASEPNLMaxLR) - max(subjDataNoAmb$UASEPNLMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABEPNLxEnv1_QSq.EPNLxEnv1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                                    I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                    (1 + I(UASEvents^-1) + UASEPNLMaxLRScl*AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::compare.fits(dAnnoyance ~ UASEvents | ID. + AmbientEnv + UASEPNLMaxLRScl, data=subjDataNoAmb,
                       model1=model1, model2=model2,
                       clusters=5, re=T, alpha=0.2)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q, mABEPNLxEnv1_QSq.EPNLxEnv1_Q)

```

### Tonal loudness and tonality

#### tonal loudness

```{r}

model1 <- mABLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonLdECMAPowAvgBin + TrialNumberScl +
                                                 UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonLdECMAPowAvgBin + TrialNumberScl +
                                                    I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q)

```
#### tonality

```{r}

model1 <- mABLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                 UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                 UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q)

```

#### tonality (EPNL)

```{r}

model1 <- mABTLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                    (1 + I(UASEvents^-1) + UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASEPNLMaxLR) - max(subjDataNoAmb$UASEPNLMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                    I(UASEvents^-1) +
                                                    UASEPNLMaxLRScl*AmbientEnv +
                                                    (1 + I(UASEvents^-1) + UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q)

```

#### tonality as mixed

```{r}

model1 <- mABTLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTLAExEnv1_QSq.TLAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASTonalSHMInt05ExMaxLR +
                                                     UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTLAExEnv1_QSq.TLAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR + TrialNumberScl +
                                                    I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASTonalSHMInt05ExMaxLR +
                                                     UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q)

```

#### with tonality interaction

```{r}

model1 <- mABTLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR*UASLAEMaxLRScl +
                                                  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASLAEMaxLRScl +
                                                     AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

model2 <- mABTxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonalSHMInt05ExMaxLR*UASLAEMaxLRScl +
                                                  TrialNumberScl +
                                                   I(UASEvents^-1) +
                                                  UASLAEMaxLRScl*AmbientEnv +
                                                  (1 + I(UASEvents^-1) + UASLAEMaxLRScl +
                                                     AmbientEnv | ID.),
                                                  data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q)

```

#### EPNL tonality interaction

```{r}

model1 <- mABTxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTxEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~ UASEPNLMaxLRScl*UASTonalSHMInt05ExMaxLR +
                                                    TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                   UASEPNLMaxLRScl*AmbientEnv +
                                                   (1 + I(UASEvents^-1) +
                                                      UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASEPNLMaxLR) - max(subjDataNoAmb$UASEPNLMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTxEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~ UASEPNLMaxLRScl*UASTonalSHMInt05ExMaxLR +
                                                    TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                   UASEPNLMaxLRScl*AmbientEnv +
                                                   (1 + I(UASEvents^-1) +
                                                      UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q)

```

#### with tonality and env interaction

```{r}

model1 <- mABTxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABLAExTxEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                    UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR*AmbientEnv +
                                                    (1 + I(UASEvents^-1) + UASLAEMaxLRScl +
                                                       AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABLAExTxEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  TrialNumberScl +
                                                   I(UASEvents^-1) +
                                                    UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR*AmbientEnv +
                                                    (1 + I(UASEvents^-1) + UASLAEMaxLRScl +
                                                       AmbientEnv | ID.),
                                                    data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q)

```

### Sharpness

#### sharpness (Aures | Moore-Glasberg)

```{r}

model1 <- mABTxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABSTxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR +
                                                 UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                 UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                 (1 + I(UASEvents^-1) +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABSTxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR +
                                                 UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                 UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                 (1 + I(UASEvents^-1) +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q)

```

#### sharpness interacting with tonality

```{r}

model1 <- mABSTxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABSxTxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABSxTxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*UASTonalSHMInt05ExMaxLR + 
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q, mABEPNLxEnv1_QSq.EPNLxEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q)

```

#### sharpness interacting with tonality, not with LAE

```{r}

model1 <- mABSTxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABSxTLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABSxTLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q)

```

#### sharpness interacting with tonal loudness

```{r}

model1 <- mABSxTLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABSxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonLdECMAPowAvgBin +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABSxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurISO305ExMaxLR*UASTonLdECMAPowAvgBin +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q)

```

#### sharpness (Aures | Sottek)

```{r}

model1 <- mABSxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q)

```

#### sharpness (Aures | Sottek) interaction with tonality

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                 (1 + I(UASEvents^-1) +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

model2 <- mABShmxTLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonalSHMInt05ExMaxLR +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                  TrialNumberScl + I(UASEvents^-1) +
                                                 (1 + I(UASEvents^-1) +
                                                    UASLAEMaxLRScl + AmbientEnv | ID.),
                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q)

```

#### sharpness, tonal loudness, LAE and env interaction

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin*UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin*UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q)

```

#### no interaction sharpness with tonal loudness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR + UASTonLdECMAPowAvgBin +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR + UASTonLdECMAPowAvgBin +
                                                   UASLAEMaxLRScl*AmbientEnv +
                                                    TrialNumberScl + I(UASEvents^-1) +
                                                   (1 + I(UASEvents^-1) +
                                                      UASLAEMaxLRScl + AmbientEnv | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmTnLAExEnv1_QSq.LAEEnv1_Q)

```

### Fluctuation strength

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASFluctOV10ExMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASFluctOV10ExMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q)

```

### Roughness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASRoughFZ05ExMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASRoughFZ05ExMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q)

```

### Impulsiveness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASImpulsSHMAvgMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASImpulsSHMAvgMaxLR +
                                                      UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q)

```

### Substitute EPNL for LAE

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~  UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASEPNLMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASEPNLMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS EPNL, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASEPNLMaxLR) - max(subjDataNoAmb$UASEPNLMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASEPNLMaxLR)), ceiling(max(subjDataNoAmb$UASEPNLMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q <- lme4::lmer(dAnnoyance ~  UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASEPNLMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                       (1 + I(UASEvents^-1) +
                                                          UASEPNLMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q)

```

### Curvilinear LAE

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                       I(UASLAEMaxLRScl^2) +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                         UASLAEMaxLRScl*AmbientEnv +
                                                           I(UASLAEMaxLRScl^2) +
                                                          TrialNumberScl + I(UASEvents^-1) +
                                                         (1 + I(UASEvents^-1) +
                                                            UASLAEMaxLRScl + AmbientEnv | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)
flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q)

```

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                       I(UASLAEMaxLRScl^2) + I(UASLAEMaxLRScl^-1) +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                       I(UASLAEMaxLRScl^2) + I(UASLAEMaxLRScl^-1) +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q)

```

### All SQMs

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl + AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```
### Step remove LAE and SQMs

#### LAE

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFIRShmxTnEnv1_QSq.Env1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASTonLdECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS tonal loudness, sone", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABFIRShmxTnEnv1_QSq.Env1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q)

parameters::model_parameters(model2)

```

#### tonal loudness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFIRShmLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFIRShmLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### sharpness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFIRTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFIRTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### fluctuation strength

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### roughness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASFluctOV10ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASFluctOV10ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### impulsiveness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASFluctOV10ExMaxLR +
                                                           UASRoughFZ05ExMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASFluctOV10ExMaxLR +
                                                           UASRoughFZ05ExMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

mABSQMperf <- performance::compare_performance(mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFIRShmxTnEnv1_QSq.Env1_Q,
                                               mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q)

```

#### omit roughness and impulsiveness

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASFluctOV10ExMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                            UASFluctOV10ExMaxLR +
                                                     UASLAEMaxLRScl*AmbientEnv +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        AmbientEnv | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABEnv1_Q.Env1_Q, mABLAE, mABLAE.LAE, mABLAEEnv.LAEEnv, mABLAExEnv.LAEEnv,
                                 mABLAEEnv1_Q.LAEEnv1_Q, mABLAExEnv1_Q.LAEEnv1_Q,
                                 mAB1_QxLAExEnv.LAEEnv1_Q, mABLAExEnv1_QSq.LAEEnv1_Q,
                                 mABEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABNxEnv1_QSq.NEnv1_Q,
                                 mABTnLAExEnv1_QSq.LAEEnv1_Q, mABTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABTLAExEnv1_QSq.TLAEEnv1_Q, mABTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTxEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABLAExTxEnv1_QSq.LAEEnv1_Q, mABSTxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTxLAExEnv1_QSq.LAEEnv1_Q, mABSxTLAExEnv1_QSq.LAEEnv1_Q,
                                 mABSxTnLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTLAExEnv1_QSq.LAEEnv1_Q, mABShmxTnxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnEPNLxEnv1_QSq.EPNLEnv1_Q,
                                 mABShmxTnLAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTn1_LAE2xEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q)

parameters::model_parameters(model2)

mABSQMperf <- performance::compare_performance(mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFIRShmxTnEnv1_QSq.Env1_Q,
                                               mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                               mABFShmxTnLAExEnv1_QSq.LAEEnv1_Q)

```

### All SQMs without env

```{r}

model1 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFIRShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR + UASRoughFZ05ExMaxLR +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAE1_QSq.LAE1_Q)

parameters::model_parameters(model2)

```

#### no roughness or fluctuation strength 

```{r}

model1 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABIShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABIShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASImpulsSHMAvgMaxLR +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAE1_QSq.LAE1_Q,
                                 mABIShmxTnLAE1_QSq.LAE1_Q)

parameters::model_parameters(model2)

```

#### no roughness or impulsiveness 

```{r}

model1 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABFShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABFShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                           UASFluctOV10ExMaxLR +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAE1_QSq.LAE1_Q,
                                 mABIShmxTnLAE1_QSq.LAE1_Q,
                                 mABFShmxTnLAE1_QSq.LAE1_Q)

parameters::model_parameters(model2)

```

#### no roughness, impulsiveness or fluctuation strength 

```{r}

model1 <- mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl +
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABFIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnEnv1_QSq.Env1_Q,
                                 mABFIRShmLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFRShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABFIRShmxTnLAE1_QSq.LAE1_Q,
                                 mABIShmxTnLAE1_QSq.LAE1_Q,
                                 mABFShmxTnLAE1_QSq.LAE1_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q)

parameters::model_parameters(model2)

```


## Difference metrics

### UASLAE - AmbLAF50

```{r}

model1 <- mAB1_Q.1_Q

model2 <- mABdLAELAF501_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl +
                                           TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdLAELAF501_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl +
                                           TrialNumberScl + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)
flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q)


```
#### with dTonal loudness

```{r}

model1 <- mABdLAELAF501_QSq.dLAELAF501_Q

model2 <- mABdTndLAELAF501_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl +
                                                         dTonLdECMAPowAvgBin +
                                           TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdTndLAELAF501_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl +
                                                         dTonLdECMAPowAvgBin +
                                           TrialNumberScl + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q)


```
#### with dTonal loudness interaction

```{r}

model1 <- mABdTndLAELAF501_QSq.dLAELAF501_Q

model2 <- mABdTnxdLAELAF501_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl*dTonLdECMAPowAvgBin +
                                                         TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdTnxdLAELAF501_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl*dTonLdECMAPowAvgBin +
                                                         TrialNumberScl + I(UASEvents^-1) +
                                                         (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q)


```

#### with curvilinear LAEdiff

```{r}

model1 <- mABdTnxdLAELAF501_QSq.dLAELAF501_Q

model2 <- mABdTnxdLAELAF5021_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl*dTonLdECMAPowAvgBin +
                                                           I(LAELAF50diffScl^2) +
                                                         TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdTnxdLAELAF5021_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ LAELAF50diffScl*dTonLdECMAPowAvgBin +
                                                           I(LAELAF50diffScl^2) +
                                                         TrialNumberScl + I(UASEvents^-1) +
                                                         (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q)


```

### Detectability

0.1 s averaging

#### mixed

```{r}

model1 <- mABdTnxdLAELAF501_QSq.dLAELAF501_Q

model2 <-  mABDt1i1_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             (1 + Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABDt1i1_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             (1 + Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q)

```
#### 0.5 s averaging

```{r}

model1 <- mABDt1i1_QSq.Dt1i1_Q

model2 <-  mABDt5i1_QSq.Dt5i1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p5IntMaxLRLog +
                                             (1 + Detect0p5IntMaxLRLog + I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABDt5i1_QSq.Dt5i1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             I(UASEvents^-1) +
                                             Detect0p5IntMaxLRLog +
                                             (1 + Detect0p5IntMaxLRLog + I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q)

```

#### curvilinear mixed effect

```{r}

model1 <- mABDt1i1_QSq.Dt1i1_Q

model2 <-  mABDt1i21_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABDt1i21_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ TrialNumberScl +
                                             I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q)

```

#### difference in sharpness

##### sharpness

(dSharpAurSHM05ExMaxLR is selected in favour of ISO3 as it yields better results later)

```{r}

model1 <- mABDt1i21_QSq.Dt1i1_Q

model2 <-  mABdSDt1i21_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ dSharpAurSHM05ExMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, #plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdSDt1i21_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ dSharpAurSHM05ExMaxLR +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q)

```

##### sharpness interaction with detectability

```{r}

model1 <- mABdSDt1i21_QSq.Dt1i1_Q

model2 <-  mABdSxDt1i21_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, #plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdSxDt1i21_QSq.Dt1i1_Q <- lme4::lmer(dAnnoyance ~ dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q)

```

##### mixed, no interaction

```{r}

model1 <- mABdSDt1i21_QSq.Dt1i1_Q

model2 <-  mABdSDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dSharpAurSHM05ExMaxLR +
                                                  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                   Detect0p1IntMaxLRLog +
                                                   I(Detect0p1IntMaxLRLog^2) +
                                                   (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, #plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdSDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dSharpAurSHM05ExMaxLR +
                                                  TrialNumberScl +
                                                   I(UASEvents^-1) +
                                                   Detect0p1IntMaxLRLog +
                                                   I(Detect0p1IntMaxLRLog^2) +
                                                   (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q)

parameters::model_parameters(model2)

```

##### fixed interaction with detectability

```{r}

model1 <- mABdSDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ 
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog + dSharpAurSHM05ExMaxLR +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ 
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + Detect0p1IntMaxLRLog + dSharpAurSHM05ExMaxLR +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q)

parameters::model_parameters(model2)

```

##### mixed interaction with detectability

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdSxDt1i21_QSq.dSxDt1i1Q <- lme4::lmer(dAnnoyance ~ 
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdSxDt1i21_QSq.dSxDt1i1Q <- lme4::lmer(dAnnoyance ~ 
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSxDt1i1Q)

```

#### difference in fluctuation strength

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdFdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dFluctSHM10ExBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

model2 <-  mABdFdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dFluctSHM10ExBin +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q)

```

#### difference in roughness

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdRdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dRoughFZ05ExMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdRdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dRoughFZ05ExMaxLR +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q)

```

#### difference in impulsiveness

##### fixed

```{r}

model1 <- mABdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdIdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdIdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q)

```

##### mixed

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdIdSxDt1i21_QSq.dIdSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                                 UASEvents + I(UASEvents^-1) +
                                                 dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                                 I(Detect0p1IntMaxLRLog^2) +
                                                 (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                dImpulsSHMAvgMaxLR +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdIdSxDt1i21_QSq.dIdSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                                  I(UASEvents^-1) +
                                                 dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                                 I(Detect0p1IntMaxLRLog^2) +
                                                 (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                dImpulsSHMAvgMaxLR +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dIdSDt1i1_Q)

```

##### interaction with detectability

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdSxDt1i2xdI1_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ 
                                                    dImpulsSHMAvgMaxLR*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdSxDt1i2xdI1_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ 
                                                    dImpulsSHMAvgMaxLR*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q)

```

#### difference in tonal loudness

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdTndIdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdTndIdSxDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                              I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q)

```
##### interaction with detectability

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin*Detect0p1IntMaxLRLog +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q)

```

##### mixed

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1i1_Q

model2 <-  mABdTndIdSxDt1i21_QSq.dTndSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             UASEvents + I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dTonLdECMAPowAvgBin + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdTndIdSxDt1i21_QSq.dTndSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          dTonLdECMAPowAvgBin +
                                                  TrialNumberScl +
                                             I(UASEvents^-1) +
                                             dSharpAurSHM05ExMaxLR*Detect0p1IntMaxLRLog +
                                             I(Detect0p1IntMaxLRLog^2) +
                                             (1 + dTonLdECMAPowAvgBin + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                              I(UASEvents^-1) | ID.),
                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dTndSDt1i1_Q)

```

##### interaction with sharpness difference

```{r}

model1 <- mABdIdSxDt1i21_QSq.dSDt1i1_Q
          
model2 <-  mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                           UASEvents + I(UASEvents^-1) +
                                                           dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                             Detect0p1IntMaxLRLog +
                                                           I(Detect0p1IntMaxLRLog^2) +
                                                           (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                            I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <-  mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                           I(UASEvents^-1) +
                                                           dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                             Detect0p1IntMaxLRLog +
                                                           I(Detect0p1IntMaxLRLog^2) +
                                                           (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                            I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q)

```

### LAELAF50diff with all other factors from best absolute model, omitting AmbientEnv

```{r}

model1 <- mABdLAELAF501_QSq.dLAELAF501_Q

model2 <- mABShmxTndLAELAF501_QSq.dLAELAF501_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                           TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))
  
# refit to remove redundant UASEvents variable
model2 <- mABShmxTndLAELAF501_QSq.dLAELAF50Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                           TrialNumberScl + I(UASEvents^-1) +
                                           (1 + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q)

```

### LAELAF50diff with other factors from best detectability model

```{r}

model1 <- mABdLAELAF501_QSq.dLAELAF501_Q
          
model2 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                                   UASEvents + I(UASEvents^-1) +
                                                   dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin + 
                                                     LAELAF50diffScl +
                                                   (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                    I(UASEvents^-1) | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                  TrialNumberScl +
                                                   I(UASEvents^-1) +
                                                   dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin + 
                                                     LAELAF50diffScl +
                                                   (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                    I(UASEvents^-1) | ID.),
                                                   data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q)

```

### Add env to best detectability model

#### fixed

```{r}

model1 <- mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q
          
model2 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                            TrialNumberScl + AmbientEnv +
                                                            UASEvents + I(UASEvents^-1) +
                                                            dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                            Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                            (1 + dSharpAurSHM05ExMaxLR +
                                                               Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                            TrialNumberScl + AmbientEnv +
                                                            I(UASEvents^-1) +
                                                            dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                            Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                            (1 + dSharpAurSHM05ExMaxLR +
                                                               Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q)

```

#### mixed

```{r}

model1 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q

model2 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl + AmbientEnv +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl + AmbientEnv +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv)

parameters::model_parameters(model2)

```

#### mixed with fixed interaction

```{r}

model1 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv 

model2 <- mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                Detect0p1IntMaxLRLog*AmbientEnv + I(Detect0p1IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                Detect0p1IntMaxLRLog*AmbientEnv + I(Detect0p1IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   Detect0p1IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv)

parameters::model_parameters(model2)

```

#### substitute LAELAF50diff for detectability, no env interaction

```{r}

model1 <- mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv 
          
model2 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF50QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### add detectability^2 to LAELAF50diff model

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 
          
model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF50Dt5i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) + Detect0p5IntMaxLRLog | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF50Dt5i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) + Detect0p5IntMaxLRLog | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF50Dt5i1_QEnv)

parameters::model_parameters(model2)

```

#### add detectability to LAELAF50diff model

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF50Dt5i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + 
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) + Detect0p5IntMaxLRLog | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF50Dt5i1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + 
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) + Detect0p5IntMaxLRLog | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF50Dt5i1_QEnv)

parameters::model_parameters(model2)

```

#### add fixed detectability to LAELAF50diff model

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + 
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

model2 <- mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + 
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### add fixed detectability^2 to LAELAF50diff model

```{r}

model1 <- mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID. | AmbientEnv) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + AmbientEnv +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```
#### curvilinear LAELAF50diff, no detectability

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 
          
model2 <- mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + I(LAELAF50diffScl^2) + AmbientEnv +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))
  
model2 <- mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + I(LAELAF50diffScl^2) + AmbientEnv +
                                                                (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### curvilinear LAELAF50diff, omit env

```{r}

model1 <- mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv 
          
model2 <- mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + I(LAELAF50diffScl^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + I(LAELAF50diffScl^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q)

parameters::model_parameters(model2)

```

#### mixed curvilinear LAELAF50diff, omit env

```{r}

model1 <- mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv 
          
model2 <- mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + I(LAELAF50diffScl^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(LAELAF50diffScl^2) + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))
  
model2 <- mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl + I(LAELAF50diffScl^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(LAELAF50diffScl^2) + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q)

parameters::model_parameters(model2)

```

### All dSQMs with top models

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                               dRoughFZ05ExMaxLR +
                                                                              TrialNumberScl +
                                                                              UASEvents + I(UASEvents^-1) +
                                                                              dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                              LAELAF50diffScl + AmbientEnv +
                                                                              (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                                 LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                               dRoughFZ05ExMaxLR +
                                                                              TrialNumberScl +
                                                                              I(UASEvents^-1) +
                                                                              dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                              LAELAF50diffScl + AmbientEnv +
                                                                              (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                                 LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                             data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)


```

### Step remove LAELAF50diff and SQMs

#### LAELAF50diff

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                         dRoughFZ05ExMaxLR +
                                                        TrialNumberScl +
                                                        UASEvents + I(UASEvents^-1) +
                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                        AmbientEnv +
                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                          I(UASEvents^-1) | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ dTonLdECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS tonal loudness, sone", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                         dRoughFZ05ExMaxLR +
                                                        TrialNumberScl +
                                                        I(UASEvents^-1) +
                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                        AmbientEnv +
                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                          I(UASEvents^-1) | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv)

parameters::model_parameters(model2)


```

#### tonal loudness

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                   dRoughFZ05ExMaxLR +
                                                                  TrialNumberScl + LAELAF50diffScl +
                                                                  UASEvents + I(UASEvents^-1) +
                                                                  dSharpAurSHM05ExMaxLR +
                                                                  AmbientEnv +
                                                                  (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                    LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                   dRoughFZ05ExMaxLR +
                                                                  TrialNumberScl + LAELAF50diffScl +
                                                                  I(UASEvents^-1) +
                                                                  dSharpAurSHM05ExMaxLR +
                                                                  AmbientEnv +
                                                                  (1 + dSharpAurSHM05ExMaxLR + AmbientEnv +
                                                                    LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)


```

#### sharpness

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                   dRoughFZ05ExMaxLR +
                                                                  TrialNumberScl + LAELAF50diffScl +
                                                                  UASEvents + I(UASEvents^-1) +
                                                                  dTonLdECMAPowAvgBin +
                                                                  AmbientEnv +
                                                                  (1 + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                   dRoughFZ05ExMaxLR +
                                                                  TrialNumberScl + LAELAF50diffScl +
                                                                  UASEvents + I(UASEvents^-1) +
                                                                  dTonLdECMAPowAvgBin +
                                                                  AmbientEnv +
                                                                  (1 + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                 data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv)

parameters::model_parameters(model2)


```

#### fluctuation strength

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                         dRoughFZ05ExMaxLR +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        UASEvents + I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                         dRoughFZ05ExMaxLR +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)


```

#### roughness

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        UASEvents + I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR + dFluctSHM10ExBin +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)


```

#### impulsiveness

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dRoughFZ05ExMaxLR + dFluctSHM10ExBin +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        UASEvents + I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dRoughFZ05ExMaxLR + dFluctSHM10ExBin +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

mABdSQMperf <- performance::compare_performance(mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### omit impulsiveness, roughness and fluctuation strength

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        UASEvents + I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

mABdSQMperf <- performance::compare_performance(mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### omit impulsiveness and roughness

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv 

model2 <- mABdFdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dFluctSHM10ExBin +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        UASEvents + I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AmbientEnv) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv  <- lme4::lmer(dAnnoyance ~ dFluctSHM10ExBin +
                                                                        TrialNumberScl + LAELAF50diffScl +
                                                                        I(UASEvents^-1) +
                                                                        dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                        AmbientEnv +
                                                                        (1 + dSharpAurSHM05ExMaxLR + AmbientEnv + LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABBL, mABEnv, mABEnv.Env, mAB1_Q, mAB1_Q.1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF501_QSq.dLAELAF501_Q,
                                 mABdTnxdLAELAF5021_QSq.dLAELAF501_Q,
                                 mABDt1i1_QSq.Dt1i1_Q, mABDt5i1_QSq.Dt5i1_Q,
                                 mABDt1i21_QSq.Dt1i1_Q, mABdSDt1i21_QSq.Dt1i1_Q,
                                 mABdSxDt1i21_QSq.Dt1i1_Q,
                                 mABdSDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdFdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdRdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdSxDt1i2xdI1_QSq.dSDt1i1_Q,
                                 mABdTndIdSxDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdTnxDt1i2xdS1_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqEnv.dSDt1i1_QEnv,
                                 mABdIdSxdTnDt1i2xEnv1_QSq.dSDt1i1_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF5021_QSq.dSdLAELAF5021_Q,
                                 mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

mABdSQMperf <- performance::compare_performance(mABdFdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdSxdTn1_QSqEnv.dS1_QEnv,
                                 mABdFdIdRdSdLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdRdTndLAELAF501_QSqEnv.dLAELAF501_QEnv,
                                 mABdIdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdRdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdFdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```



## LAE model without ambient env

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl + 
                                                      TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable  
model2 <- mABShmxTnLAE1_QSq.LAE1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                     UASLAEMaxLRScl + 
                                                      TrialNumberScl + I(UASEvents^-1) +
                                                     (1 + I(UASEvents^-1) +
                                                        UASLAEMaxLRScl | ID.),
                                                     data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q)

parameters::model_parameters(model2)

```

## LAELAF50diff model without ambient env

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv

model2 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID.) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q)

parameters::model_parameters(model2)

```

## detectability model without ambient env

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q

model2 <- mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   Detect0p5IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   Detect0p5IntMaxLRLog + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q)

parameters::model_parameters(model2)

```

## LAF50 and detectability^2 model without ambient env

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q

model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF501_Q)

parameters::model_parameters(model2)

```

## LAF50 and detectability model without ambient env

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q

model2 <- mABdIdSxdTndLAELAF50Dt5i1_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF50Dt5i1_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSq.dSdLAELAF501_Q)

parameters::model_parameters(model2)

```

## LAF50 and detectability^3 model without ambient env

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q

model2 <- mABdIdSxdTndLAELAF50Dt5i31_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) + I(Detect0p5IntMaxLRLog^3) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF50Dt5i31_QSq.dSdLAELAF501_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) + I(Detect0p5IntMaxLRLog^3) +
                                                                (1 + dSharpAurSHM05ExMaxLR +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF50Dt5i31_QSq.dSdLAELAF501_Q)

parameters::model_parameters(model2)

```

## LAF50 and detectability^2 mixed model without ambient env

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q

model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF50Dt5i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                UASEvents + I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + Detect0p5IntMaxLRLog +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p5IntMaxLRLog + ID.) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF50Dt5i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                TrialNumberScl +
                                                                I(UASEvents^-1) +
                                                                dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                LAELAF50diffScl +
                                                                  Detect0p5IntMaxLRLog + I(Detect0p5IntMaxLRLog^2) +
                                                                (1 + dSharpAurSHM05ExMaxLR + Detect0p5IntMaxLRLog +
                                                                   LAELAF50diffScl + I(UASEvents^-1) | ID.),
                                                               data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

# lmtest::lrtest(model1, model2)

performance::compare_performance(mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF50Dt5i1_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF50Dt5i31_QSq.dSdLAELAF501_Q,
                                 mABdIdSxdTndLAELAF50Dt5i21_QSq.dSdLAELAF50Dt5i1_Q)

parameters::model_parameters(model2)

```

## Personal factors

### Categorical model

#### Attitude

```{r}

model1 <- mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          AAM_attitude2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                          AAM_attitude2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl", "AAM_attitude2", "UASEvents [1]"),
                                             type='fixed', margin='empirical')

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
 (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(-2, 8, by=1), limits=c(-2, 8)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='magma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = FALSE)) +
  scale_fill_viridis(option='magma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = FALSE))

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### National region

```{r}

model1 <- mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                          NationGeo2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### National region and AAM attitude interaction

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2*AAM_attitude2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                          NationGeo2*AAM_attitude2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnv1_Q)

parameters::model_parameters(model2)

```
#### Home area of residence

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2 + Home_Area2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                          NationGeo2 + Home_Area2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### Home area of residence interaction with national region

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2*Home_Area2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                          NationGeo2*Home_Area2 + 
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnv1_Q)

parameters::model_parameters(mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnv1_Q)

```

#### Home area soundscape character

```{r}

model1 <- mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q

model2 <- mABTypeOpxLAExEnv1_QSqNatScp.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                          NationGeo2 + Area_soundscape +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
    labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABTypeOpxLAExEnv1_QSqNatScp.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~  UASLAEMaxLRScl*AmbientEnv +
                                                         UASOperation + UASType +
                                                        UASLAEMaxLRScl:UASOperation:AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                          NationGeo2 + Area_soundscape +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABIShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTnDt5i21_QSq.dSDt5i1_Q,
                                 mABShmxTndLAELAF501_QSq.dLAELAF501_Q,
                                 mABdIdSxdTndLAELAF501_QSq.dSdLAELAF501_Q,
                                 mABShmxTnLAE1_QSq.LAE1_Q,
                                 mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatxAtt.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatxAoR.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNatScp.LAEEnv1_Q)

parameters::model_parameters(model2)

```

### Absolute model

#### AAM attitude

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         AAM_attitude2 +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                         AAM_attitude2 +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### National region

```{r}

model1 <- mABShmxTnLAExEnv1_QSq.LAEEnv1_Q

model2 <- mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         NationGeo2 +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))
  
# refit to remove redundant UASEvents variable
model2 <- mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                         NationGeo2 +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl [all]", "NationGeo2"),
                                             type='fixed', margin='empirical')

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  labs(x="UAS lg(detectability)", y="Mean change in annoyance") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(-2, 10, by=1), limits=c(-2, 8)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse=TRUE)) +
  scale_fill_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse=TRUE))

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### Home area of residence

```{r}

model1 <- mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q

model2 <- mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         NationGeo2 + Home_Area2 +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))
  
model2 <- mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                         NationGeo2 + Home_Area2 +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q)

parameters::model_parameters(model2)

```

#### Home area soundscape character

```{r}

model1 <- mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q

model2 <- mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + UASEvents + I(UASEvents^-1) +
                                                         NationGeo2 + Area_soundscape +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(min(subjDataNoAmb$UASLAEMaxLRScl), max(subjDataNoAmb$UASLAEMaxLRScl) + 6, by=3),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)) + 3, by=3))

# refit to remove redundant UASEvents variable
model2 <- mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q <- lme4::lmer(dAnnoyance ~ UASSharpAurSHM05ExMaxLR*UASTonLdECMAPowAvgBin +
                                                       UASLAEMaxLRScl*AmbientEnv +
                                                        TrialNumberScl + I(UASEvents^-1) +
                                                         NationGeo2 + Area_soundscape +
                                                       (1 + I(UASEvents^-1) +
                                                          UASLAEMaxLRScl + AmbientEnv | ID.),
                                                       data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q)

parameters::model_parameters(model2)

```

### Detectability model

#### AAM attitude

```{r}

model1 <- mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q

model2 <- mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                        TrialNumberScl +
                                                         UASEvents + I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           AAM_attitude2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | AAM_attitude2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                        TrialNumberScl +
                                                         I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           AAM_attitude2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q)

parameters::model_parameters(model2)

```

#### National region

```{r}

model1 <- mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q

model2 <- mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                         UASEvents + I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | NationGeo2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                          I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

model2predict <- ggeffects::predict_response(model2, terms=c("Detect0p1IntMaxLRLog", "NationGeo2"),
                                             type='fixed', margin='empirical')

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  labs(x="UAS lg(detectability)", y="Mean change in annoyance") +
  scale_y_continuous(breaks=seq(-2, 10, by=1), limits=c(-2, 8)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = TRUE)) +
  scale_fill_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = TRUE))

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q)

parameters::model_parameters(model2)

```

#### Home area of residence

```{r}

model1 <- mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q

model2 <- mABdIdSxdTnDt1i21_QSqNatAoR.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                         UASEvents + I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2 + Home_Area2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | Home_Area2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqNatAoR.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                          I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2 + Home_Area2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNatAoR.dSDt1i1_Q)

parameters::model_parameters(model2)

```

#### Home area of residence interaction with national region

```{r}

model1 <- mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q

model2 <- mABdIdSxdTnDt1i21_QSqNatxAoR.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                         UASEvents + I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2*Home_Area2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | Home_Area2) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqNatxAoR.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                         I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2*Home_Area2 +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNatAoR.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNatxAoR.dSDt1i1_Q)

parameters::model_parameters(model2)

```

#### Area soundscape character

```{r}


model1 <- mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q

model2 <- mABdIdSxdTnDt1i21_QSqNatScp.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                         UASEvents + I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2 + Area_soundscape +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ Detect0p1IntMaxLRLog + ID. | Area_soundscape) +
  labs(x="UAS lg(detectability)", y="Change in annoyance rating\n(rel. to baseline)")
  
# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTnDt1i21_QSqNatScp.dSDt1i1_Q <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                          TrialNumberScl +
                                                          I(UASEvents^-1) +
                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                           Detect0p1IntMaxLRLog + I(Detect0p1IntMaxLRLog^2) +
                                                           NationGeo2 + Area_soundscape +
                                                         (1 + dSharpAurSHM05ExMaxLR + Detect0p1IntMaxLRLog +
                                                          I(UASEvents^-1) | ID.),
                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqAtt.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatAoR.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSqNatScp.LAEEnv1_Q,
                                 mABdIdSxdTnDt1i21_QSq.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqAtt.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNat.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNatAoR.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNatxAoR.dSDt1i1_Q,
                                 mABdIdSxdTnDt1i21_QSqNatScp.dSDt1i1_Q)

parameters::model_parameters(model2)

```

### LAELAF50diff model

#### Attitude

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv

model2 <- mABdIdSxdTndLAELAF501_QSqEnvAtt.dSdLAELAF501_QEnv <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                        TrialNumberScl +
                                                                         UASEvents + I(UASEvents^-1) +
                                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                           LAELAF50diffScl + AmbientEnv +
                                                                           AAM_attitude2 +
                                                                         (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                                          I(UASEvents^-1) + AmbientEnv | ID.),
                                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | AAM_attitude2) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF501_QSqEnvAtt.dSdLAELAF501_QEnv <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                        TrialNumberScl +
                                                                         I(UASEvents^-1) +
                                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                           LAELAF50diffScl + AmbientEnv +
                                                                           AAM_attitude2 +
                                                                         (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                                          I(UASEvents^-1) + AmbientEnv | ID.),
                                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnvAtt.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### National region

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv

model2 <- mABdIdSxdTndLAELAF501_QSqEnvNat.dSdLAELAF501_QEnv <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                        TrialNumberScl +
                                                                         UASEvents + I(UASEvents^-1) +
                                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                           LAELAF50diffScl + AmbientEnv +
                                                                           NationGeo2 +
                                                                         (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                                          I(UASEvents^-1) + AmbientEnv | ID.),
                                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | NationGeo2) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF501_QSqEnvNat.dSdLAELAF501_QEnv <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                        TrialNumberScl +
                                                                         I(UASEvents^-1) +
                                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                           LAELAF50diffScl + AmbientEnv +
                                                                           NationGeo2 +
                                                                         (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                                          I(UASEvents^-1) + AmbientEnv | ID.),
                                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

model2predict <- ggeffects::predict_response(model2, terms=c("LAELAF50diffScl [all]", "NationGeo2"),
                                             type='fixed', margin='empirical')

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  labs(x="UAS LAE - Amb LAF50", y="Mean change in annoyance") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3)) +
  scale_y_continuous(breaks=seq(-3, 10, by=1), limits=c(-3, 7)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.8, guide = guide_legend(reverse = TRUE)) +
  scale_fill_viridis(option='plasma', direction=1, discrete=TRUE, begin = 0.2, end = 0.8, guide = guide_legend(reverse = TRUE))

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnvAtt.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnvNat.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```

#### Home area of residence

```{r}

model1 <- mABdIdSxdTndLAELAF501_QSqEnvNat.dSdLAELAF501_QEnv

model2 <- mABdIdSxdTndLAELAF501_QSqEnvNatAoR.dSdLAELAF501_QEnv <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                        TrialNumberScl +
                                                                         UASEvents + I(UASEvents^-1) +
                                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                           LAELAF50diffScl + AmbientEnv +
                                                                           NationGeo2 + Home_Area2 +
                                                                         (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                                          I(UASEvents^-1) + AmbientEnv | ID.),
                                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::visualize(model2, plot='model', sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dAnnoyance ~ LAELAF50diffScl + ID. | Home_Area2) +
  labs(x="UAS LAE - Amb LAF50, dB", y="Change in annoyance rating\n(rel. to baseline)") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3) -
                       (max(subjDataNoAmb$LAELAF50diff) - max(subjDataNoAmb$LAELAF50diffScl)),
                     labels=seq(floor(min(subjDataNoAmb$LAELAF50diff)), ceiling(max(subjDataNoAmb$LAELAF50diff)), by=3))

# refit to remove redundant UASEvents variable
model2 <- mABdIdSxdTndLAELAF501_QSqEnvNatAoR.dSdLAELAF501_QEnv <- lme4::lmer(dAnnoyance ~ dImpulsSHMAvgMaxLR +
                                                                        TrialNumberScl +
                                                                         I(UASEvents^-1) +
                                                                         dSharpAurSHM05ExMaxLR*dTonLdECMAPowAvgBin +
                                                                           LAELAF50diffScl + AmbientEnv +
                                                                           NationGeo2 + Home_Area2 +
                                                                         (1 + dSharpAurSHM05ExMaxLR + LAELAF50diffScl +
                                                                          I(UASEvents^-1) + AmbientEnv | ID.),
                                                                         data=subjDataNoAmb, control=lmcontrol, REML=FALSE)

flexplot::model.comparison(model1=model1, model2=model2)

lmtest::lrtest(model1, model2)

performance::compare_performance(mABTypeOpxLAExEnv1_QSq.LAEEnv1_Q,
                                 mABTypeOpxLAExEnv1_QSqNat.LAEEnv1_Q,
                                 mABShmxTnLAExEnv1_QSq.LAEEnv1_Q,
                                 mABdIdSxdTndLAELAF501_QSqEnv.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnvAtt.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnvNat.dSdLAELAF501_QEnv,
                                 mABdIdSxdTndLAELAF501_QSqEnvNatAoR.dSdLAELAF501_QEnv)

parameters::model_parameters(model2)

```
## Categorical model for annoyance (verification of previous estimation analysis)

### AAM attitude

```{r}

model2 <- mABAnnTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q <- lme4::lmer(Annoyance ~ UASType + UASOperation +
                                                             UASLAEMaxLRScl*AmbientEnv +
                                                             UASEvents + AAM_attitude2 +
                                                             I(UASEvents^-1) + TrialNumberScl +
                                                             (1 + UASLAEMaxLRScl + AmbientEnv +
                                                                I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, REML=FALSE,
                                                           control=lmcontrol)

flexplot::visualize(model2, plot='model', sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = Annoyance ~ UASLAEMaxLRScl + ID. | AAM_attitude2) +
  labs(x="UAS LAE, dB", y="Annoyance rating") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))


# refit
model2 <- mABAnnTypeOpxLAExEnv1_QSqAtt.LAEEnv1_Q <- lme4::lmer(Annoyance ~ UASType + UASOperation +
                                                             UASLAEMaxLRScl*AmbientEnv +
                                                               AAM_attitude2 +
                                                             I(UASEvents^-1) + TrialNumberScl +
                                                             (1 + UASLAEMaxLRScl + AmbientEnv +
                                                                I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, REML=FALSE,
                                                           control=lmcontrol)

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl", "AAM_attitude2", "UASEvents [1]"),
                                             type='fixed', margin='empirical')

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  labs(x="UAS LAE, dB", y="Annoyance rating") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
 (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 10, by=1), limits=c(0, 10)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='magma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = FALSE)) +
  scale_fill_viridis(option='magma', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = FALSE))

performance::model_performance(model2, estimator='ML')

parameters::model_parameters(model2)

```

### AAM attitude and home area of residence

```{r}


# fit
model2 <- mABAnnTypeOpxLAExEnv1_QSqAoR.LAEEnv1_Q <- lme4::lmer(Annoyance ~ UASType + UASOperation +
                                                             UASLAEMaxLRScl*AmbientEnv +
                                                                relevel(Home_Area, ref='Urban') +
                                                             I(UASEvents^-1) + TrialNumberScl +
                                                             (1 + UASLAEMaxLRScl + AmbientEnv +
                                                                I(UASEvents^-1) | ID.),
                                                           data=subjDataNoAmb, REML=FALSE,
                                                           control=lmcontrol)

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl", "Home_Area [Suburban, Urban]", "UASEvents [1]"),
                                             type='fixed', margin='empirical')

ggplot(data=model2predict) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  labs(x="UAS LAE, dB", y="Annoyance rating") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
 (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 10, by=1), limits=c(0, 10)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='viridis', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = FALSE)) +
  scale_fill_viridis(option='viridis', direction=1, discrete=TRUE, begin = 0.2, end = 0.7, guide = guide_legend(reverse = FALSE))

performance::model_performance(model2, estimator='ML')

parameters::model_parameters(model2)

ggeffects::test_predictions(model2, 'Home_Area')

```

# Parts A & B combined analysis: Highly annoyed probability

## Fit LAE logistic model

### Categorical models

#### Base random intercept model

```{r}

model2 <- mABHLAETypeOp <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + (1 | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

parameters::model_parameters(model2)

performance::model_performance(mABHLAETypeOp)


```
#### with environment

```{r}

model1 <- mABHLAETypeOp

model2 <- mABHLAETypeOpEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + AmbientEnv + (1 | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv)


```

#### with environment and events

```{r}

model1 <- mABHLAETypeOpEnv

model2 <- mABHLAETypeOpEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + AmbientEnv + UASEvents + (1 | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ)


```

#### with environment, events, and mixed LAE


```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypeOpEnvQ.LAE <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + AmbientEnv + UASEvents +
                                          (1 + UASLAEMaxLRScl | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE)


```

#### mixed LAE and environment

```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypeOpEnvQ.LAEEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + AmbientEnv + UASEvents +
                                          (1 + UASLAEMaxLRScl + AmbientEnv | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

model2predictType <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl [all]", "UASType [all]"),
                                             type='fixed', margin='empirical',
                                             bias_correction=TRUE)

model2predictOp <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl [all]", "UASOperation [all]"),
                                               type='fixed', margin='empirical',
                                             bias_correction=TRUE)

model2predictEnv <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl [all]", "AmbientEnv [all]"),
                                               type='fixed', margin='empirical',
                                             bias_correction=TRUE)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))



ggplot(data=model2predictType) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dHighAnnoyProp, colour=UASType, shape=UASType),
             alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="% Highly annoyed") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.8) +
  scale_fill_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.8)


ggplot(data=model2predictOp) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dHighAnnoyProp, colour=UASOperation), shape=1, alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="% Highly annoyed") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', direction=-1, discrete=TRUE, begin = 0.2, end = 0.8, guide = guide_legend(reverse = TRUE) ) +
  scale_fill_viridis(option='plasma', direction=-1, discrete=TRUE, begin = 0.2, end = 0.8, guide = guide_legend(reverse = TRUE) )

ggplot(data=model2predictEnv) +
  geom_line(aes(x=x, y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(x=x, ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dHighAnnoyProp, colour=AmbientEnv), shape=1, alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="% Highly annoyed") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='cividis', discrete=TRUE, begin = 0.2, end = 0.8) +
  scale_fill_viridis(option='cividis', discrete=TRUE, begin = 0.2, end = 0.8)


lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv)


```

#### mixed LAE, env and type

```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypeOpEnvQ.LAETypeEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + AmbientEnv + UASEvents +
                                          (1 + UASType + UASLAEMaxLRScl + AmbientEnv | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAETypeEnv)

```

#### mixed LAE, env, and operation

```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypeOpEnvQ.LAEOpEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + AmbientEnv + UASEvents +
                                          (1 + UASOperation + UASLAEMaxLRScl + AmbientEnv | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEOpEnv)

```

#### mixed LAE, env and events

```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypeOpEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                                  UASOperation + AmbientEnv + UASEvents +
                                                    (1 + UASEvents + UASLAEMaxLRScl + AmbientEnv | ID.),
                                                  data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

model2predictLAE <- ggeffects::predict_response(model2,
                                                terms=c("UASLAEMaxLRScl [all]"),
                                                type='fixed', margin='empirical',
                                                bias_correction=TRUE)
colnames(model2predictLAE)[which(names(model2predictLAE) == "x")] <- "UASLAEMaxLRScl"


model2predictLAE.Env <- ggeffects::predict_response(model2,
                                                    terms=c("UASLAEMaxLRScl [all]",
                                                         "AmbientEnv [all]"),
                                                    type='fixed', margin='empirical',
                                                    bias_correction=TRUE)
colnames(model2predictLAE.Env)[which(names(model2predictLAE.Env) == "x")] <- "UASLAEMaxLRScl"
colnames(model2predictLAE.Env)[which(names(model2predictLAE.Env) == "group")] <- "AmbientEnv"

ggplot(data=model2predictLAE, aes(x=UASLAEMaxLRScl)) +
  geom_line(aes(y=predicted), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dHighAnnoyProp), shape=1, size=3, alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="% Highly annoyed") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.8, guide=) +
  scale_fill_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.8)

ggplot(data=model2predictLAE.Env, aes(x=UASLAEMaxLRScl, colour=AmbientEnv)) +
  geom_line(aes(y=predicted), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=AmbientEnv), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dHighAnnoyProp,
                                     colour=AmbientEnv, shape=AmbientEnv), size=3, alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="% Highly annoyed", fill="Amb. env.", colour="Amb. env.", shape="Amb. env.") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(name="Amb. env.", option='plasma', discrete=TRUE, begin = 0.2, end = 0.7) +
  scale_fill_viridis(name="Amb. env.", option='plasma', discrete=TRUE, begin = 0.2, end = 0.7) +
  scale_shape_manual(name="Amb. env.",
                     labels=levels(model2predictLAE.Env$AmbientEnv),
                     values=c(0, 1))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ)

```

#### interaction type and op

```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypexOpEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl +
                                                  UASType*UASOperation + AmbientEnv + UASEvents +
                                          (1 + UASEvents + UASLAEMaxLRScl + AmbientEnv | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ)

```

#### no interaction, no env

```{r}

model1 <- mABHLAETypeOpEnvQ

model2 <- mABHLAETypeOpQ.LAEQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                        UASOperation + UASEvents +
                                          (1 + UASEvents + UASLAEMaxLRScl | ID.),
                                        data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ,
                                 mABHLAETypeOpQ.LAEQ)

```

#### curvilinear events

```{r}

model1 <- mABHLAETypexOpEnvQ.LAEEnvQ

model2 <- mABHLAETypeOpEnv1_Q.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + UASType +
                                                      UASOperation + UASEvents + I(UASEvents^-1) +
                                                        AmbientEnv +
                                                        (1 + AmbientEnv + UASEvents + UASLAEMaxLRScl | ID.),
                                                      data=subjDataNoAmb, family=binomial, control=glmcontrol)

# flexplot::visualize(model2, plot='model',
#                     sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
#                     formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) 

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl"),
                                             type='fixed', margin='empirical')

plot(model2predict, line_size=1, colors='eight', ci_style = 'ribbon', show_title=FALSE, alpha=0.25) +
      labs(x="UAS LAE, dB", y="% Highly annoyed") +
      scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
      scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ,
                                 mABHLAETypeOpQ.LAEQ, mABHLAETypeOpEnv1_Q.LAEEnvQ)

```

#### LAE interaction with type

```{r}

model1 <- mABHLAETypeOpEnvQ.LAEEnvQ

model2 <- mABHLAExTypeOpEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl*UASType +
                                                      UASOperation + UASEvents +
                                                        AmbientEnv +
                                                        (1 + AmbientEnv + UASEvents + UASLAEMaxLRScl | ID.),
                                                      data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
      labs(x="UAS LAE, dB", y="% Highly annoyed") +
      scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

model2predict <- ggeffects::predict_response(model2, terms=c("UASLAEMaxLRScl", "UASType [all]"),
                                             type='fixed', margin='empirical',
                                             bias_correction=TRUE)

plot(model2predict, line_size=1, colors='eight', ci_style = 'ribbon', show_title=FALSE, alpha=0.25) +
      labs(x="UAS LAE, dB", y="% Highly annoyed") +
      scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
      scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ,
                                 mABHLAETypeOpQ.LAEQ, mABHLAETypeOpEnv1_Q.LAEEnvQ,
                                 mABHLAExTypeOpEnvQ.LAEEnvQ)

```

#### LAE interaction with operation

```{r}

model1 <- mABHLAETypeOpEnvQ.LAEEnvQ

model2 <- mABHLAExOpTypeEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl*UASOperation +
                                                      UASType + UASEvents +
                                                        AmbientEnv +
                                                        (1 + AmbientEnv + UASEvents + UASLAEMaxLRScl | ID.),
                                                      data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
      labs(x="UAS LAE, dB", y="% Highly annoyed") +
      scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ,
                                 mABHLAETypeOpQ.LAEQ, mABHLAETypeOpEnv1_Q.LAEEnvQ,
                                 mABHLAExTypeOpEnvQ.LAEEnvQ,
                                 mABHLAExOpTypeEnvQ.LAEEnvQ)

```

#### LAE interaction with env

```{r}

model1 <- mABHLAETypeOpEnvQ.LAEEnv

model2 <- mABHTypeOpLAExEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl*AmbientEnv +
                                                      UASType + UASEvents + UASOperation +
                                                        (1 + AmbientEnv + UASEvents + UASLAEMaxLRScl | ID.),
                                                      data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
      labs(x="UAS LAE, dB", y="% Highly annoyed") +
      scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ,
                                 mABHLAETypeOpQ.LAEQ, mABHLAETypeOpEnv1_Q.LAEEnvQ,
                                 mABHLAExTypeOpEnv1_Q.LAEEnvQ,
                                 mABHLAExOpTypeEnv1_Q.LAEEnvQ,
                                 mABHTypeOpLAExEnvQ.LAEEnvQ)

```

#### fixed events

```{r}

model1 <- mABHLAETypeOpEnvQ.LAEEnv

model2 <- mABHTypeOpLAExEnvQ.LAEEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl*AmbientEnv +
                                                      UASType + UASEvents + UASOperation +
                                                        (1 + AmbientEnv + UASLAEMaxLRScl | ID.),
                                                      data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
      labs(x="UAS LAE, dB", y="% Highly annoyed") +
      scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAETypeOp, mABHLAETypeOpEnv,
                                 mABHLAETypeOpEnvQ, mABHLAETypeOpEnvQ.LAE,
                                 mABHLAETypeOpEnvQ.LAEEnv,
                                 mABHLAETypeOpEnvQ.LAEEnvQ,
                                 mABHLAETypexOpEnvQ.LAEEnvQ,
                                 mABHLAETypeOpQ.LAEQ, mABHLAETypeOpEnv1_Q.LAEEnvQ,
                                 mABHLAExTypeOpEnv1_Q.LAEEnvQ,
                                 mABHLAExOpTypeEnv1_Q.LAEEnvQ,
                                 mABHTypeOpLAExEnvQ.LAEEnvQ,
                                 mABHTypeOpLAExEnvQ.LAEEnv)

```

### basic LAE model

```{r}

model2 <- mABHLAE <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + (1 | ID.),
                       data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

parameters::model_parameters(model2)

performance::model_performance(mABHLAE)

```

### LAE mixed model

```{r}

model1 <- mABHLAE

model2 <- mABHLAE.LAE <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + (1 + UASLAEMaxLRScl | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID.) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE)

```

### LAE mixed model with env

```{r}

model1 <- mABHLAE

model2 <- mABHLAEEnv.LAE <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl +
                                       AmbientEnv + (1 + UASLAEMaxLRScl | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

model2predictLAE.Env <- ggeffects::predict_response(model2,
                                                 terms=c("UASLAEMaxLRScl [all]",
                                                         "AmbientEnv [all]"),
                                                 type='fixed', margin='empirical',
                                             bias_correction=TRUE)

colnames(model2predictLAE.Env)[which(names(model2predictLAE.Env) == "x")] <- "UASLAEMaxLRScl"
colnames(model2predictLAE.Env)[which(names(model2predictLAE.Env) == "group")] <- "AmbientEnv"

ggplot(data=model2predictLAE.Env, aes(x=UASLAEMaxLRScl, colour=AmbientEnv)) +
  geom_line(aes(y=predicted), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=AmbientEnv), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLAEMaxLRScl, y=dHighAnnoyProp,
                                     colour=AmbientEnv, shape=AmbientEnv), size=3, alpha=0.35) +
  labs(x=expression(paste(UAS~italic(L)[AE],",",~dB)), y="% Highly annoyed", fill="Amb. env.", colour="Amb. env.", shape="Amb. env.") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3)) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(name="Amb. env.", option='plasma', discrete=TRUE, begin = 0.2, end = 0.8, guide=) +
  scale_fill_viridis(name="Amb. env.", option='plasma', discrete=TRUE, begin = 0.2, end = 0.8) +
  scale_shape_manual(name="Amb. env.",
                     labels=levels(model2predictLAE.Env$AmbientEnv),
                     values=c(0, 1))

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE,
                                 mABHLAEEnv.LAE)

```

### mixed with ambient env

```{r}

model1 <- mABHLAE.LAE

model2 <- mABHLAEEnv.LAEEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl +
                                             AmbientEnv + (1 + UASLAEMaxLRScl + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE,
                                 mABHLAEEnv.LAE, mABHLAEEnv.LAEEnv)

```

### mixed with ambient env interaction

```{r}

model1 <- mABHLAEEnv.LAEEnv

model2 <- mABHLAExEnv.LAEEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl*AmbientEnv +
                                              (1 + UASLAEMaxLRScl + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv)

```

### mixed with ambient env and events

```{r}

model1 <- mABHLAEEnv.LAEEnv

model2 <- mABHLAEEnvQ.LAEEnv <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + AmbientEnv +
                                              UASEvents +
                                              (1 + UASLAEMaxLRScl + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv)

```

### mixed with ambient env and mixed events

```{r}

model1 <- mABHLAEEnvQ.LAEEnv

model2 <- mABHLAEEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl + AmbientEnv +
                                              UASEvents +
                                              (1 + UASEvents + UASLAEMaxLRScl +
                                                 AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") + 
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ)

```

## Loudness

### fixed

```{r}

model2 <- mABHN <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                             (1 | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

# lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN)

```

### mixed

```{r}

model2 <- mABHN.N <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                             (1 + UASLoudECMAPowAvgBin | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

# lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N)

```

### mixed with env

```{r}

model1 <- mABHN.N

model2 <- mABHNEnv.N <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                      AmbientEnv +
                                             (1 + UASLoudECMAPowAvgBin | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")


lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N)

```

### mixed with env and events

```{r}

model1 <- mABHNEnv.N

model2 <- mABHNEnvQ.NQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                      AmbientEnv + UASEvents +
                                             (1 + AmbientEnv + UASLoudECMAPowAvgBin | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ)

```

### with mixed env

```{r}

model1 <- mABHN.N

model2 <- mABHNEnv.NEnv <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                             AmbientEnv + (1 + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv)

```

### with mixed env and events

```{r}

model1 <- mABHNEnv.NEnv

model2 <- mABHNEnvQ.NEnv <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                          UASEvents +
                                             AmbientEnv + (1 + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv, mABHNEnvQ.NEnv)

```

### with env and events mixed

```{r}

model1 <- mABHNEnvQ.NEnv

model2 <- mABHNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                          UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

model2predictN <- ggeffects::predict_response(model2,
                                             terms=c("UASLoudECMAPowAvgBin [all]",
                                                     "AmbientEnv [all]"),
                                             type='fixed', margin='empirical',
                                             bias_correction=TRUE)

ggplot(data=model2predictN, aes(x=x)) +
  geom_line(aes(y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLoudECMAPowAvgBin, y=dHighAnnoyProp,
                                     colour=AmbientEnv, shape=AmbientEnv), alpha=0.35) +
  labs(x="UAS loudness (Sottek), sone", y="% Highly annoyed") +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.8, guide=) +
  scale_fill_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.8)

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv, mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ)

```

### no env, events mixed

```{r}

model1 <- mABHNEnvQ.NEnv

model2 <- mABHNQ.NQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                          UASEvents +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv, mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ)

```

## tonal loudness

### fixed

```{r}

model1 <- mABHNEnvQ.NEnvQ

model2 <- mABHTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin + UASTonLdECMAPowAvgBin +
                                          UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv, mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ)

```

### tonal loudness mixed

```{r}

model1 <- mABHNEnvQ.NEnvQ

model2 <- mABHTnNEnvQ.TnNEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin + UASTonLdECMAPowAvgBin +
                                          UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + UASTonLdECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv, mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHTnNEnvQ.TnNEnvQ)

```


## Intermittency ratio

```{r}

model1 <- mABHTnNEnvQ.NEnvQ

model2 <- mABHIrTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin + UASTonLdECMAPowAvgBin + IntermitRatioMaxLR +
                                          UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID.) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv, mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ)

```

## Sharpness

### fixed

```{r}

model1 <- mABHTnNEnvQ.NEnvQ

model2 <- mABHSTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASSharpAurISO3PowAvgMaxLR +
                                          UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

model2predictN <- ggeffects::predict_response(model2,
                                             terms=c("UASLoudECMAPowAvgBin [all]",
                                                     "AmbientEnv [all]"),
                                             type='fixed', margin='empirical',
                                             bias_correction=TRUE)

model2predictTn <- ggeffects::predict_response(model2,
                                               terms=c("UASTonLdECMAPowAvgBin [all]",
                                                        "AmbientEnv [all]"),
                                               type='fixed', margin='empirical',
                                             bias_correction=TRUE)

model2predictS <- ggeffects::predict_response(model2,
                                               terms=c("UASSharpAurISO3PowAvgMaxLR [all]",
                                                        "AmbientEnv [all]"),
                                               type='fixed', margin='empirical',
                                             bias_correction=TRUE)

ggplot(data=model2predictN, aes(x=x)) +
  geom_line(aes(y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASLoudECMAPowAvgBin, y=dHighAnnoyProp,
                                     colour=AmbientEnv, shape=AmbientEnv), alpha=0.35) +
  labs(x="UAS loudness (Sottek), sone", y="% Highly annoyed") +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.7) +
  scale_fill_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.7)

ggplot(data=model2predictTn, aes(x=x)) +
  geom_line(aes(y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASTonLdECMAPowAvgBin, y=dHighAnnoyProp,
                                     colour=AmbientEnv, shape=AmbientEnv), alpha=0.35) +
  labs(x="UAS tonal loudness (Sottek), sone", y="% Highly annoyed") +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.7) +
  scale_fill_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.7)

ggplot(data=model2predictS, aes(x=x)) +
  geom_line(aes(y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  geom_point(data=stimDataNoAmb, aes(x=UASSharpAurISO1PowAvgMaxLR, y=dHighAnnoyProp,
                                     colour=AmbientEnv, shape=AmbientEnv), alpha=0.35) +
  labs(x="UAS sharpness (Aures | ISO 532-1), acum", y="% Highly annoyed") +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.7) +
  scale_fill_viridis(option='plasma', discrete=TRUE, begin = 0.2, end = 0.7)



lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnv.NEnv,
                                 mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ)

```

## Fluctuation strength

### fixed

```{r}

model1 <- mABHTnNEnvQ.NEnvQ

model2 <- mABHFTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASFluctOV10ExMaxLR +
                                            UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ)

```

## Impulsiveness

### fixed

```{r}

model1 <- mABHTnNEnvQ.NEnvQ

model2 <- mABHITnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASImpulsSHMPowAvgMaxLR +
                                            UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ)

```

## Roughness

### fixed

```{r}

model1 <- mABHTnNEnvQ.NEnvQ

model2 <- mABHRTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                            UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ)

```

## All SQMs

### fixed

```{r}

model1 <- mABHTnNEnvQ.NEnvQ

model2 <- mABHFIRSTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                                UASImpulsSHMPowAvgMaxLR + UASFluctOV10ExMaxLR +
                                                UASSharpAurISO305ExMaxLR +
                                            UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ)

```

### substitute LAE for loudness

```{r}

model1 <- mABHLAEEnvQ.LAEEnvQ 

model2 <- mABHFIRSTnLAEEnvQ.LAEEnvQ <- lme4::glmer(dHighAnnoy ~ UASLAEMaxLRScl +
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                                UASImpulsSHMPowAvgMaxLR + UASFluctOV10ExMaxLR +
                                                UASSharpAurISO305ExMaxLR +
                                            UASEvents +
                                             AmbientEnv + (1 + UASEvents + UASLAEMaxLRScl + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLAEMaxLRScl + ID. | AmbientEnv) +
  labs(x="UAS LAE, dB", y="Probability of high annoyance") +
  scale_x_continuous(breaks=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3) -
                       (max(subjDataNoAmb$UASLAEMaxLR) - max(subjDataNoAmb$UASLAEMaxLRScl)),
                     labels=seq(floor(min(subjDataNoAmb$UASLAEMaxLR)), ceiling(max(subjDataNoAmb$UASLAEMaxLR)), by=3))

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ)

```

## Step remove SQMs

### loudness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFIRSTnEnvQ.EnvQ <- lme4::glmer(dHighAnnoy ~ 
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                                UASImpulsSHMPowAvgMaxLR + UASFluctOV10ExMaxLR +
                                                UASSharpAurISO305ExMaxLR +
                                            UASEvents +
                                             AmbientEnv + (1 + UASEvents +  AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASTonLdECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS tonal loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ)

```

### tonal loudness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFIRSNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASSharpAurISO305ExMaxLR + UASRoughFZ05ExMaxLR +
                                                UASImpulsSHMPowAvgMaxLR + UASFluctOV10ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ)

```

### sharpness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFIRTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                                UASImpulsSHMPowAvgMaxLR + UASFluctOV10ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASTonLdECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS tonal loudness (Sottek), sone", y="Probability of high annoyance")


lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ)

```

### fluctuation strength

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHIRSTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                                UASImpulsSHMPowAvgMaxLR + UASSharpAurISO305ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin +  AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ)

```

### impulsiveness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFRSTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASRoughFZ05ExMaxLR +
                                                UASFluctOV10ExMaxLR + UASSharpAurISO305ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ)

```

### roughness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFISTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin + UASImpulsSHMPowAvgMaxLR +
                                                UASFluctOV10ExMaxLR + UASSharpAurISO305ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ)

mABHSQMperf <- performance::compare_performance(mABHFIRSTnNEnvQ.NEnvQ,
                                                mABHFIRSTnEnvQ.EnvQ,
                                                mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                                mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                                mABHFISTnNEnvQ.NEnvQ)

```

### omit roughness and impulsiveness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFSTnNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASTonLdECMAPowAvgBin +
                                                UASFluctOV10ExMaxLR + UASSharpAurISO305ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ)

```

### omit sharpness, tonal loudness, roughness and impulsiveness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASFluctOV10ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ)

```

### omit tonal loudness, roughness and impulsiveness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFSNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASFluctOV10ExMaxLR + UASSharpAurISO305ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASSharpAurISO305ExMaxLR + ID. | AmbientEnv) +
  labs(x="UAS sharpness (Aures), acum", y="Probability of high annoyance")


lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ, mABHFSNEnvQ.NEnvQ)

```


### omit tonal loudness, roughness and sharpness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFINEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASFluctOV10ExMaxLR + UASImpulsSHMPowAvgMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASImpulsSHMPowAvgMaxLR + ID. | AmbientEnv) +
  labs(x="UAS impulsiveness (Sottek), iu", y="Probability of high annoyance")


lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ, mABHFSNEnvQ.NEnvQ,
                                 mABHFINEnvQ.NEnvQ)

```

### omit tonal loudness, roughness and sharpness

```{r}

model1 <- mABHFIRSTnNEnvQ.NEnvQ

model2 <- mABHFISNEnvQ.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                              UASFluctOV10ExMaxLR + UASImpulsSHMPowAvgMaxLR +
                                              UASSharpAurISO305ExMaxLR +
                                            UASEvents + AmbientEnv +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                     data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AmbientEnv) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASImpulsSHMPowAvgMaxLR + ID. | AmbientEnv) +
  labs(x="UAS impulsiveness (Sottek), iu", y="Probability of high annoyance")


flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASSharpAurISO305ExMaxLR + ID. | AmbientEnv) +
  labs(x="UAS sharpness (Aures), acum", y="Probability of high annoyance")


lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ, mABHFSNEnvQ.NEnvQ,
                                 mABHFINEnvQ.NEnvQ, mABHFISNEnvQ.NEnvQ)

```


### Personal factors

#### AAM attitude


```{r}

model1 <- mABHFNEnvQ.NEnvQ

model2 <- mABHFNEnvQAtt.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                            UASFluctOV10ExMaxLR +
                                            UASEvents + AmbientEnv + AAM_attitude2 +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                            data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | AAM_attitude2) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ, mABHFSNEnvQ.NEnvQ,
                                 mABHFINEnvQ.NEnvQ, mABHFISNEnvQ.NEnvQ,
                                 mABHFNEnvQAtt.NEnvQ)

```

#### National region


```{r}

model1 <- mABHFNEnvQ.NEnvQ

model2 <- mABHFNEnvQNat.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                            UASFluctOV10ExMaxLR +
                                            UASEvents + AmbientEnv + NationGeo2 +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                            data=subjDataNoAmb, family=binomial, control=glmcontrol)

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | NationGeo2) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ, mABHFSNEnvQ.NEnvQ,
                                 mABHFINEnvQ.NEnvQ, mABHFISNEnvQ.NEnvQ,
                                 mABHFNEnvQAtt.NEnvQ, mABHFNEnvQNat.NEnvQ)

```


#### Home area of residence


```{r}

model1 <- mABHFNEnvQ.NEnvQ

model2 <- mABHFNEnvQAoR.NEnvQ <- lme4::glmer(dHighAnnoy ~ UASLoudECMAPowAvgBin +
                                            UASFluctOV10ExMaxLR +
                                            UASEvents + AmbientEnv + Home_Area2 +
                                              (1 + UASEvents + UASLoudECMAPowAvgBin + AmbientEnv | ID.),
                                            data=subjDataNoAmb, family=binomial, control=glmcontrol)

model2predict <- ggeffects::predict_response(model2,
                                             terms=c("UASLoudECMAPowAvgBin [all]",
                                                     "Home_Area2"),
                                             type='fixed', margin='empirical',
                                             bias_correction=TRUE)
ggplot(data=model2predict, aes(x=x)) +
  geom_line(aes(y=predicted, colour=group), linewidth=1) +
  geom_ribbon(aes(ymin=conf.low, ymax=conf.high, fill=group), alpha=0.15) +
  scale_y_continuous(breaks=seq(0, 1, by=0.1), labels=seq(0, 100, by=10), limits=c(0, 1)) +
  theme(panel.grid = element_blank(), aspect.ratio=1.35, text = element_text(family = "serif"), legend.title=element_blank()) +
  scale_color_viridis(option='viridis', discrete=TRUE, begin = 0.2, end = 0.8) +
  scale_fill_viridis(option='viridis', discrete=TRUE, begin = 0.2, end = 0.8) +
  labs(x="UAS loudness (Sottek), sone", y="% Highly annoyed")

flexplot::visualize(model2, plot='model',
                    sample=length(levels(subjDataNoAmb$ID.)), alpha=0.1,
                    formula = dHighAnnoy ~ UASLoudECMAPowAvgBin + ID. | Home_Area2) +
  labs(x="UAS loudness (Sottek), sone", y="Probability of high annoyance")

lmtest::lrtest(model1, model2)

parameters::model_parameters(model2)

performance::compare_performance(mABHLAE, mABHLAE.LAE, mABHLAEEnv.LAE,
                                 mABHLAEEnv.LAEEnv, mABHLAExEnv.LAEEnv,
                                 mABHLAEEnvQ.LAEEnv, mABHLAEEnvQ.LAEEnvQ,
                                 mABHN, mABHN.N, mABHNEnv.N, mABHNEnvQ.NQ,
                                 mABHNEnv.NEnv,  mABHNEnvQ.NEnv, mABHNEnvQ.NEnvQ,
                                 mABHNQ.NQ, mABHTnNEnvQ.NEnvQ,
                                 mABHIrTnNEnvQ.NEnvQ, mABHSTnNEnvQ.NEnvQ,
                                 mABHITnNEnvQ.NEnvQ, mABHRTnNEnvQ.NEnvQ,
                                 mABHFIRSTnNEnvQ.NEnvQ,
                                 mABHFIRSTnLAEEnvQ.LAEEnvQ, mABHFIRSTnEnvQ.EnvQ,
                                 mABHFIRSNEnvQ.NEnvQ, mABHFIRTnNEnvQ.NEnvQ,
                                 mABHIRSTnNEnvQ.NEnvQ, mABHFRSTnNEnvQ.NEnvQ,
                                 mABHFISTnNEnvQ.NEnvQ, mABHFSTnNEnvQ.NEnvQ,
                                 mABHFNEnvQ.NEnvQ, mABHFSNEnvQ.NEnvQ,
                                 mABHFINEnvQ.NEnvQ, mABHFISNEnvQ.NEnvQ,
                                 mABHFNEnvQAtt.NEnvQ, mABHFNEnvQNat.NEnvQ,
                                 mABHFNEnvQAoR.NEnvQ)

```

## Test difference metrics

### LAELAeqdiff

```{r}

model2 <- mABHdLAELAeqQ.dLAELAeqQ <- lme4::glmer(dHighAnnoy ~ LAELAeqdiff +
                                              UASEvents +
                                              (1 + UASEvents + LAELAeqdiff | ID.),
                                            data=subjDataNoAmb, family=binomial, control=glmcontrol)

performance::compare_performance(mABHLAEEnvQ.LAEEnvQ, mABHFNEnvQ.NEnvQ,
                                 mABHdLAELAeqQ.dLAELAeqQ)

parameters::model_parameters(model2)

```

#### LAELAeqdiff with env

```{r}

model2 <- mABHdLAELAeqEnvQ.dLAELAeqEnvQ <- lme4::glmer(dHighAnnoy ~ LAELAeqdiff +
                                                      UASEvents + AmbientEnv +
                                                      (1 + AmbientEnv + UASEvents +
                                                         LAELAeqdiff | ID.),
                                                    data=subjDataNoAmb, family=binomial, control=glmcontrol)

performance::compare_performance(mABHLAEEnvQ.LAEEnvQ, mABHFNEnvQ.NEnvQ,
                                 mABHdLAELAeqQ.dLAELAeqQ,
                                 mABHdLAELAeqEnvQ.dLAELAeqEnvQ)

parameters::model_parameters(model2)

```

### Partial loudness

```{r}

model2 <- mABHdNQ.dNQ <- lme4::glmer(dHighAnnoy ~ PartLoudMGLTPowAvg +
                                              UASEvents +
                                              (1 + UASEvents + PartLoudMGLTPowAvg | ID.),
                                            data=subjDataNoAmb, family=binomial, control=glmcontrol)

performance::compare_performance(mABHLAEEnvQ.LAEEnvQ, mABHFNEnvQ.NEnvQ,
                                 mABHdLAELAeqQ.dLAELAeqQ,
                                 mABHdLAELAeqEnvQ.dLAELAeqEnvQ,
                                 mABHdNQ.dNQ)

parameters::model_parameters(model2)

```

#### Partial loudness with env

```{r}

model2 <- mABHdNEnvQ.dNEnvQ <- lme4::glmer(dHighAnnoy ~ PartLoudMGLTPowAvg +
                                              UASEvents + AmbientEnv +
                                              (1 + AmbientEnv + UASEvents + PartLoudMGLTPowAvg | ID.),
                                            data=subjDataNoAmb, family=binomial, control=glmcontrol)

performance::compare_performance(mABHLAEEnvQ.LAEEnvQ, mABHFNEnvQ.NEnvQ,
                                 mABHdLAELAeqQ.dLAELAeqQ,
                                 mABHdLAELAeqEnvQ.dLAELAeqEnvQ,
                                 mABHdNQ.dNQ,
                                 mABHdNEnvQ.dNEnvQ)

parameters::model_parameters(model2)

```














